<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FunnelCraft Pro - Builder Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-glass: rgba(20, 20, 30, 0.8);
            --bg-card: rgba(25, 25, 35, 0.9);
            --bg-input: rgba(30, 30, 45, 0.8);
            --text-primary: #ffffff;
            --text-secondary: #b0b0c0;
            --text-muted: #707080;
            --accent-primary: #6366f1;
            --accent-secondary: #06d6a0;
            --accent-tertiary: #f72585;
            --accent-warning: #fbbf24;
            --accent-success: #10b981;
            --border-glass: rgba(255, 255, 255, 0.08);
            --border-active: rgba(99, 102, 241, 0.4);
            --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.3);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-accent: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #06d6a0 100%);
            --gradient-mesh: conic-gradient(from 180deg at 50% 50%, #667eea 0deg, #764ba2 72deg, #f093fb 144deg, #f5576c 216deg, #4facfe 288deg, #667eea 360deg);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            margin: 0;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            font-size: 16px;
            line-height: 1.5;
        }

        /* Logo styles */
        .logo {
            max-height: 80px;
            width: auto;
            filter: brightness(1.2);
        }

        .logo-small {
            max-height: 40px;
            width: auto;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.15) 0%, transparent 50%);
            animation: backgroundFlow 20s ease-in-out infinite;
            z-index: -2;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                repeating-linear-gradient(90deg,
                    transparent,
                    transparent 98px,
                    rgba(255, 255, 255, 0.01) 100px),
                repeating-linear-gradient(0deg,
                    transparent,
                    transparent 98px,
                    rgba(255, 255, 255, 0.01) 100px);
            z-index: -1;
        }

        @keyframes backgroundFlow {

            0%,
            100% {
                transform: scale(1) rotate(0deg);
            }

            33% {
                transform: scale(1.1) rotate(120deg);
            }

            66% {
                transform: scale(0.9) rotate(240deg);
            }
        }

        /* Progress System */
        .progress-system {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            backdrop-filter: blur(20px);
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-accent);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            animation: progressShimmer 2s infinite;
        }

        @keyframes progressShimmer {
            100% {
                left: 100%;
            }
        }

        /* Glass Morphism Cards */
        .glass-card {
            background: var(--bg-card);
            border: 1px solid var(--border-glass);
            border-radius: 24px;
            backdrop-filter: blur(24px);
            box-shadow: var(--shadow-glass);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        }

        .glass-card:hover {
            transform: translateY(-4px);
            border-color: var(--border-active);
            box-shadow:
                var(--shadow-glass),
                0 20px 60px rgba(99, 102, 241, 0.1);
        }

        /* Hero Header */
        .hero-header {
            position: relative;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 1rem;
        }

        .hero-mesh {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: var(--gradient-mesh);
            animation: rotateMesh 30s linear infinite;
            opacity: 0.1;
            filter: blur(2px);
        }

        @keyframes rotateMesh {
            100% {
                transform: rotate(360deg);
            }
        }

        .hero-content {
            position: relative;
            z-index: 10;
            text-align: center;
            max-width: 800px;
            padding: 0 1rem;
            width: 100%;
        }

        .hero-badge {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 50px;
            padding: 8px 16px;
            color: var(--accent-primary);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: inline-block;
            backdrop-filter: blur(10px);
        }

        .hero-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff 0%, #b0b0c0 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            word-wrap: break-word;
        }

        .hero-subtitle {
            font-size: clamp(1rem, 4vw, 1.5rem);
            color: var(--text-secondary);
            margin-bottom: 2rem;
            line-height: 1.6;
            padding: 0 0.5rem;
        }

        .cta-primary {
            background: transparent;
            border: 2px solid var(--accent-primary);
            border-radius: 12px;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-primary);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: none;
            width: 100%;
            max-width: 280px;
            margin: 0 auto;
            display: block;
        }

        .cta-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--accent-primary);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .cta-primary:hover::before {
            left: 0;
        }

        .cta-primary:hover {
            transform: translateY(-2px);
            color: white;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }

        /* Form Container */
        .form-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem;
            position: relative;
            z-index: 10;
            display: none;
            width: 100%;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-direction: column;
            text-align: center;
        }

        .section-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-accent);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .section-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--gradient-accent);
            border-radius: 16px;
            z-index: -1;
            animation: borderGlow 3s ease-in-out infinite;
        }

        @keyframes borderGlow {

            0%,
            100% {
                opacity: 0.5;
            }

            50% {
                opacity: 1;
            }
        }

        .section-icon svg {
            width: 26px;
            height: 26px;
            color: white;
        }

        .section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(1.5rem, 5vw, 2.2rem);
            font-weight: 700;
            margin: 0;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section-subtitle {
            color: var(--text-secondary);
            font-size: clamp(0.85rem, 3vw, 1rem);
            margin: 0.5rem 0 0 0;
            line-height: 1.5;
        }

        /* Premium Inputs */
        .input-group {
            position: relative;
            margin-bottom: 1.2rem;
        }

        .input-label {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
            font-size: 14px;
        }

        .premium-input {
            width: 100%;
            background: var(--bg-input);
            border: 1.5px solid var(--border-glass);
            border-radius: 10px;
            padding: 12px 14px;
            color: var(--text-primary);
            font-size: 15px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
        }

        .premium-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow:
                0 0 0 3px rgba(99, 102, 241, 0.1),
                0 8px 25px rgba(99, 102, 241, 0.1);
            transform: translateY(-1px);
        }

        .premium-input::placeholder {
            color: var(--text-muted);
        }

        .premium-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .premium-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 1rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 3rem;
        }

        /* Button System */
        .btn {
            /* --- Estructura y Alineación --- */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            /* 8px */
            position: relative;
            overflow: hidden;

            /* --- Tipografía y Apariencia --- */
            font-size: 1rem;
            /* 16px */
            font-weight: 600;
            /* Corregido de 80 */
            text-decoration: none;
            white-space: nowrap;
            cursor: pointer;
            user-select: none;

            /* --- Dimensiones y Borde --- */
            padding: 0.75rem 1.5rem;
            /* 12px 24px */
            border: 1px solid transparent;
            /* Borde inicial transparente */
            border-radius: 12px;
            /* Más redondeado y moderno */

            /* --- Transiciones --- */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--accent-primary);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .btn:hover::before {
            left: 0;
        }

        .btn:hover {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .btn:disabled::before {
            left: -100% !important;
        }

        .btn-primary {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .btn-primary::before {
            background: var(--accent-primary);
        }

        .btn-secondary {
            border-color: var(--border-glass);
            color: var(--text-primary);
        }

        .btn-secondary::before {
            background: var(--bg-card);
        }

        .btn-secondary:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        /* Option Cards */
        .option-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin: 1.2rem 0;
        }

        .option-card {
            background: var(--bg-card);
            border: 1.5px solid var(--border-glass);
            border-radius: 14px;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
            transition: left 0.6s;
        }

        .option-card:hover::before {
            left: 100%;
        }

        .option-card:hover {
            transform: translateY(-3px);
            border-color: var(--accent-primary);
            box-shadow: 0 15px 40px rgba(99, 102, 241, 0.15);
        }

        .option-card.selected {
            border-color: var(--accent-primary);
            background: rgba(99, 102, 241, 0.05);
            box-shadow:
                0 0 0 1px var(--accent-primary),
                0 10px 30px rgba(99, 102, 241, 0.2);
        }

        .option-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .option-description {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.85rem;
        }

        /* Navigation System - FIXED */
        .navigation {
            display: none;
            position: sticky;
            bottom: 1.5rem;
            margin: 2rem auto 0;
            padding: 1.2rem;
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 18px;
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            max-width: 900px;
            width: calc(100% - 2rem);
            left: 0;
            right: 0;
            z-index: 500;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            width: 100%;
        }

        /* Botones de navegación - estructura base */
        .nav-buttons .btn {
            flex: 1;
            min-width: 0;
            /* Permite que los botones se reduzcan */
            max-width: none;
            /* Remueve límites de ancho máximo */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Botón anterior (izquierda) */
        .nav-buttons .btn:first-child {
            margin-right: 0.5rem;
        }

        /* Botón siguiente (derecha) */
        .nav-buttons .btn:last-child {
            margin-left: 0.5rem;
        }

        /* Cuando solo hay un botón (primera o última página) */
        .nav-buttons .btn:only-child {
            margin: 0;
            max-width: 280px;
            margin: 0 auto;
        }

        /* Cost Display */
        .cost-display {
            background: var(--gradient-success);
            color: white;
            padding: 1rem;
            border-radius: 14px;
            text-align: center;
            margin: 1.2rem 0;
            font-weight: 700;
            font-size: 1rem;
        }

        .cost-breakdown {
            background: var(--bg-input);
            border: 1px solid var(--border-glass);
            border-radius: 14px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.85rem;
        }

        .welcome-content {
            max-width: 100%;
            background: var(--bg-card);
            border: 1px solid var(--border-glass);
            border-radius: 18px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-glass);
            backdrop-filter: blur(24px);
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin: 1rem;
        }

        /* Feature highlights */
        .feature-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.8rem;
            margin: 1.2rem 0;
        }

        .feature-item {
            background: rgba(99, 102, 241, 0.05);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 14px;
            padding: 1rem;
            text-align: center;
        }

        .feature-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-accent);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.6rem;
        }

        /* Animations */
        .fade-up {
            animation: fadeUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Step Indicator */
        .step-indicator {
            position: fixed;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 100;
            display: none;
            flex-direction: column;
            gap: 0.8rem;
        }

        .step-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .step-dot.active {
            background: var(--accent-primary);
            box-shadow: 0 0 12px rgba(99, 102, 241, 0.5);
        }

        .step-dot.completed {
            background: var(--accent-success);
        }

        /* Email Sequence Builder */
        .email-sequence-item {
            background: var(--bg-input);
            border: 1px solid var(--border-glass);
            border-radius: 10px;
            padding: 1rem;
            margin: 0.8rem 0;
            position: relative;
        }

        .email-remove-btn {
            position: absolute;
            top: 6px;
            right: 6px;
            background: var(--accent-tertiary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
        }

        .domain-comparison {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin: 1.2rem 0;
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 18px;
            height: 18px;
            margin: -9px 0 0 -9px;
            border: 2px solid var(--accent-primary);
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }

        /* Hidden utility */
        .hidden {
            display: none !important;
        }

        /* Character Counter */
        .char-counter {
            position: absolute;
            right: 0.8rem;
            bottom: 0.4rem;
            font-size: 11px;
            color: var(--text-muted);
            font-family: 'Space Grotesk', monospace;
        }

        /* Error States */
        .premium-input.error {
            border-color: var(--accent-tertiary) !important;
            box-shadow: 0 0 0 3px rgba(247, 37, 133, 0.1) !important;
        }

        /* Tips Section */
        .tips-section {
            background: rgba(6, 214, 160, 0.05);
            border: 1px solid rgba(6, 214, 160, 0.2);
            border-radius: 14px;
            padding: 1rem;
            margin: 1.2rem 0;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 0.6rem;
            margin-bottom: 0.8rem;
        }

        .tip-item:last-child {
            margin-bottom: 0;
        }

        .tip-icon {
            background: var(--accent-secondary);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: bold;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* Estilos para elementos dinámicos */
        .dynamic-item {
            background: var(--bg-input);
            border: 1px solid var(--border-glass);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            position: relative;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
        }

        .item-header h5 {
            margin: 0;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .remove-btn {
            background: var(--accent-tertiary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .add-item-btn {
            background: var(--accent-success);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 0.6rem 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-weight: 600;
            margin-top: 0.8rem;
            font-size: 0.9rem;
        }

        .add-item-btn:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .module-options-container {
            margin-top: 0.8rem;
            padding: 1.2rem;
            background: rgba(99, 102, 241, 0.05);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 14px;
            display: none;
        }

        .module-options-container.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .social-media-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.8rem;
            margin-top: 0.8rem;
        }

        .social-media-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.6rem;
            background: var(--bg-input);
            border-radius: 10px;
            border: 1px solid var(--border-glass);
        }

        .social-media-item input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            outline: none;
            font-size: 14px;
        }

        .add-social-btn {
            margin-top: 0.8rem;
            background: var(--accent-success);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 0.4rem 0.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.85rem;
        }

        .add-social-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Estilos para la sección de resumen */
        .summary-section {
            padding: 1.5rem;
            background: var(--bg-card);
            border-radius: 14px;
            margin-bottom: 1.5rem;
        }

        .summary-item {
            margin-bottom: 1.2rem;
            padding-bottom: 1.2rem;
            border-bottom: 1px solid var(--border-glass);
        }

        .summary-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .summary-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
        }

        .summary-content {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.9rem;
        }

        .edit-btn {
            background: none;
            border: none;
            color: var(--accent-primary);
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.2rem;
        }

        .action-buttons {
            display: flex;
            gap: 0.8rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .copy-btn {
            background: transparent;
            border: 2px solid var(--accent-secondary);
            color: var(--accent-secondary);
            border-radius: 10px;
            padding: 0.8rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .copy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--accent-secondary);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .copy-btn:hover::before {
            left: 0;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            color: white;
            box-shadow: 0 8px 20px rgba(6, 214, 160, 0.3);
        }

        /* Modal de confirmación de copia */
        .copy-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .copy-modal.visible {
            opacity: 1;
            visibility: visible;
        }

        .copy-modal-content {
            background: var(--bg-card);
            border-radius: 18px;
            padding: 1.5rem;
            text-align: center;
            max-width: 450px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .copy-modal.visible .copy-modal-content {
            transform: scale(1);
        }

        .copy-modal-icon {
            font-size: 2.5rem;
            margin-bottom: 0.8rem;
            color: var(--accent-success);
        }

        .copy-modal-title {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: var(--text-primary);
        }

        .copy-modal-message {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        /* Animación de entrada para la navegación */
        .navigation.show {
            display: block;
            animation: slideUpFade 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes slideUpFade {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Fix para evitar overflow en contenedores pequeños */
        .nav-buttons .btn {
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* Estados especiales para navegación */
        .nav-buttons .btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
        }

        .nav-buttons .btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .nav-buttons .btn:disabled::before {
            left: -100% !important;
        }

        /* ========== MEDIA QUERIES ========== */

        /* Small mobile devices */
        @media (max-width: 360px) {
            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 0.9rem;
            }

            .cta-primary {
                padding: 12px 20px;
                font-size: 14px;
                max-width: 240px;
            }

            .section-title {
                font-size: 1.4rem;
            }

            .glass-card {
                border-radius: 16px;
            }

            .option-card {
                padding: 1rem;
            }

            .navigation {
                padding: 1rem;
                width: calc(100% - 1rem);
                bottom: 1rem;
            }

            .nav-buttons {
                gap: 0.8rem;
            }

            .nav-buttons .btn {
                padding: 10px 12px;
                font-size: 14px;
                min-width: 80px;
            }

            .nav-buttons .btn:first-child,
            .nav-buttons .btn:last-child {
                margin: 0;
            }

            .form-container {
                padding: 0.8rem;
            }

            .btn {
                padding: 10px 16px;
                font-size: 14px;
                max-width: 240px;
            }
        }

        /* Mobile estándar (361px - 575px) */
        @media (min-width: 361px) and (max-width: 575px) {
            .navigation {
                padding: 1.1rem;
            }

            .nav-buttons .btn {
                padding: 12px 16px;
                font-size: 15px;
                min-width: 100px;
            }
        }

        /* Tablets and small screens */
        @media (min-width: 576px) {
            .hero-content {
                padding: 0 1.5rem;
            }

            .hero-badge {
                padding: 8px 20px;
            }

            .cta-primary {
                width: auto;
                max-width: 320px;
            }

            .btn {
                width: auto;
                max-width: 320px;
            }

            .option-grid {
                grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            }

            .navigation {
                padding: 1.3rem;
            }

            .nav-buttons {
                gap: 1.2rem;
            }

            .nav-buttons .btn {
                padding: 14px 20px;
                font-size: 16px;
                min-width: 120px;
            }

            .feature-grid {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            }

            .domain-comparison {
                grid-template-columns: 1fr 1fr;
            }

            .social-media-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .action-buttons {
                flex-direction: row;
                justify-content: center;
            }

            .form-container {
                padding: 1.5rem;
            }

            .step-indicator {
                display: flex;
            }
        }

        /* Medium screens */
        @media (min-width: 768px) {
            .hero-header {
                padding: 2rem;
            }

            .hero-content {
                padding: 0 2rem;
            }

            .hero-title {
                font-size: clamp(3rem, 8vw, 5rem);
            }

            .hero-subtitle {
                font-size: 1.2rem;
            }

            .section-header {
                flex-direction: row;
                text-align: left;
                gap: 1.5rem;
            }

            .section-icon {
                width: 60px;
                height: 60px;
            }

            .section-icon svg {
                width: 30px;
                height: 30px;
            }

            .section-title {
                font-size: 2rem;
            }

            .form-container {
                padding: 2rem;
            }

            .navigation {
                padding: 1.5rem 2rem;
                bottom: 2rem;
            }

            .nav-buttons {
                gap: 1.5rem;
            }

            .nav-buttons .btn {
                padding: 16px 24px;
                font-size: 16px;
                min-width: 140px;
                max-width: 200px;
                /* Límite razonable en desktop */
            }

            /* En desktop, los botones no necesitan ocupar todo el espacio */
            .nav-buttons .btn {
                flex: 0 1 auto;
            }

            /* Cuando solo hay un botón en desktop */
            .nav-buttons .btn:only-child {
                max-width: 200px;
            }

            .welcome-content {
                padding: 2rem;
                max-width: 500px;
            }

            .input-group {
                margin-bottom: 1.5rem;
            }

            .premium-input {
                padding: 14px 16px;
                font-size: 16px;
            }

            .btn {
                padding: 14px 24px;
                font-size: 16px;
            }

            .option-card {
                padding: 1.5rem;
            }

            .option-title {
                font-size: 1.1rem;
            }

            .option-description {
                font-size: 0.9rem;
            }
        }

        /* Large screens */
        @media (min-width: 992px) {
            .hero-content {
                padding: 0 2rem;
            }

            .hero-title {
                font-size: clamp(3.5rem, 8vw, 6rem);
            }

            .option-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 1.5rem;
            }

            .section-header {
                margin-bottom: 2.5rem;
            }

            .section-icon {
                width: 70px;
                height: 70px;
            }

            .section-icon svg {
                width: 35px;
                height: 35px;
            }

            .section-title {
                font-size: 2.3rem;
            }

            .input-group {
                margin-bottom: 1.8rem;
            }

            .premium-input {
                padding: 16px 18px;
                border-radius: 12px;
            }

            .btn {
                padding: 16px 28px;
            }

            .navigation {
                margin-top: 2.5rem;
                padding: 1.8rem 2.5rem;
            }

            .nav-buttons {
                gap: 2rem;
            }

            .nav-buttons .btn {
                padding: 18px 28px;
                min-width: 160px;
                max-width: 220px;
            }

            .cost-display {
                padding: 1.3rem;
                font-size: 1.1rem;
            }

            .feature-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1.2rem;
            }
        }

        /* Extra large screens */
        @media (min-width: 1200px) {
            .hero-content {
                max-width: 900px;
            }

            .form-container {
                max-width: 1000px;
            }

            .section-icon {
                width: 80px;
                height: 80px;
            }

            .section-icon svg {
                width: 40px;
                height: 40px;
            }

            .section-title {
                font-size: 2.5rem;
            }

            .nav-buttons .btn {
                min-width: 180px;
                max-width: 240px;
            }
        }

        /* Orientation adjustments */
        @media (max-height: 500px) and (orientation: landscape) {
            .hero-header {
                min-height: 120vh;
                padding-top: 3rem;
            }

            .step-indicator {
                top: 40%;
            }
        }

        /* High-resolution displays */
        @media (-webkit-min-device-pixel-ratio: 2),
        (min-resolution: 192dpi) {
            .glass-card {
                border-width: 0.5px;
            }
        }

        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            body::before,
            body::after,
            .progress-fill::after,
            .hero-mesh,
            .glass-card::before,
            .cta-primary::before,
            .section-icon::before,
            .option-card::before {
                animation: none !important;
            }

            .navigation.show {
                animation: none;
            }

            .nav-buttons .btn {
                transition: none;
            }
        }
    </style>
</head>

<body>


    <!-- Progress System -->
    <div class="progress-system">
        <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
    </div>

    <!-- Step Indicator -->
    <div class="step-indicator">
        <div class="step-dot active" data-step="0"></div>
        <div class="step-dot" data-step="1"></div>
        <div class="step-dot" data-step="2"></div>
        <div class="step-dot" data-step="3"></div>
        <div class="step-dot" data-step="4"></div>
        <div class="step-dot" data-step="5"></div>
        <div class="step-dot" data-step="6"></div>
        <div class="step-dot" data-step="7"></div>
        <div class="step-dot" data-step="8"></div>
    </div>

    <!-- Hero Header -->
    <section class="hero-header">
        <div class="hero-mesh"></div>
        <div class="hero-content fade-up">
            <div style="margin-bottom: 2rem;">
                <img src="logo-removebg-preview.png" alt="FunnelCraft Pro" class="logo">
            </div>
            <div class="hero-badge">Versión Premium • AI-Powered</div>
            <h1 class="hero-title">FunnelCraft Pro</h1>
            <p class="hero-subtitle">
                Crea funnels de conversión extraordinarios con inteligencia artificial.
                Transforma visitantes en clientes con precisión quirúrgica.
            </p>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <button class="cta-primary" onclick="startBuilding()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    Comenzar Ahora
                </button>
                <button class="btn btn-secondary" onclick="showInfo()" style="padding: 20px 40px; font-size: 18px;">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Ver Información
                </button>
            </div>
        </div>
    </section>

    <!-- Main Form -->
    <main class="form-container">
        <form id="funnelForm" action="https://formspree.io/f/mqalorjq" method="POST" novalidate>

            <!-- Section 1: Contact Information -->
            <section class="glass-card fade-up" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Información de Contacto</h2>
                        <p class="section-subtitle">Comenzamos con tus datos para personalizar la experiencia</p>
                    </div>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">Nombre Completo *</label>
                        <input type="text" name="client_name" class="premium-input" placeholder="Tu nombre completo"
                            required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Email Principal *</label>
                        <input type="email" name="client_email" class="premium-input" placeholder="tu@email.com"
                            required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">WhatsApp *</label>
                        <input type="tel" name="client_phone" class="premium-input" placeholder="+506 8888-8888">
                    </div>
                    <div class="input-group">
                        <label class="input-label">
                            Empresa <span style="color: var(--accent-success); font-size: 12px;">Opcional</span>
                        </label>
                        <input type="text" name="client_business" class="premium-input"
                            placeholder="Nombre de tu empresa">
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿Cómo nos conociste? *</label>
                    <select name="how_found_us" class="premium-input premium-select" required>
                        <option value="">Selecciona una opción...</option>
                        <option value="google">Búsqueda en Google</option>
                        <option value="facebook">Facebook/Instagram</option>
                        <option value="linkedin">LinkedIn</option>
                        <option value="youtube">YouTube</option>
                        <option value="referral">Recomendación de un amigo</option>
                        <option value="client">Eres cliente actual</option>
                        <option value="advertising">Publicidad online</option>
                        <option value="other">Otro</option>
                    </select>
                </div>
            </section>

            <!-- Section 2: Business Information -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Tu Negocio</h2>
                        <p class="section-subtitle">Información sobre tu empresa y mercado</p>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿Qué tipo de negocio tienes? *</label>
                    <select name="business_type" class="premium-input premium-select" required>
                        <option value="">Selecciona tu tipo de negocio...</option>
                        <option value="ecommerce">E-commerce / Tienda Online</option>
                        <option value="services">Servicios Profesionales</option>
                        <option value="coaching">Coaching / Consultoría</option>
                        <option value="education">Educación / Cursos Online</option>
                        <option value="saas">Software / SaaS</option>
                        <option value="agency">Agencia de Marketing</option>
                        <option value="health">Salud y Bienestar</option>
                        <option value="finance">Finanzas / Inversiones</option>
                        <option value="real-estate">Bienes Raíces</option>
                        <option value="restaurant">Restaurante/Alimentación</option>
                        <option value="beauty">Belleza/Cosmética</option>
                        <option value="fitness">Fitness/Deporte</option>
                        <option value="tech">Tecnología/IT</option>
                        <option value="other">Otro</option>
                    </select>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">Etapa del negocio *</label>
                        <select name="business_stage" class="premium-input premium-select" required>
                            <option value="">Seleccionar...</option>
                            <option value="idea">Solo tengo la idea</option>
                            <option value="startup">Empezando (0-6 meses)</option>
                            <option value="early">Temprano (6 meses - 2 años)</option>
                            <option value="established">Establecido (2-5 años)</option>
                            <option value="mature">Maduro (5+ años)</option>
                        </select>
                    </div>

                </div>

                <div class="input-group">
                    <label class="input-label">Describe tu producto/servicio principal *</label>
                    <textarea name="main_product" class="premium-input premium-textarea"
                        placeholder="Explica qué vendes, a qué precio aproximado, y cuál es tu propuesta de valor principal..."
                        required maxlength="400"></textarea>
                    <div class="char-counter">0 / 400</div>
                </div>

            </section>

            <!-- Section 3: Funnel Destination Strategy -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 9m0 8V9m0 0l-6-2" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Destino del Funnel</h2>
                        <p class="section-subtitle">¿A dónde quieres dirigir a tus usuarios?</p>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Objetivo principal del funnel *</label>
                    <select name="funnel_destination" class="premium-input premium-select" required>
                        <option value="">Selecciona el destino principal...</option>
                        <option value="lead-generation">Capturar leads (emails/contactos)</option>
                        <option value="product-sales">Venta directa de productos</option>
                        <option value="service-booking">Agendar citas/consultas</option>
                        <option value="webinar">Registro a webinar en vivo</option>
                        <option value="course-sales">Venta de curso online</option>
                        <option value="membership">Suscripción/Membresía</option>
                        <option value="app-download">Descarga de app/software</option>
                        <option value="event-registration">Registro a evento presencial</option>
                        <option value="consultation">Agendar consulta gratuita</option>
                        <option value="newsletter">Suscripción a newsletter</option>
                        <option value="demo">Solicitar demo del producto</option>
                        <option value="quote">Solicitar cotización</option>
                        <option value="catalog">Descargar catálogo/material</option>
                        <option value="trial">Prueba gratuita</option>
                        <option value="offer">Oferta especial/descuento</option>
                    </select>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">¿De dónde vendrá tu tráfico principal? *</label>
                        <select name="traffic_source" class="premium-input premium-select" required>
                            <option value="">Seleccionar fuente...</option>
                            <option value="facebook-ads">Facebook/Instagram Ads</option>
                            <option value="google-ads">Google Ads</option>
                            <option value="social-organic">Redes Sociales Orgánicas</option>
                            <option value="email-list">Lista de Email existente</option>
                            <option value="seo">SEO/Tráfico Orgánico</option>
                            <option value="influencers">Influencers/Afiliados</option>
                            <option value="referrals">Referencias/Word of mouth</option>
                            <option value="whatsapp">WhatsApp Business</option>
                            <option value="linkedin">LinkedIn</option>
                            <option value="youtube">YouTube</option>
                            <option value="tiktok">TikTok</option>
                            <option value="podcast">Podcast/Audio</option>
                            <option value="print">Medios impresos</option>
                            <option value="multiple">Múltiples fuentes</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Meta de conversiones mensuales *</label>
                        <select name="conversion_goal" class="premium-input premium-select" required>
                            <option value="">Seleccionar...</option>
                            <option value="1-10">1 - 10 conversiones</option>
                            <option value="10-50">10 - 50 conversiones</option>
                            <option value="50-100">50 - 100 conversiones</option>
                            <option value="100-500">100 - 500 conversiones</option>
                            <option value="500-1000">500 - 1,000 conversiones</option>
                            <option value="over-1000">Más de 1,000 conversiones</option>
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Describe tu cliente ideal *</label>
                    <textarea name="target_audience" class="premium-input premium-textarea"
                        placeholder="Edad, género, profesión, nivel de ingresos, problemas que enfrentan, deseos principales, dónde pasan tiempo online..."
                        maxlength="500"></textarea>
                    <div class="char-counter">0 / 500</div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿Qué hace única tu propuesta de valor? *</label>
                    <textarea name="unique_value" class="premium-input premium-textarea"
                        placeholder="Tu diferenciador clave vs competencia, el beneficio principal que ofreces, por qué deberían elegirte a ti..."
                        required maxlength="300"></textarea>
                    <div class="char-counter">0 / 300</div>
                </div>
            </section>

            <!-- Section 4: Follow-up System -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 8l7.89 7.89a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Sistema de Seguimiento</h2>
                        <p class="section-subtitle">Mantén contacto con tus leads de forma automatizada</p>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Método de seguimiento preferido *</label>
                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="followup_method" value="email" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Email Marketing</div>
                                <div class="option-description">Seguimiento por correo electrónico</div>
                                <div
                                    style="color: var(--accent-success); font-size: 14px; font-weight: 600; margin-top: 0.5rem;">
                                    GRATIS</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="followup_method" value="whatsapp" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">WhatsApp Business</div>
                                <div class="option-description">Seguimiento por WhatsApp automatizado</div>
                                <div
                                    style="color: var(--accent-warning); font-size: 14px; font-weight: 600; margin-top: 0.5rem;">
                                    +$30 USD</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="followup_method" value="both" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Email + WhatsApp</div>
                                <div class="option-description">Doble seguimiento para máxima efectividad</div>
                                <div
                                    style="color: var(--accent-warning); font-size: 14px; font-weight: 600; margin-top: 0.5rem;">
                                    +$30 USD</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="followup_method" value="none" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Sin seguimiento</div>
                                <div class="option-description">Solo capturar datos, sin automatización</div>
                                <div
                                    style="color: var(--accent-success); font-size: 14px; font-weight: 600; margin-top: 0.5rem;">
                                    GRATIS</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Email Follow-up Options -->
                <div id="emailFollowupOptions" class="glass-card hidden"
                    style="padding: 2rem; background: rgba(6, 214, 160, 0.05); border-color: rgba(6, 214, 160, 0.2);">
                    <h3 style="color: var(--accent-secondary); margin-bottom: 1.5rem; font-size: 1.25rem;">Configuración
                        Email Marketing</h3>

                    <div class="input-group">
                        <label class="input-label">Mensaje de bienvenida (incluido gratis)</label>
                        <textarea name="welcome_email" class="premium-input premium-textarea"
                            placeholder="Escribe el mensaje que recibirán inmediatamente después de suscribirse..."
                            maxlength="500"></textarea>
                        <div class="char-counter">0 / 500</div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">¿Quieres emails de seguimiento adicionales?</label>
                        <select name="additional_emails" class="premium-input premium-select">
                            <option value="none">Solo email de bienvenida (gratis)</option>
                            <option value="1">1 email adicional (+$3 USD)</option>
                            <option value="2">2 emails adicionales (+$6 USD)</option>
                            <option value="3">3 emails adicionales (+$9 USD)</option>
                            <option value="4">4 emails adicionales (+$12 USD)</option>
                            <option value="5">5 emails adicionales (+$15 USD)</option>
                            <option value="custom">Más de 5 emails (precio personalizado)</option>
                        </select>
                    </div>

                    <div id="emailScheduleOptions" class="hidden">
                        <div class="input-group">
                            <label class="input-label">Frecuencia de envío</label>
                            <select name="email_frequency" class="premium-input premium-select">
                                <option value="daily">Diario</option>
                                <option value="every-2-days">Cada 2 días</option>
                                <option value="every-3-days">Cada 3 días</option>
                                <option value="weekly">Semanal</option>
                                <option value="bi-weekly">Cada 2 semanas</option>
                                <option value="monthly">Mensual</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                    </div>

                    <div id="emailSequenceBuilder" class="hidden">
                        <h4 style="color: var(--text-primary); margin: 1.5rem 0 1rem;">Secuencia de Emails</h4>
                        <div id="emailSequenceContainer"></div>
                        <button type="button" id="addEmailBtn" class="btn btn-secondary" style="margin-top: 1rem;">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                            Agregar Email
                        </button>
                    </div>

                    <div id="additionalEmailCost" class="hidden cost-display"
                        style="background: var(--accent-warning); margin-top: 1rem;">
                        Costo adicional: <span id="emailCostAmount">$0</span> USD
                    </div>
                </div>

                <!-- WhatsApp Follow-up Options -->
                <div id="whatsappFollowupOptions" class="glass-card hidden"
                    style="padding: 2rem; background: rgba(37, 211, 102, 0.05); border-color: rgba(37, 211, 102, 0.2);">
                    <h3 style="color: #25d366; margin-bottom: 1.5rem; font-size: 1.25rem;">Configuración WhatsApp
                        Business</h3>

                    <div class="input-group">
                        <label class="input-label">Mensaje de bienvenida WhatsApp</label>
                        <textarea name="whatsapp_welcome" class="premium-input premium-textarea"
                            placeholder="Mensaje que se enviará por WhatsApp después del registro..."
                            maxlength="300"></textarea>
                        <div class="char-counter">0 / 300</div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Frecuencia de mensajes WhatsApp</label>
                        <select name="whatsapp_frequency" class="premium-input premium-select">
                            <option value="immediate">Solo mensaje de bienvenida</option>
                            <option value="daily">Mensaje diario por 3 días</option>
                            <option value="weekly">Mensaje semanal por 4 semanas</option>
                            <option value="custom">Frecuencia personalizada</option>
                        </select>
                    </div>

                    <div class="tips-section">
                        <h5 style="color: #25d366; margin-bottom: 0.5rem;">Incluye configuración WhatsApp Business:</h5>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 1rem;">
                            <li>API de WhatsApp Business</li>
                            <li>Mensajes automatizados</li>
                            <li>Plantillas aprobadas por WhatsApp</li>
                            <li>Sistema de respuestas automáticas</li>
                            <li>Integración con tu CRM</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 5: Content Creation -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Contenido Principal</h2>
                        <p class="section-subtitle">Las palabras que convertirán a tus visitantes</p>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Título que impacte (Headline) *</label>
                    <div style="position: relative;">
                        <textarea name="hero_title" class="premium-input"
                            placeholder="Ej: Domina el Marketing Digital y Multiplica tus Ventas en 30 Días"
                            maxlength="150" required style="min-height: 80px;"></textarea>
                        <div class="char-counter">0 / 150</div>
                    </div>
                    <div class="tips-section">
                        <h5 style="color: var(--accent-secondary); margin-bottom: 0.5rem;">💡 Tips para un headline
                            efectivo:</h5>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 1rem;">
                            <li>Incluye un beneficio específico</li>
                            <li>Menciona un marco temporal</li>
                            <li>Usa números cuando sea posible</li>
                            <li>Crea urgencia o curiosidad</li>
                        </ul>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Subtítulo persuasivo *</label>
                    <div style="position: relative;">
                        <textarea name="hero_description" class="premium-input premium-textarea"
                            placeholder="Amplía tu headline. Explica cómo lograrás ese beneficio, para quién es, qué incluye..."
                            maxlength="400" required></textarea>
                        <div class="char-counter">0 / 400</div>
                    </div>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">Botón Principal (CTA) *</label>
                        <input type="text" name="cta_text" class="premium-input" placeholder="¡Quiero Acceder Ahora!"
                            required maxlength="50">
                    </div>
                    <div class="input-group">
                        <label class="input-label">
                            Botón Secundario <span
                                style="color: var(--accent-success); font-size: 12px;">Opcional</span>
                        </label>
                        <input type="text" name="cta_secondary" class="premium-input" placeholder="Ver más información"
                            maxlength="50">
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">
                        Garantía o compromiso <span
                            style="color: var(--accent-success); font-size: 12px;">Opcional</span>
                    </label>
                    <textarea name="guarantee" class="premium-input"
                        placeholder="Ej: Garantía de 30 días o te devolvemos tu dinero" maxlength="200"></textarea>
                    <div class="char-counter">0 / 200</div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿Tienes algún reconocimiento o credencial importante?</label>
                    <textarea name="credentials" class="premium-input"
                        placeholder="Ej: Certificado por Google, 10 años de experiencia, Más de 1000 clientes satisfechos..."
                        maxlength="300"></textarea>
                    <div class="char-counter">0 / 300</div>
                </div>
            </section>

            <!-- Section 6: Advanced Features -->
            <!-- Section 6: Advanced Features -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 10V3L4 14h7v7l9-11h-7z" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Funciones Avanzadas</h2>
                        <p class="section-subtitle">Potencia tu funnel con características premium</p>
                    </div>
                </div>

                <!-- Data Collection -->
                <div class="glass-card"
                    style="padding: 2rem; margin-bottom: 2rem; background: rgba(16, 185, 129, 0.05); border-color: rgba(16, 185, 129, 0.2);">
                    <h3
                        style="color: var(--accent-success); margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">
                        📊 Campos de Captura de Datos
                    </h3>
                    <p style="color: var(--accent-success); margin-bottom: 1.5rem;">
                        <strong>4 campos GRATIS</strong> • Adicionales: $5 USD c/u
                    </p>

                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <label class="option-card selected" style="padding: 1rem;">
                            <input type="checkbox" name="user_data_fields[]" value="email" checked disabled
                                style="margin-right: 0.5rem;">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">Email</div>
                                <div style="color: var(--accent-success); font-size: 12px; font-weight: 600;">Incluido
                                </div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="full_name"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Nombre Completo</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="phone"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Teléfono</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="company"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Empresa</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="job_title"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Cargo</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="country"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">País</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="age" style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Edad</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="budget"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Presupuesto</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="source"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">¿Cómo nos conociste?</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="user_data_fields[]" value="interest"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Principal Interés</div>
                        </label>
                    </div>

                    <div id="dataFieldsCostWarning" class="hidden"
                        style="background: rgba(247, 37, 133, 0.1); border: 1px solid rgba(247, 37, 133, 0.3); border-radius: 12px; padding: 1rem; margin-top: 1rem; color: var(--accent-tertiary);">
                        <div id="dataFieldsCostText"></div>
                    </div>
                </div>

                <!-- Extra Modules -->
                <!-- Extra Modules -->
                <div class="glass-card" style="padding: 2rem; margin-bottom: 2rem;">
                    <h3
                        style="color: var(--accent-primary); margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">
                        ⚡ Módulos Extras
                    </h3>
                    <p style="color: var(--accent-tertiary); margin-bottom: 1.5rem;">
                        <strong>4 módulos GRATIS</strong> • Adicionales: $15 USD c/u
                    </p>

                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="testimonials"
                                style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('testimonials', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">✨ Testimonios</div>
                                <div class="option-description">Reseñas y testimonios de clientes</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="social_media"
                                style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('socialMedia', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">📱 Redes Sociales</div>
                                <div class="option-description">Enlaces a redes sociales</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="faq" style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('faq', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">❓ FAQ</div>
                                <div class="option-description">Preguntas frecuentes</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="countdown"
                                style="margin-right: 0.5rem;" onchange="toggleModuleOptions('countdown', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">⏰ Contador Regresivo</div>
                                <div class="option-description">Crear urgencia con tiempo límite</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="pricing" style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('pricing', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">💰 Tabla de Precios</div>
                                <div class="option-description">Comparar planes y precios</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="video" style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('video', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">🎥 Video Explicativo</div>
                                <div class="option-description">Player de video optimizado</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="Pop_Up" style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('liveChat', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">💬 Pop-up</div>
                                <div class="option-description">Soporte instantáneo</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="social_proof"
                                style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('socialProof', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">👥 Prueba Social</div>
                                <div class="option-description">Contadores en tiempo real</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="bonus_stack"
                                style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('bonusStack', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">🎁 Stack de Bonos</div>
                                <div class="option-description">Aumenta el valor percibido</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="calculator"
                                style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('calculator', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">📈 Caso de Estudio</div>
                                <div class="option-description">narra en detalle la experiencia de un cliente anterior
                                </div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="calendar" style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('calendar', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">📅 Calendario</div>
                                <div class="option-description">Agendar citas online</div>
                            </div>
                        </label>

                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="extra_modules[]" value="gallery" style="margin-right: 0.5rem;"
                                onchange="toggleModuleOptions('gallery', this.checked)">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">🖼️ Galería</div>
                                <div class="option-description">Galería de imágenes</div>
                            </div>
                        </label>
                    </div>

                    <!-- Dynamic Module Options -->

                    <!-- Testimonios Options -->
                    <div id="testimonialsOptions" class="module-options-container">
                        <h4>Configuración de Testimonios</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Agrega testimonios de clientes para aumentar la confianza
                        </p>

                        <div id="testimonialsContainer">
                            <div class="dynamic-item">
                                <div class="item-header">
                                    <h5>Testimonio 1</h5>
                                    <button type="button" class="remove-btn"
                                        onclick="removeTestimonial(this)">×</button>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Nombre del cliente</label>
                                    <input type="text" name="testimonial_author[]" class="premium-input"
                                        placeholder="Juan Pérez">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Cargo o empresa</label>
                                    <input type="text" name="testimonial_role[]" class="premium-input"
                                        placeholder="CEO, Empresa XYZ">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Testimonio</label>
                                    <textarea name="testimonial_content[]" class="premium-input premium-textarea"
                                        placeholder="Excelente servicio, recomendado al 100%..."></textarea>
                                </div>
                                <div class="input-group">
                                    <label
                                        style="color: var(--text-secondary); font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" name="testimonial_with_image[]">
                                        Incluir foto del cliente
                                    </label>
                                </div>
                            </div>
                        </div>

                        <button type="button" class="add-item-btn" onclick="addTestimonial()">
                            <span>+</span> Agregar testimonio
                        </button>
                    </div>

                    <!-- Social Media Options -->
                    <div id="socialMediaOptions" class="module-options-container">
                        <h4>Configuración de Redes Sociales</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Agrega enlaces a tus redes sociales (máximo 6)
                        </p>

                        <div id="socialMediaContainer">
                            <div class="dynamic-item">
                                <div class="item-header">
                                    <h5>Red Social 1</h5>
                                    <button type="button" class="remove-btn"
                                        onclick="removeSocialMedia(this)">×</button>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Plataforma</label>
                                    <select name="social_platform[]" class="premium-input">
                                        <option value="">Selecciona...</option>
                                        <option value="facebook">Facebook</option>
                                        <option value="instagram">Instagram</option>
                                        <option value="twitter">Twitter</option>
                                        <option value="linkedin">LinkedIn</option>
                                        <option value="youtube">YouTube</option>
                                        <option value="tiktok">TikTok</option>
                                        <option value="whatsapp">WhatsApp</option>
                                        <option value="telegram">Telegram</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">URL</label>
                                    <input type="url" name="social_url[]" class="premium-input"
                                        placeholder="https://facebook.com/tunegocio">
                                </div>
                            </div>
                        </div>

                        <button type="button" class="add-item-btn" onclick="addSocialMedia()">
                            <span>+</span> Agregar red social
                        </button>
                    </div>

                    <!-- FAQ Options -->
                    <div id="faqOptions" class="module-options-container">
                        <h4>Configuración de FAQ</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Agrega las preguntas y respuestas más comunes
                        </p>

                        <div id="faqContainer">
                            <div class="dynamic-item">
                                <div class="item-header">
                                    <h5>Pregunta 1</h5>
                                    <button type="button" class="remove-btn" onclick="removeFaq(this)">×</button>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Pregunta</label>
                                    <input type="text" name="faq_question[]" class="premium-input"
                                        placeholder="¿Cuál es el tiempo de entrega?">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Respuesta</label>
                                    <textarea name="faq_answer[]" class="premium-input premium-textarea"
                                        placeholder="El tiempo de entrega es de 3 a 5 días hábiles..."></textarea>
                                </div>
                            </div>
                        </div>

                        <button type="button" class="add-item-btn" onclick="addFaq()">
                            <span>+</span> Agregar pregunta
                        </button>
                    </div>

                    <!-- Countdown Options -->
                    <div id="countdownOptions" class="module-options-container">
                        <h4>Configuración del Contador Regresivo</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Crea urgencia con un límite de tiempo
                        </p>

                        <div class="input-group">
                            <label class="input-label">Título del contador</label>
                            <input type="text" name="countdown_title" class="premium-input"
                                placeholder="¡Oferta por tiempo limitado!">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Fecha y hora límite</label>
                            <input type="datetime-local" name="countdown_end_date" class="premium-input">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Mensaje cuando termine</label>
                            <input type="text" name="countdown_expired_message" class="premium-input"
                                placeholder="¡La oferta ha terminado!">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Estilo del contador</label>
                            <select name="countdown_style" class="premium-input">
                                <option value="modern">Moderno</option>
                                <option value="classic">Clásico</option>
                                <option value="minimal">Minimalista</option>
                                <option value="bold">Llamativo</option>
                            </select>
                        </div>
                    </div>

                    <!-- Pricing Table Options -->
                    <div id="pricingOptions" class="module-options-container">
                        <h4>Configuración de Tabla de Precios</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Compara diferentes planes y precios
                        </p>

                        <div id="pricingPlansContainer">
                            <div class="dynamic-item">
                                <div class="item-header">
                                    <h5>Plan 1</h5>
                                    <button type="button" class="remove-btn"
                                        onclick="removePricingPlan(this)">×</button>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Nombre del plan</label>
                                    <input type="text" name="pricing_plan_name[]" class="premium-input"
                                        placeholder="Plan Básico">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Precio</label>
                                    <input type="number" name="pricing_plan_price[]" class="premium-input"
                                        placeholder="29">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Período</label>
                                    <select name="pricing_plan_period[]" class="premium-input">
                                        <option value="monthly">Mensual</option>
                                        <option value="yearly">Anual</option>
                                        <option value="lifetime">De por vida</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Características (una por línea)</label>
                                    <textarea name="pricing_plan_features[]" class="premium-input premium-textarea"
                                        placeholder="Característica 1&#10;Característica 2&#10;Característica 3"></textarea>
                                </div>
                                <div class="input-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" name="pricing_plan_popular[]">
                                        Marcar como "Más popular"
                                    </label>
                                </div>
                            </div>
                        </div>

                        <button type="button" class="add-item-btn" onclick="addPricingPlan()">
                            <span>+</span> Agregar plan
                        </button>
                    </div>

                    <!-- Video Options -->
                    <div id="videoOptions" class="module-options-container">
                        <h4>Configuración de Video</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Agrega un video explicativo o promocional
                        </p>

                        <div class="input-group">
                            <label class="input-label">Título del video</label>
                            <input type="text" name="video_title" class="premium-input"
                                placeholder="Conoce nuestro producto">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Fuente del video</label>
                            <select name="video_source" class="premium-input">
                                <option value="youtube">YouTube</option>
                                <option value="vimeo">Vimeo</option>
                                <option value="direct">URL directa</option>
                                <option value="upload">Subir archivo</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="input-label">URL o ID del video</label>
                            <input type="text" name="video_url" class="premium-input"
                                placeholder="https://youtube.com/watch?v=... o ID del video">
                        </div>
                        <div class="input-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" name="video_autoplay">
                                Reproducir automáticamente
                            </label>
                        </div>
                        <div class="input-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" name="video_controls" checked>
                                Mostrar controles
                            </label>
                        </div>
                    </div>

                    <!-- Pop-Up Options -->
                    <div id="liveChatOptions" class="module-options-container">
                        <h4>Configuración de Pop-up p</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Configura tu ventana emergente para captar la atención de tus visitantes.
                        </p>

                        <div class="input-group">
                            <label class="input-label">Momento de Activación</label>
                            <select name="Pop_Up_provider" class="premium-input">
                                <option value="">Selecciona...</option>
                                <option value="whatsapp">Por tiempo en la página</option>
                                <option value="facebook">Facebook Messenger</option>
                                <option value="tawk">Por porcentaje de scroll</option>
                                <option value="livechat">Al intentar salirt</option>

                            </select>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Título del Pop-up</label>
                            <input type="text" name="Pop_Up_id" class="premium-input"
                                placeholder="Ej: ¡Oferta Exclusiva!">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Mensaje</label>
                            <input type="text" name="Pop_Up_hours" class="premium-input"
                                placeholder="Ej: Obtén un 20 % de descuento en tu primer compra al suscribirte">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Texto del Botón (CTA)</label>
                            <textarea name="Pop_Up_welcome" class="premium-input premium-textarea"
                                placeholder="Ej: ¡Quiero mi Descuento!"></textarea>
                        </div>
                    </div>

                    <!-- Social Proof Options -->
                    <div id="socialProofOptions" class="module-options-container">
                        <h4>Configuración de Prueba Social</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Muestra estadísticas en tiempo real para generar confianza
                        </p>

                        <div id="socialProofContainer">
                            <div class="dynamic-item">
                                <div class="item-header">
                                    <h5>Contador 1</h5>
                                    <button type="button" class="remove-btn"
                                        onclick="removeSocialProof(this)">×</button>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Tipo de contador</label>
                                    <select name="social_proof_type[]" class="premium-input">
                                        <option value="clients">Clientes satisfechos</option>
                                        <option value="projects">Proyectos completados</option>
                                        <option value="downloads">Descargas</option>
                                        <option value="users">Usuarios activos</option>
                                        <option value="countries">Países</option>
                                        <option value="custom">Personalizado</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Valor inicial</label>
                                    <input type="number" name="social_proof_value[]" class="premium-input"
                                        placeholder="1000">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Texto descriptivo</label>
                                    <input type="text" name="social_proof_text[]" class="premium-input"
                                        placeholder="Clientes felices">
                                </div>
                                <div class="input-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" name="social_proof_animated[]" checked>
                                        Animación de conteo
                                    </label>
                                </div>
                            </div>
                        </div>

                        <button type="button" class="add-item-btn" onclick="addSocialProof()">
                            <span>+</span> Agregar contador
                        </button>
                    </div>

                    <!-- Bonus Stack Options -->
                    <div id="bonusStackOptions" class="module-options-container">
                        <h4>Configuración de Stack de Bonos</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Agrega bonos para aumentar el valor percibido de tu oferta
                        </p>

                        <div id="bonusContainer">
                            <div class="dynamic-item">
                                <div class="item-header">
                                    <h5>Bono 1</h5>
                                    <button type="button" class="remove-btn" onclick="removeBonus(this)">×</button>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Nombre del bono</label>
                                    <input type="text" name="bonus_name[]" class="premium-input"
                                        placeholder="Guía avanzada">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Valor percibido</label>
                                    <input type="text" name="bonus_value[]" class="premium-input" placeholder="$97 USD">
                                </div>
                                <div class="input-group">
                                    <label class="input-label">Descripción del bono</label>
                                    <textarea name="bonus_description[]" class="premium-input premium-textarea"
                                        placeholder="Incluye técnicas avanzadas que triplicarán tus resultados..."></textarea>
                                </div>
                                <div class="input-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" name="bonus_limited[]">
                                        Bono por tiempo limitado
                                    </label>
                                </div>
                            </div>
                        </div>

                        <button type="button" class="add-item-btn" onclick="addBonus()">
                            <span>+</span> Agregar bono
                        </button>
                    </div>

                    <!-- Calculator Options -->
                    <div id="calculatorOptions" class="module-options-container">
                        <h4>Configuración de Caso de Estudio</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Demuestra tus resultados narrando una historia de éxito de tus clientes.
                        </p>
                        <div class="input-group">
                            <label class="input-label">Título del Caso de Estudio</label>
                            <input type="text" name="calculator_title" class="premium-input"
                                placeholder="Ej: Cómo aumentamos las ventas  en un 30%">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Problema del Cliente</label>
                            <textarea name="calculator_description" class="premium-input premium-textarea"
                                placeholder="Describe el desafío o problema inicial que el cliente enfrentaba."></textarea>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Solución Ofrecida</label>
                            <textarea name="calculator_description" class="premium-input premium-textarea"
                                placeholder="Detalla cómo tu producto o servicio resolvió el problema."></textarea>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Nombre del Cliente </label>
                            <textarea name="case_study_results" class="premium-input premium-textarea"
                                placeholder="Ej: Pedro Pérez"></textarea>
                        </div>
                    </div>

                    <!-- Calendar Options -->
                    <div id="calendarOptions" class="module-options-container">
                        <h4>Configuración de Calendario</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Permite a tus clientes agendar citas directamente
                        </p>

                        <div class="input-group">
                            <label class="input-label">Proveedor de calendario</label>
                            <select name="calendar_provider" class="premium-input">
                                <option value="">Selecciona...</option>
                                <option value="calendly">Calendly</option>
                                <option value="acuity">Acuity Scheduling</option>
                                <option value="google">Google Calendar</option>
                                <option value="custom">Sistema personalizado</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="input-label">URL de tu calendario</label>
                            <input type="url" name="calendar_url" class="premium-input"
                                placeholder="https://calendly.com/tu-usuario">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Tipos de citas disponibles</label>
                            <textarea name="calendar_appointment_types" class="premium-input premium-textarea"
                                placeholder="Consulta inicial - 30 min&#10;Sesión completa - 60 min"></textarea>
                        </div>
                        <div class="input-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" name="calendar_confirmation" checked>
                                Enviar email de confirmación
                            </label>
                        </div>
                    </div>

                    <!-- Gallery Options -->
                    <div id="galleryOptions" class="module-options-container">
                        <h4>Configuración de Galería</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Muestra una colección de imágenes
                        </p>

                        <div class="input-group">
                            <label class="input-label">Título de la galería</label>
                            <input type="text" name="gallery_title" class="premium-input"
                                placeholder="Nuestros trabajos">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Estilo de galería</label>
                            <select name="gallery_style" class="premium-input">
                                <option value="grid">Cuadrícula</option>
                                <option value="masonry">Mosaico</option>
                                <option value="carousel">Carrusel</option>
                                <option value="lightbox">Lightbox</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Número de columnas</label>
                            <select name="gallery_columns" class="premium-input">
                                <option value="2">2 columnas</option>
                                <option value="3">3 columnas</option>
                                <option value="4">4 columnas</option>
                            </select>
                        </div>

                        <div class="tips-section">
                            <h5>📁 Subida de imágenes</h5>
                            <p style="color: var(--text-secondary); font-size: 14px;">
                                Las imágenes se subirán a través del sistema de archivos de Google Drive que
                                configuraste anteriormente.
                                Recuerda organizar las imágenes en una carpeta llamada "Galería".
                            </p>
                        </div>
                    </div>
                </div>
            </section>


            <!-- Section 7: Domain & Technical Setup -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Dominio y Configuración</h2>
                        <p class="section-subtitle">Configuración técnica de tu funnel</p>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Opción de dominio *</label>
                    <div class="domain-comparison">
                        <label class="option-card" style="padding: 2rem; cursor: pointer;">
                            <input type="radio" name="domain_option" value="subdomain" style="margin-bottom: 1rem;"
                                required>
                            <div>
                                <div class="option-title">Subdominio Gratuito</div>
                                <div class="option-description" style="margin: 1rem 0;">
                                    tunegocio.vercel.app
                                </div>
                                <div
                                    style="color: var(--accent-success); font-size: 16px; font-weight: 700; margin-bottom: 1rem;">
                                    GRATIS</div>
                                <div style="font-size: 14px; color: var(--text-secondary);">
                                    <div>✅ SSL incluido</div>
                                    <div>✅ Hosting incluido</div>
                                    <div>✅ Configuración automática</div>
                                    <div>⚠️ Incluye la marca del hosting</div>
                                </div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 2rem; cursor: pointer;">
                            <input type="radio" name="domain_option" value="custom" style="margin-bottom: 1rem;"
                                required>
                            <div>
                                <div class="option-title">Dominio Personalizado</div>
                                <div class="option-description" style="margin: 1rem 0;">
                                    tunegocio.com
                                </div>
                                <div
                                    style="color: var(--accent-warning); font-size: 16px; font-weight: 700; margin-bottom: 1rem;">
                                    +$25 USD/año</div>
                                <div style="font-size: 14px; color: var(--text-secondary);">
                                    <div>✅ Tu propia marca</div>
                                    <div>✅ SSL incluido</div>
                                    <div>✅ Hosting incluido</div>
                                    <div>✅ Configuración completa</div>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <div id="customDomainOptions" class="hidden">
                    <div class="input-group">
                        <label class="input-label">Nombre de dominio deseado</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <input type="text" name="custom_domain_name" class="premium-input" placeholder="tunegocio"
                                style="flex: 1;">
                            <select name="domain_extension" class="premium-input premium-select"
                                style="min-width: 100px;">
                                <option value=".com">.com</option>
                                <option value=".net">.net</option>
                                <option value=".org">.org</option>
                                <option value=".co">.co</option>
                                <option value=".io">.io</option>
                                <option value=".biz">.biz</option>
                            </select>
                        </div>
                        <div style="color: var(--text-muted); font-size: 12px; margin-top: 0.5rem;">
                            Verificaremos disponibilidad y te contactaremos si no está disponible
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 8: Design & Brand -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4 4 4 0 004-4V5z" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Diseño y Marca</h2>
                        <p class="section-subtitle">Personaliza la apariencia de tu funnel</p>
                    </div>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">Color Principal de tu Marca</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <input type="color" name="primary_color" value="#6366f1"
                                style="width: 60px; height: 60px; border-radius: 12px; border: 2px solid var(--border-glass); cursor: pointer;">
                            <input type="text" name="primary_color_hex" value="#6366f1" class="premium-input"
                                style="flex: 1;" placeholder="#6366f1">
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Color Secundario</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <input type="color" name="secondary_color" value="#10b981"
                                style="width: 60px; height: 60px; border-radius: 12px; border: 2px solid var(--border-glass); cursor: pointer;">
                            <input type="text" name="secondary_color_hex" value="#10b981" class="premium-input"
                                style="flex: 1;" placeholder="#10b981">
                        </div>
                    </div>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">Fuente para Títulos</label>
                        <select name="heading_font" class="premium-input premium-select">
                            <option value="space-grotesk">Space Grotesk (Moderna)</option>
                            <option value="inter">Inter (Limpia)</option>
                            <option value="poppins">Poppins (Redondeada)</option>
                            <option value="montserrat">Montserrat (Elegante)</option>
                            <option value="roboto">Roboto (Tecnológica)</option>
                            <option value="playfair">Playfair Display (Elegante)</option>
                            <option value="oswald">Oswald (Impactante)</option>
                            <option value="raleway">Raleway (Sofisticada)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Fuente para Texto</label>
                        <select name="body_font" class="premium-input premium-select">
                            <option value="inter">Inter (Versátil)</option>
                            <option value="roboto">Roboto (Limpia)</option>
                            <option value="opensans">Open Sans (Legible)</option>
                            <option value="lato">Lato (Profesional)</option>
                            <option value="nunito">Nunito (Amigable)</option>
                            <option value="source-sans">Source Sans Pro (Corporativo)</option>
                            <option value="work-sans">Work Sans (Moderna)</option>
                            <option value="libre-franklin">Libre Franklin (Elegante)</option>
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Estilo de diseño preferido *</label>
                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="design_style" value="modern" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Moderno</div>
                                <div class="option-description">Limpio, minimalista, espacios blancos</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="design_style" value="professional" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Profesional</div>
                                <div class="option-description">Corporativo, serio, confiable</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="design_style" value="creative" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Creativo</div>
                                <div class="option-description">Colorido, dinámico, innovador</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="design_style" value="luxury" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Premium</div>
                                <div class="option-description">Elegante, exclusivo, sofisticado</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="design_style" value="friendly" style="margin-right: 0.5rem;"
                                required>
                            <div>
                                <div class="option-title">Amigable</div>
                                <div class="option-description">Cálido, accesible, cercano</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1.5rem; cursor: pointer;">
                            <input type="radio" name="design_style" value="bold" style="margin-right: 0.5rem;" required>
                            <div>
                                <div class="option-title">Atrevido</div>
                                <div class="option-description">Impactante, llamativo, audaz</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Elementos visuales adicionales</label>
                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));">
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="visual_elements[]" value="gradients"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Gradientes</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="visual_elements[]" value="shadows"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Sombras</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="visual_elements[]" value="animations"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Animaciones</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="visual_elements[]" value="icons" style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Iconos</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="visual_elements[]" value="patterns"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Patrones</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="visual_elements[]" value="illustrations"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Ilustraciones</div>
                        </label>
                    </div>
                </div>

                <!-- File Upload -->
                <div class="glass-card"
                    style="padding: 2rem; background: rgba(6, 214, 160, 0.05); border-color: rgba(6, 214, 160, 0.2);">
                    <h3
                        style="color: var(--accent-secondary); margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">
                        📁 Archivos de tu Marca
                    </h3>
                    <p style="color: var(--accent-secondary); margin-bottom: 1.5rem;">
                        Sube tu logo, imágenes, videos y cualquier archivo necesario para tu funnel
                    </p>
                    <a href="https://drive.google.com/drive/folders/1UyFbNW71LQ2rWQK4NKjwu0TUxWRfkBnr?usp=drive_link"
                        target="_blank" class="btn btn-primary" style="width: 100%;">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                        Subir Archivos a Google Drive
                    </a>
                    <p style="color: var(--text-muted); font-size: 12px; margin-top: 1rem; text-align: center;">
                        Formatos recomendados: PNG, JPG, MP4, PDF, SVG. Tamaño máximo: 50MB por archivo
                    </p>

                    <div class="tips-section" style="margin-top: 1.5rem;">
                        <h5 style="color: var(--accent-secondary); margin-bottom: 0.5rem;">Archivos importantes a
                            incluir:</h5>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 1rem;">
                            <li>Logo en alta resolución (PNG transparente)</li>
                            <li>Imágenes de productos o servicios</li>
                            <li>Videos promocionales o explicativos</li>
                            <li>Testimonios en video o audio</li>
                            <li>Certificados o credenciales</li>
                            <li>Fotos del equipo o instalaciones</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 9: Final Review & Additional Information -->
            <section class="glass-card fade-up hidden" style="padding: 3rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Revisión Final</h2>
                        <p class="section-subtitle">Últimos detalles para crear tu funnel perfecto</p>
                    </div>
                </div>

                <div class="option-grid">
                    <div class="input-group">
                        <label class="input-label">Tiempo de entrega preferido *</label>
                        <select name="timeframe" class="premium-input premium-select" required>
                            <option value="">Seleccionar...</option>
                            <option value="urgent">Urgente - 24-48 horas</option>
                            <option value="fast">Rápido - 3-5 días</option>
                            <option value="standard">Estándar - 1 semana</option>
                            <option value="relaxed">Relajado - 2 semanas</option>
                            <option value="flexible">Flexible - Sin prisa</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Prioridad del proyecto *</label>
                        <select name="priority" class="premium-input premium-select" required>
                            <option value="">Seleccionar...</option>
                            <option value="critical">Crítico - Lanzamiento inmediato</option>
                            <option value="high">Alta - Tengo fecha específica</option>
                            <option value="normal">Normal - Proceso habitual</option>
                            <option value="planning">Planificando - Explorando opciones</option>
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿Cómo medirás el éxito de tu funnel? *</label>
                    <textarea name="success_metric" class="premium-input premium-textarea"
                        placeholder="Ej: 50 leads cualificados por día, 5 ventas semanales, ROI del 300%, 1000 suscriptores en 30 días..."
                        required maxlength="250"></textarea>
                    <div class="char-counter">0 / 250</div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿Qué dispositivos usan principalmente tus clientes?</label>
                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="device_priority[]" value="mobile"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Móvil</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="device_priority[]" value="tablet"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Tablet</div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="device_priority[]" value="desktop"
                                style="margin-right: 0.5rem;">
                            <div class="option-title" style="font-size: 1rem;">Escritorio</div>
                        </label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">¿En qué idiomas necesitas el funnel?</label>
                    <div class="option-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <label class="option-card selected" style="padding: 1rem;">
                            <input type="checkbox" name="languages[]" value="spanish" style="margin-right: 0.5rem;"
                                checked disabled>
                            <div>
                                <div class="option-title" style="font-size: 1rem;">Español</div>
                                <div style="color: var(--accent-success); font-size: 12px;">Incluido</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="languages[]" value="english" style="margin-right: 0.5rem;">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">Inglés</div>
                                <div style="color: var(--accent-warning); font-size: 12px;">+$10</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="languages[]" value="portuguese" style="margin-right: 0.5rem;">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">Portugués</div>
                                <div style="color: var(--accent-warning); font-size: 12px;">+$10</div>
                            </div>
                        </label>
                        <label class="option-card" style="padding: 1rem; cursor: pointer;">
                            <input type="checkbox" name="languages[]" value="french" style="margin-right: 0.5rem;">
                            <div>
                                <div class="option-title" style="font-size: 1rem;">Francés</div>
                                <div style="color: var(--accent-warning); font-size: 12px;">+$10</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">
                        Competencia o referencias <span
                            style="color: var(--accent-success); font-size: 12px;">Opcional</span>
                    </label>
                    <textarea name="inspiration" class="premium-input premium-textarea"
                        placeholder="URLs de funnels que te gusten, competidores directos, o estilos que quieras emular..."
                        maxlength="400"></textarea>
                    <div class="char-counter">0 / 400</div>
                </div>


                <div class="input-group">
                    <label class="input-label">
                        Notas adicionales <span style="color: var(--accent-success); font-size: 12px;">Opcional</span>
                    </label>
                    <textarea name="additional_notes" class="premium-input premium-textarea"
                        placeholder="Cualquier detalle especial, funcionalidades específicas, restricciones, o información relevante que no hayamos cubierto..."
                        maxlength="600"></textarea>
                    <div class="char-counter">0 / 600</div>
                </div>
            </section>

            <section id="finalSummarySection" class="form-step glass-card fade-up hidden"
                style="padding: 2rem; margin-bottom: 3rem;">
                <div class="section-header">
                    <div class="section-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div>
                        <h2 class="section-title">Revisa tu Configuración</h2>
                        <p class="section-subtitle">Confirma que todo esté correcto antes de crear tu funnel.</p>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">

                    <div id="summaryContent" class="summary-section"
                        style="background: var(--bg-input); border-radius: 16px; padding: 1.5rem;">
                        <p style="color: var(--text-muted);">Generando resumen de tus selecciones...</p>
                    </div>

                    <div style="position: sticky; top: 2rem;">
                        <div id="costSummary" class="glass-card" style="padding: 2rem; text-align: center;">
                            <h3 style="font-size: 1.5rem; margin-bottom: 1.5rem; color: var(--text-primary);">Resumen de
                                Inversión</h3>
                            <div id="costBreakdown" class="cost-breakdown"
                                style="text-align: left; margin-bottom: 1.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 12px;">
                            </div>
                            <div id="totalCost" class="cost-display">
                            </div>
                            <p style="color: var(--text-muted); margin-top: 1rem; font-size: 12px;">
                                * Los precios son en USD. Incluye hosting por 1 año y soporte técnico por 30 días.
                            </p>
                        </div>
                    </div>
                </div>
            </section>



        </form>
    </main>


    <!-- Navigation -->
    <!-- Navigation - AHORA ESTÁ FUERA del form-container -->
    <div class="navigation">
        <div class="nav-buttons">
            <div style="display: flex; gap: 1rem;">
                <button type="button" id="prevBtn" class="btn btn-secondary" style="display: none;">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Anterior
                </button>
                <button type="button" id="saveProgressBtn" class="btn btn-secondary">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    Guardar Progreso
                </button>
                <button type="button" id="clearBtn" class="btn btn-secondary" style="color: var(--accent-tertiary);">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                    Limpiar Todo
                </button>
            </div>

            <button type="button" id="nextBtn" class="btn btn-primary">
                Siguiente
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
            </button>

            <button type="submit" id="submitBtn" class="btn btn-primary hidden"
                style="font-size: 1.2rem; padding: 20px 40px;">
                <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
                Crear Mi Funnel Premium
            </button>
        </div>
    </div>


    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4"
        style="background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(20px);">
        <div class="glass-card"
            style="max-width: 600px; padding: 3rem; text-align: center; transform: scale(0.9); transition: all 0.4s ease;">
            <div style="margin-bottom: 2rem;">
                <img src="logo-removebg-preview.png" alt="FunnelCraft Pro" class="logo-small"
                    style="margin: 0 auto; display: block;">
            </div>
            <h2 style="font-size: 2.5rem; margin-bottom: 1rem; color: var(--text-primary);">¡Proyecto Enviado
                Exitosamente!</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem; font-size: 1.1rem; line-height: 1.6;">
                Gracias por confiar en <strong>FunnelCraft Pro</strong>. Hemos recibido tu solicitud y nuestro equipo de
                expertos comenzará a trabajar en tu funnel inmediatamente.
            </p>

            <div
                style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 16px; padding: 1.5rem; margin: 2rem 0; text-align: left;">
                <h4 style="color: var(--accent-success); margin-bottom: 1rem;">Próximos pasos:</h4>
                <div style="color: var(--text-secondary); line-height: 1.8;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <div
                            style="width: 20px; height: 20px; background: var(--accent-success); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: bold;">
                            1</div>
                        <span>Te contactaremos en las próximas <strong>2 horas</strong></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <div
                            style="width: 20px; height: 20px; background: var(--accent-success); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: bold;">
                            2</div>
                        <span>Recibirás una propuesta detallada en <strong>24 horas</strong></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div
                            style="width: 20px; height: 20px; background: var(--accent-success); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: bold;">
                            3</div>
                        <span>Tu funnel estará listo según el plazo acordado</span>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="closeModal()" style="width: 100%; margin-bottom: 1rem;">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                Perfecto, entendido
            </button>
            <button class="btn btn-secondary" onclick="window.location.reload()" style="width: 100%;">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0V9a8 8 0 1115.356 2m-15.356-2L4 4" />
                </svg>
                Crear Otro Funnel
            </button>
        </div>
    </div>

    <!-- Enhanced Footer -->
    <footer class="footer"
        style="padding: 4rem 2rem 2rem; background: var(--bg-secondary); border-top: 1px solid var(--border-glass); margin-top: 8rem; position: relative; overflow: hidden;">
        <div class="footer::before"
            style="content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);">
        </div>
        <div style="max-width: 1200px; margin: 0 auto;">
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 3rem; margin-bottom: 3rem;">
                <div>
                    <div style="margin-bottom: 1.5rem;">
                        <img src="logo-removebg-preview.png" alt="FunnelCraft Pro" class="logo-small">
                    </div>
                    <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: 1.5rem;">
                        La plataforma más avanzada para crear funnels de conversión que realmente funcionan. Creamos
                        experiencias que convierten visitantes en clientes leales.
                    </p>
                    <div style="display: flex; gap: 1rem;">
                        <a href="#"
                            style="color: var(--accent-primary); text-decoration: none; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; background: rgba(99, 102, 241, 0.1); transition: all 0.3s ease;">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
                            </svg>
                        </a>
                        <a href="#"
                            style="color: var(--accent-primary); text-decoration: none; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; background: rgba(99, 102, 241, 0.1); transition: all 0.3s ease;">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z" />
                            </svg>
                        </a>
                        <a href="#"
                            style="color: var(--accent-primary); text-decoration: none; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; background: rgba(99, 102, 241, 0.1); transition: all 0.3s ease;">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
                            </svg>
                        </a>
                    </div>
                </div>
                <div>
                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Servicios</h4>
                    <div style="color: var(--text-secondary); line-height: 2;">
                        <div>Funnels de Ventas</div>
                        <div>Landing Pages</div>
                        <div>Email Marketing</div>
                        <div>WhatsApp Automation</div>
                        <div>Automatizaciones</div>
                        <div>Optimización CRO</div>
                    </div>
                </div>
                <div>
                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Funciones Premium</h4>
                    <div style="color: var(--text-secondary); line-height: 2;">
                        <div>Diseño Personalizado</div>
                        <div>Integración Multi-plataforma</div>
                        <div>Analytics Avanzados</div>
                        <div>A/B Testing</div>
                        <div>Soporte 24/7</div>
                        <div>Capacitación Incluida</div>
                    </div>
                </div>
                <div>
                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Contacto</h4>
                    <div style="color: var(--text-secondary); line-height: 2;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 8l7.89 7.89a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                            info@funnelcraft.pro
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                            </svg>
                            +506 8888-8888
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            San José, Costa Rica
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align: center; padding-top: 2rem; border-top: 1px solid var(--border-glass);">
                <p style="color: var(--text-muted); margin-bottom: 1rem;">
                    © 2024 FunnelCraft Pro. Transformando visitantes en clientes desde Costa Rica para el mundo.
                </p>
                <p style="color: var(--text-muted); font-size: 12px;">
                    Todos los derechos reservados. Términos de Servicio | Política de Privacidad | Soporte 24/7
                </p>
            </div>
        </div>
    </footer>
    <script>
       document.addEventListener('DOMContentLoaded', () => {

    // --- DOM ELEMENT SELECTION ---
    const form = document.getElementById('funnelForm');
    const steps = Array.from(form.querySelectorAll(':scope > section, :scope > div#costSummary'));
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const submitBtn = document.getElementById('submitBtn');
    const progressFill = document.getElementById('progressFill');
    const stepDots = document.querySelectorAll('.step-dot');
    const heroHeader = document.querySelector('.hero-header');
    const formContainer = document.querySelector('.form-container');
    const navigationContainer = document.querySelector('.navigation');
    const totalCostDisplay = document.getElementById('totalCost');
    const costBreakdownContainer = document.getElementById('costBreakdown');
    const successModal = document.getElementById('successModal');
    const clearBtn = document.getElementById('clearBtn');
    const saveProgressBtn = document.getElementById('saveProgressBtn');

    // --- STATE MANAGEMENT ---
    let currentStep = 0;
    const TOTAL_STEPS = steps.length;
    const BASE_COST = 299;
    
    // --- NUEVAS VARIABLES PARA EDICIÓN DESDE RESUMEN ---
    let isEditingFromSummary = false;
    let summaryStep = TOTAL_STEPS - 1;

    const costs = {
        followup: 0,
        additionalEmails: 0,
        extraDataFields: 0,
        extraModules: 0,
        domain: 0,
        languages: 0,
        total: BASE_COST
    };

    // --- NUEVA FUNCIÓN PARA EDICIÓN DESDE RESUMEN ---
    function editStepFromSummary(stepIndex) {
        isEditingFromSummary = true;
        showStep(stepIndex);
        
        // Cambiar el texto del botón "Siguiente" para indicar que se volverá al resumen
        if (nextBtn) {
            nextBtn.innerHTML = `
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
                Volver al Resumen
            `;
        }
    }
    window.editStepFromSummary = editStepFromSummary;

    // Event handlers registry for cleaner code
    const eventHandlers = {
        startBuilding: () => {
            heroHeader.style.display = 'none';
            formContainer.style.display = 'block';
            navigationContainer.style.display = 'block'; // <-- ESTA LÍNEA SE ENCARGA DE MOSTRAR LA NAVEGACIÓN
            showStep(0);
        },

        showInfo: () => {
            alert('FunnelCraft Pro es la plataforma más avanzada para crear funnels de conversión que realmente funcionan. Transformamos visitantes en clientes con inteligencia artificial y estrategias probadas.');
        },

        toggleModuleOptions: function (moduleId, isChecked) {
            const optionsContainer = document.getElementById(`${moduleId}Options`);
            if (optionsContainer) {
                if (isChecked) {
                    optionsContainer.classList.add('visible');
                    optionsContainer.style.display = 'block';
                } else {
                    optionsContainer.classList.remove('visible');
                    optionsContainer.style.display = 'none';
                }
            }
            updateAllCosts();
        },

        addTestimonial: () => {
            const container = document.getElementById('testimonialsContainer');
            createDynamicItem(container, dynamicItemTemplates.testimonial);
        },

        addSocialMedia: () => {
            const container = document.getElementById('socialMediaContainer');
            createDynamicItem(container, dynamicItemTemplates.socialMedia);
        },

        addFaq: () => {
            const container = document.getElementById('faqContainer');
            createDynamicItem(container, dynamicItemTemplates.faq);
        },

        addPricingPlan: () => {
            const container = document.getElementById('pricingPlansContainer');
            createDynamicItem(container, dynamicItemTemplates.pricingPlan);
        },

        addSocialProof: () => {
            const container = document.getElementById('socialProofContainer');
            createDynamicItem(container, dynamicItemTemplates.socialProof);
        },

        addBonus: () => {
            const container = document.getElementById('bonusContainer');
            createDynamicItem(container, dynamicItemTemplates.bonus);
        },

        removeDynamicItem: function (button) {
            const item = button.closest('.dynamic-item');
            if (item) {
                item.style.animation = 'fadeOut 0.5s ease forwards';
                setTimeout(() => {
                    if (item.parentNode) {
                        item.parentNode.removeChild(item);
                    }
                }, 500);
            }
        },

        closeModal: function () {
            if (successModal) {
                const modalCard = successModal.querySelector('.glass-card');
                if (modalCard) {
                    modalCard.style.transform = 'scale(0.9)';
                }
                setTimeout(() => {
                    successModal.classList.add('hidden');
                    successModal.classList.remove('flex');
                }, 400);
            }
        }
    };

    // Expose handlers to global scope for onclick compatibility (temporary solution)
    Object.keys(eventHandlers).forEach(key => {
        window[key] = eventHandlers[key];
    });

    // --- INITIALIZATION ---
    function initializeForm() {
        showStep(0);
        updateProgress();
        setupEventListeners();
        updateAllCosts();
        loadProgress();
    }

    // --- NAVIGATION LOGIC ---
    function showStep(stepIndex) {
        steps.forEach((step, index) => {
    if (index === stepIndex) {
        step.classList.remove('hidden');
        step.classList.remove('fade-up');
        void step.offsetWidth; // Force reflow
        step.classList.add('fade-up');
    } else {
        step.classList.add('hidden');
    }
});
currentStep = stepIndex;
updateNavigationButtons();
updateProgress();
window.scrollTo({
    top: 0,
    behavior: 'smooth'
});
    }
    window.showStep = showStep;

    // --- FUNCIÓN nextStep MEJORADA ---
    function nextStep() {
        if (validateCurrentStep()) {
            // Si estamos editando desde el resumen, volver directamente al resumen
            if (isEditingFromSummary) {
                generateSummary();
                updateAllCosts();
                showStep(summaryStep);
                isEditingFromSummary = false; // Reset del estado de edición
                resetNavigationButtonText(); // Restaurar texto original del botón
                return;
            }

            // Lógica normal para navegación secuencial
            if (currentStep === TOTAL_STEPS - 2) {
                generateSummary();
                updateAllCosts();
            }
            if (currentStep < TOTAL_STEPS - 1) {
                showStep(currentStep + 1);
            }
        }
    }

    // --- FUNCIÓN prevStep MEJORADA ---
    function prevStep() {
        if (currentStep > 0) {
            // Si estamos editando desde el resumen, también volver al resumen al hacer "Anterior"
            if (isEditingFromSummary) {
                generateSummary();
                updateAllCosts();
                showStep(summaryStep);
                isEditingFromSummary = false;
                resetNavigationButtonText();
                return;
            }
            showStep(currentStep - 1);
        }
    }

    // --- NUEVA FUNCIÓN PARA RESETEAR TEXTO DE NAVEGACIÓN ---
    function resetNavigationButtonText() {
        if (nextBtn) {
            nextBtn.innerHTML = `
                Siguiente
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
            `;
        }
        if (prevBtn) {
            prevBtn.innerHTML = `
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                Anterior
            `;
        }
    }

    // --- FUNCIÓN updateNavigationButtons MEJORADA ---
    function updateNavigationButtons() {
        // Si estamos editando desde el resumen, siempre mostrar ambos botones
        if (isEditingFromSummary) {
            prevBtn.style.display = 'inline-flex';
            nextBtn.classList.remove('hidden');
            submitBtn.classList.add('hidden');
            
            // Actualizar el texto del botón anterior también
            if (prevBtn) {
                prevBtn.innerHTML = `
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Volver al Resumen
                `;
            }
            return;
        }

        // Lógica normal de navegación
        prevBtn.style.display = currentStep > 0 ? 'inline-flex' : 'none';

        if (currentStep === TOTAL_STEPS - 1) {
            nextBtn.classList.add('hidden');
            submitBtn.classList.remove('hidden');
        } else {
            nextBtn.classList.remove('hidden');
            submitBtn.classList.add('hidden');
            resetNavigationButtonText();
        }
    }

    function updateProgress() {
        const progressPercentage = (currentStep / (TOTAL_STEPS - 1)) * 100;
        progressFill.style.width = `${progressPercentage}%`;

        stepDots.forEach((dot, index) => {
            dot.classList.remove('active', 'completed');
            if (index < currentStep) {
                dot.classList.add('completed');
            } else if (index === currentStep) {
                dot.classList.add('active');
            }
        });
    }

    // --- VALIDATION LOGIC (IMPROVED) ---
    function validateCurrentStep() {
        const currentSection = steps[currentStep];
        const inputs = currentSection.querySelectorAll('input[required], select[required], textarea[required]');
        let isValid = true;
        const errors = [];
        const processedGroups = new Set(); // Para evitar errores duplicados en grupos

        inputs.forEach(input => {
            // Skip validation for hidden module options
            const optionalContainer = input.closest('.module-options-container');
            if (optionalContainer && !optionalContainer.classList.contains('visible')) {
                return;
            }

            // Skip validation for hidden elements
            if (input.offsetParent === null) {
                return;
            }

            let fieldIsValid = true;
            let errorKey = input.name; // Para identificar campos únicos

            if (input.type === 'radio') {
                const groupName = input.name;
                errorKey = groupName; // Los radios se agrupan por name

                // Solo validar una vez por grupo
                if (processedGroups.has(errorKey)) {
                    return;
                }
                processedGroups.add(errorKey);

                const checkedRadio = form.querySelector(`input[name="${groupName}"]:checked`);
                if (!checkedRadio) {
                    fieldIsValid = false;
                    // Highlight all radio options in the group
                    form.querySelectorAll(`input[name="${groupName}"]`).forEach(radio => {
                        const optionCard = radio.closest('.option-card');
                        if (optionCard) {
                            optionCard.style.borderColor = 'var(--accent-tertiary)';
                            optionCard.style.boxShadow = '0 0 0 1px var(--accent-tertiary)';
                        }
                    });
                }
            } else if (input.type === 'checkbox') {
                const groupName = input.name;

                if (groupName.includes('[]')) {
                    // Para grupos de checkboxes (como arrays)
                    errorKey = groupName;
                    if (processedGroups.has(errorKey)) {
                        return;
                    }
                    processedGroups.add(errorKey);

                    const checkedCheckboxes = form.querySelectorAll(`input[name="${groupName}"]:checked`);
                    if (checkedCheckboxes.length === 0) {
                        fieldIsValid = false;
                        // Highlight all checkbox options in the group
                        form.querySelectorAll(`input[name="${groupName}"]`).forEach(checkbox => {
                            const optionCard = checkbox.closest('.option-card');
                            if (optionCard) {
                                optionCard.style.borderColor = 'var(--accent-tertiary)';
                                optionCard.style.boxShadow = '0 0 0 1px var(--accent-tertiary)';
                            }
                        });
                    }
                } else {
                    // Para checkboxes individuales
                    fieldIsValid = input.checked;
                    if (!fieldIsValid) {
                        const optionCard = input.closest('.option-card');
                        if (optionCard) {
                            optionCard.style.borderColor = 'var(--accent-tertiary)';
                            optionCard.style.boxShadow = '0 0 0 1px var(--accent-tertiary)';
                        }
                    }
                }
            } else {
                fieldIsValid = input.value.trim() !== '';
                if (!fieldIsValid) {
                    input.classList.add('error');
                }
            }

            if (!fieldIsValid) {
                isValid = false;

                // Get field label for error message, avoiding duplicates
                if (!processedGroups.has(errorKey)) {
                    const label = input.closest('.input-group')?.querySelector('label')?.textContent ||
                        input.closest('.option-card')?.querySelector('span')?.textContent ||
                        input.name;
                    errors.push(label.replace('*', '').trim());
                    processedGroups.add(errorKey);
                }
            } else {
                // Clear error styling if field is now valid
                input.classList.remove('error');
                const optionCard = input.closest('.option-card');
                if (optionCard) {
                    optionCard.style.borderColor = '';
                    optionCard.style.boxShadow = '';
                }
            }
        });

        if (!isValid) {
            const errorMessage = errors.length > 0
                ? `Por favor, completa los siguientes campos:\n• ${errors.join('\n• ')}`
                : 'Por favor, completa todos los campos obligatorios (*) antes de continuar.';
            alert(errorMessage);
        }

        return isValid;
    }

    // --- DYNAMIC CONTENT & UI ---
    function createDynamicItem(container, templateFunction) {
        if (!container) return;
        const itemIndex = container.children.length + 1;
        const newItem = document.createElement('div');
        newItem.className = 'dynamic-item fade-up';
        newItem.innerHTML = templateFunction(itemIndex);
        container.appendChild(newItem);
        setupEventListenersForItem(newItem);
    }
    // --- DYNAMIC CONTENT & UI ---

    function generateSummary() {
        const summaryContainer = document.getElementById('summaryContent');
        const formData = new FormData(form);
        let summaryHTML = '';

        // Mapeo de nombres de campos a etiquetas amigables y el paso donde se editan
        const fieldMappings = {
            'client_name': { label: 'Nombre Completo', step: 0 },
            'client_email': { label: 'Email', step: 0 },
            'client_phone': { label: 'WhatsApp', step: 0 },
            'business_type': { label: 'Tipo de Negocio', step: 1 },
            'main_product': { label: 'Producto Principal', step: 1 },
            'funnel_destination': { label: 'Objetivo del Funnel', step: 2 },
            'traffic_source': { label: 'Fuente de Tráfico', step: 2 },
            'target_audience': { label: 'Cliente Ideal', step: 2 },
            'followup_method': { label: 'Sistema de Seguimiento', step: 3 },
            'hero_title': { label: 'Título Principal', step: 4 },
            'cta_text': { label: 'Botón Principal (CTA)', step: 4 },
            'domain_option': { label: 'Opción de Dominio', step: 6 },
            'design_style': { label: 'Estilo de Diseño', step: 7 },
            'timeframe': { label: 'Tiempo de Entrega', step: 8 }
        };

        for (const [key, value] of formData.entries()) {
            if (fieldMappings[key] && value) {
                const { label, step } = fieldMappings[key];
                summaryHTML += `
        <div class="summary-item">
            <div class="summary-title">
                <span>${label}</span>
                <button type="button" class="edit-btn" onclick="editStepFromSummary(${step})">
                    Editar 
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536L16.732 3.732z"></path></svg>
                </button>
            </div>
            <div class="summary-content">${value.toString().replace(/\n/g, '<br>')}</div>
        </div>
    `;
            }
        }

        // Resumen de Módulos Extras
        const extraModules = formData.getAll('extra_modules[]');
        if (extraModules.length > 0) {
            summaryHTML += `
    <div class="summary-item">
        <div class="summary-title">
            <span>Módulos Extras</span>
            <button type="button" class="edit-btn" onclick="editStepFromSummary(5)">Editar</button>
        </div>
        <div class="summary-content">${extraModules.join(', ')}</div>
    </div>
`;
        }

        summaryContainer.innerHTML = summaryHTML || '<p>No has seleccionado ninguna opción aún.</p>';
    }

    // Dynamic item templates
    const dynamicItemTemplates = {
        testimonial: (i) => `
    <div class="item-header">
        <h5>Testimonio ${i}</h5>
        <button type="button" class="remove-btn" onclick="removeDynamicItem(this)">×</button>
    </div>
    <div class="input-group">
        <label class="input-label">Nombre del cliente</label>
        <input type="text" name="testimonial_author[]" class="premium-input" placeholder="Juan Pérez">
    </div>
    <div class="input-group">
        <label class="input-label">Cargo o empresa</label>
        <input type="text" name="testimonial_role[]" class="premium-input" placeholder="CEO, Empresa XYZ">
    </div>
    <div class="input-group">
        <label class="input-label">Testimonio</label>
        <textarea name="testimonial_content[]" class="premium-input premium-textarea" placeholder="Excelente servicio, recomendado al 100%..."></textarea>
    </div>
`,
        socialMedia: (i) => `
    <div class="item-header">
        <h5>Red Social ${i}</h5>
        <button type="button" class="remove-btn" onclick="removeDynamicItem(this)">×</button>
    </div>
    <div class="input-group">
        <label class="input-label">Plataforma</label>
        <select name="social_platform[]" class="premium-input">
            <option value="">Selecciona...</option>
            <option value="facebook">Facebook</option>
            <option value="instagram">Instagram</option>
            <option value="twitter">Twitter</option>
            <option value="linkedin">LinkedIn</option>
            <option value="youtube">YouTube</option>
            <option value="tiktok">TikTok</option>
        </select>
    </div>
    <div class="input-group">
        <label class="input-label">URL</label>
        <input type="url" name="social_url[]" class="premium-input" placeholder="https://facebook.com/tunegocio">
    </div>
`,
        faq: (i) => `
    <div class="item-header">
        <h5>Pregunta ${i}</h5>
        <button type="button" class="remove-btn" onclick="removeDynamicItem(this)">×</button>
    </div>
    <div class="input-group">
        <label class="input-label">Pregunta</label>
        <input type="text" name="faq_question[]" class="premium-input" placeholder="¿Cuál es el tiempo de entrega?">
    </div>
    <div class="input-group">
        <label class="input-label">Respuesta</label>
        <textarea name="faq_answer[]" class="premium-input premium-textarea" placeholder="El tiempo de entrega es de 3 a 5 días hábiles..."></textarea>
    </div>
`,
        pricingPlan: (i) => `
    <div class="item-header">
        <h5>Plan ${i}</h5>
        <button type="button" class="remove-btn" onclick="removeDynamicItem(this)">×</button>
    </div>
    <div class="input-group">
        <label class="input-label">Nombre del plan</label>
        <input type="text" name="pricing_plan_name[]" class="premium-input" placeholder="Plan Básico">
    </div>
    <div class="input-group">
        <label class="input-label">Precio</label>
        <input type="number" name="pricing_plan_price[]" class="premium-input" placeholder="29">
    </div>
    <div class="input-group">
        <label class="input-label">Características</label>
        <textarea name="pricing_plan_features[]" class="premium-input premium-textarea" placeholder="Característica 1&#10;Característica 2"></textarea>
    </div>
`,
        socialProof: (i) => `
    <div class="item-header">
        <h5>Contador ${i}</h5>
        <button type="button" class="remove-btn" onclick="removeDynamicItem(this)">×</button>
    </div>
    <div class="input-group">
        <label class="input-label">Tipo de contador</label>
        <select name="social_proof_type[]" class="premium-input">
            <option value="clients">Clientes satisfechos</option>
            <option value="projects">Proyectos completados</option>
            <option value="downloads">Descargas</option>
            <option value="users">Usuarios activos</option>
        </select>
    </div>
    <div class="input-group">
        <label class="input-label">Valor inicial</label>
        <input type="number" name="social_proof_value[]" class="premium-input" placeholder="1000">
    </div>
`,
        bonus: (i) => `
    <div class="item-header">
        <h5>Bono ${i}</h5>
        <button type="button" class="remove-btn" onclick="removeDynamicItem(this)">×</button>
    </div>
    <div class="input-group">
        <label class="input-label">Nombre del bono</label>
        <input type="text" name="bonus_name[]" class="premium-input" placeholder="Guía avanzada">
    </div>
    <div class="input-group">
        <label class="input-label">Valor percibido</label>
        <input type="text" name="bonus_value[]" class="premium-input" placeholder="$97 USD">
    </div>
    <div class="input-group">
        <label class="input-label">Descripción del bono</label>
        <textarea name="bonus_description[]" class="premium-input premium-textarea" placeholder="Incluye técnicas avanzadas..."></textarea>
    </div>
`
    };

    // --- COST CALCULATION ---
    function updateAllCosts() {
        const formData = new FormData(form);

        // Calculate followup costs
        const followupMethod = formData.get('followup_method');
        costs.followup = (followupMethod === 'whatsapp' || followupMethod === 'both') ? 30 : 0;

        // Calculate additional emails cost
        const additionalEmails = formData.get('additional_emails');
        if (additionalEmails && additionalEmails !== 'none' && additionalEmails !== 'custom') {
            costs.additionalEmails = parseInt(additionalEmails) * 3;
        } else {
            costs.additionalEmails = 0;
        }

        // Calculate extra data fields cost
        const dataFields = formData.getAll('user_data_fields[]');
        const dataFieldsCount = dataFields.filter(field => field !== 'email').length + 1; // +1 for email which is always included
        const extraDataFields = Math.max(0, dataFieldsCount - 4);
        costs.extraDataFields = extraDataFields * 5;

        // Update data fields warning
        updateDataFieldsWarning(extraDataFields);

        // Calculate extra modules cost
        const extraModules = formData.getAll('extra_modules[]');
        const extraModulesCount = Math.max(0, extraModules.length - 4);
        costs.extraModules = extraModulesCount * 15;

        // Calculate domain cost
        costs.domain = formData.get('domain_option') === 'custom' ? 25 : 0;

        // Calculate languages cost
        const languages = formData.getAll('languages[]');
        const extraLanguages = Math.max(0, languages.length - 1); // -1 because Spanish is included
        costs.languages = extraLanguages * 10;

        // Calculate total
        costs.total = BASE_COST + costs.followup + costs.additionalEmails + costs.extraDataFields + costs.extraModules + costs.domain + costs.languages;

        updateCostSummary();
        updateHiddenFields();
    }

    function updateDataFieldsWarning(extraFields) {
        const warning = document.getElementById('dataFieldsCostWarning');
        const text = document.getElementById('dataFieldsCostText');

        if (warning && text) {
            if (extraFields > 0) {
                text.innerHTML = `Has seleccionado <strong>${extraFields} campo(s) adicional(es)</strong>. Costo extra: <strong>$${(extraFields * 5).toFixed(2)} USD</strong>.`;
                warning.classList.remove('hidden');
            } else {
                warning.classList.add('hidden');
            }
        }
    }

    function updateCostSummary() {
        if (totalCostDisplay) {
            totalCostDisplay.innerHTML = `Inversión Total: <strong>$${costs.total.toFixed(2)} USD</strong>`;
        }

        if (costBreakdownContainer) {
            let breakdownHTML = `<p><strong>Precio Base:</strong> $${BASE_COST.toFixed(2)} USD</p>`;

            if (costs.followup > 0) {
                breakdownHTML += `<p><strong>Seguimiento WhatsApp:</strong> +$${costs.followup.toFixed(2)} USD</p>`;
            }
            if (costs.additionalEmails > 0) {
                breakdownHTML += `<p><strong>Emails Adicionales:</strong> +$${costs.additionalEmails.toFixed(2)} USD</p>`;
            }
            if (costs.extraDataFields > 0) {
                breakdownHTML += `<p><strong style="color:var(--accent-tertiary);">Campos Extras:</strong> +$${costs.extraDataFields.toFixed(2)} USD</p>`;
            }
            if (costs.extraModules > 0) {
                breakdownHTML += `<p><strong style="color:var(--accent-tertiary);">Módulos Extras:</strong> +$${costs.extraModules.toFixed(2)} USD</p>`;
            }
            if (costs.domain > 0) {
                breakdownHTML += `<p><strong>Dominio Personalizado:</strong> +$${costs.domain.toFixed(2)} USD</p>`;
            }
            if (costs.languages > 0) {
                breakdownHTML += `<p><strong>Idiomas Adicionales:</strong> +$${costs.languages.toFixed(2)} USD</p>`;
            }

            costBreakdownContainer.innerHTML = breakdownHTML;
        }
    }

    function updateHiddenFields() {
        // Update hidden form fields with current costs
        const fields = {
            'totalCostInput': costs.total,
            'extraDataFieldsCountHidden': Math.max(0, new FormData(form).getAll('user_data_fields[]').length - 4),
            'extraDataFieldsCostHidden': costs.extraDataFields,
            'extraModulesCountHidden': Math.max(0, new FormData(form).getAll('extra_modules[]').length - 4),
            'extraModulesCostHidden': costs.extraModules,
            'followupCostHidden': costs.followup,
            'emailSequenceCostHidden': costs.additionalEmails,
            'domainCostHidden': costs.domain,
            'languageCostHidden': costs.languages
        };

        Object.entries(fields).forEach(([id, value]) => {
            const field = document.getElementById(id);
            if (field) field.value = value;
        });
    }

    // --- EVENT LISTENERS ---
    function setupEventListeners() {
        // Navigation buttons
        if (nextBtn) nextBtn.addEventListener('click', nextStep);
        if (prevBtn) prevBtn.addEventListener('click', prevStep);
        if (clearBtn) clearBtn.addEventListener('click', clearForm);
        if (saveProgressBtn) {
            saveProgressBtn.addEventListener('click', () => {
                saveProgress();
                alert('¡Progreso guardado exitosamente!');
            });
        }

        // Step dots navigation - MEJORADO PARA EDICIÓN
        stepDots.forEach(dot => {
            dot.addEventListener('click', (e) => {
                const stepToGo = parseInt(e.target.dataset.step);
                if (stepToGo <= currentStep) {
                    // Si estamos editando desde el resumen, cancelar el modo edición
                    if (isEditingFromSummary) {
                        isEditingFromSummary = false;
                        resetNavigationButtonText();
                    }
                    showStep(stepToGo);
                }
            });
        });

        // Form change listeners
        form.addEventListener('change', handleFormChange);
        form.addEventListener('input', handleFormInput);

        // Character counters for textareas
        setupCharacterCounters();

        // Module checkboxes
        setupModuleToggles();

        // Form submission
        form.addEventListener('submit', handleFormSubmit);
    }

    function handleFormChange(e) {
        const target = e.target;

        // Update costs on any change
        updateAllCosts();

        // Handle followup method changes
        if (target.name === 'followup_method') {
            const val = target.value;
            toggleElement('emailFollowupOptions', val === 'email' || val === 'both');
            toggleElement('whatsappFollowupOptions', val === 'whatsapp' || val === 'both');
        }

        // Handle additional emails selection
        if (target.name === 'additional_emails') {
            toggleElement('emailScheduleOptions', target.value !== 'none');
            toggleElement('emailSequenceBuilder', target.value !== 'none' && target.value !== 'custom');
        }

        // Handle domain option changes
        if (target.name === 'domain_option') {
            toggleElement('customDomainOptions', target.value === 'custom');
        }

        // Handle color picker synchronization
        if (target.type === 'color') {
            const hexInput = target.nextElementSibling;
            if (hexInput && hexInput.name.includes('_hex')) {
                hexInput.value = target.value;
            }
        }

        if (target.name && target.name.includes('_color_hex')) {
            const colorInput = target.previousElementSibling;
            if (colorInput && colorInput.type === 'color') {
                colorInput.value = target.value;
            }
        }

        // Handle option card selection styling
        if (target.type === 'radio' || target.type === 'checkbox') {
            updateOptionCardStyling(target);
        }

        // Clear validation errors when user makes changes
        clearValidationErrors(target);
    }

    function handleFormInput(e) {
        const target = e.target;

        // Handle character counters
        if (target.tagName === 'TEXTAREA' && target.hasAttribute('maxlength')) {
            updateCharacterCounter(target);
        }

        // Clear validation errors on input
        clearValidationErrors(target);
    }

    function clearValidationErrors(input) {
        input.classList.remove('error');
        const optionCard = input.closest('.option-card');
        if (optionCard) {
            optionCard.style.borderColor = '';
            optionCard.style.boxShadow = '';
        }
    }

    function toggleElement(elementId, show) {
        const element = document.getElementById(elementId);
        if (element) {
            if (show) {
                element.classList.remove('hidden');
            } else {
                element.classList.add('hidden');
            }
        }
    }

    function updateOptionCardStyling(input) {
        const groupName = input.name;
        const allInputsInGroup = form.querySelectorAll(`input[name="${groupName}"]`);

        allInputsInGroup.forEach(groupInput => {
            const card = groupInput.closest('.option-card');
            if (card) {
                if (input.type === 'radio') {
                    card.classList.toggle('selected', groupInput.checked);
                } else if (input.type === 'checkbox') {
                    card.classList.toggle('selected', groupInput.checked);
                }
            }
        });
    }

    function setupCharacterCounters() {
        document.querySelectorAll('textarea[maxlength]').forEach(textarea => {
            const counter = textarea.nextElementSibling;
            if (counter && counter.classList.contains('char-counter')) {
                textarea.addEventListener('input', () => updateCharacterCounter(textarea));
                // Initialize counter
                updateCharacterCounter(textarea);
            }
        });
    }

    function updateCharacterCounter(textarea) {
        const counter = textarea.nextElementSibling;
        if (counter && counter.classList.contains('char-counter')) {
            const current = textarea.value.length;
            const max = textarea.getAttribute('maxlength');
            counter.textContent = `${current} / ${max}`;

            // Add warning color if near limit
            if (current > max * 0.9) {
                counter.style.color = 'var(--accent-tertiary)';
            } else {
                counter.style.color = 'var(--text-muted)';
            }
        }
    }

    function setupModuleToggles() {
        document.querySelectorAll('input[name="extra_modules[]"]').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const value = e.target.value;
                const moduleMap = {
                    'testimonials': 'testimonials',
                    'social_media': 'socialMedia',
                    'faq': 'faq',
                    'countdown': 'countdown',
                    'pricing': 'pricing',
                    'video': 'video',
                    'Pop_Up': 'liveChat',
                    'social_proof': 'socialProof',
                    'bonus_stack': 'bonusStack',
                    'calculator': 'calculator',
                    'calendar': 'calendar',
                    'gallery': 'gallery'
                };

                const moduleId = moduleMap[value];
                if (moduleId) {
                    eventHandlers.toggleModuleOptions(moduleId, e.target.checked);
                }
            });
        });
    }

    function setupEventListenersForItem(item) {
        // Setup character counters for new items
        item.querySelectorAll('textarea[maxlength]').forEach(textarea => {
            const counter = textarea.nextElementSibling;
            if (counter && counter.classList.contains('char-counter')) {
                textarea.addEventListener('input', () => updateCharacterCounter(textarea));
                updateCharacterCounter(textarea);
            }
        });
    }

    // --- FORM SUBMISSION ---
    async function handleFormSubmit(event) {
        event.preventDefault();

        if (!validateCurrentStep()) {
            return;
        }

        // Set completion timestamp
        const completedAtField = document.getElementById('formCompletedAt');
        if (completedAtField) {
            completedAtField.value = new Date().toISOString();
        }

        // Update all hidden fields
        updateHiddenFields();

        // Show loading state
        const originalText = submitBtn.innerHTML;
        submitBtn.classList.add('loading');
        submitBtn.disabled = true;
        submitBtn.innerHTML = `
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="animation: spin 1s linear infinite;">
                <circle cx="12" cy="12" r="10" stroke-width="2"/>
                <path d="M12 2a10 10 0 0 1 10 10" stroke-width="2"/>
            </svg>
            Enviando...
        `;

        try {
            const formData = new FormData(form);
            const response = await fetch(form.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            });

            if (response.ok) {
                showSuccessModal();
                // Clear saved progress
                localStorage.removeItem('funnelCraftProgress');
                // Reset form after successful submission
                setTimeout(() => {
                    resetFormState();
                }, 2000);
            } else {
                throw new Error(`Error del servidor: ${response.status}`);
            }
        } catch (error) {
            console.error('Error submitting form:', error);
            alert('Error al enviar el formulario: ' + error.message + '\n\nPor favor, intenta nuevamente o contacta al soporte.');
        } finally {
            // Restore button state
            submitBtn.classList.remove('loading');
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;
        }
    }

    function showSuccessModal() {
        if (successModal) {
            successModal.classList.remove('hidden');
            successModal.classList.add('flex');
            const modalCard = successModal.querySelector('.glass-card');
            if (modalCard) {
                setTimeout(() => {
                    modalCard.style.transform = 'scale(1)';
                }, 50);
            }
        }
    }

    // --- FORM RESET LOGIC (MEJORADO) ---
    function resetFormState() {
        // Reset form data
        form.reset();

        // Reset costs
        Object.keys(costs).forEach(key => {
            costs[key] = key === 'total' ? BASE_COST : 0;
        });

        // Reset estado de edición
        isEditingFromSummary = false;

        // Reset to first step
        showStep(0);

        // Trigger change events to update UI automatically
        form.dispatchEvent(new Event('change', { bubbles: true }));
        updateAllCosts();
        resetNavigationButtonText();
    }

    // --- PERSISTENCE (SAVE/LOAD) ---
    function saveProgress() {
        try {
            const formData = new FormData(form);
            const dataToSave = {};

            // Convert FormData to regular object, handling multiple values
            formData.forEach((value, key) => {
                if (dataToSave.hasOwnProperty(key)) {
                    // Convert to array if multiple values exist
                    if (!Array.isArray(dataToSave[key])) {
                        dataToSave[key] = [dataToSave[key]];
                    }
                    dataToSave[key].push(value);
                } else {
                    dataToSave[key] = value;
                }
            });

            // Save current step and costs
            dataToSave._currentStep = currentStep;
            dataToSave._costs = costs;

            localStorage.setItem('funnelCraftProgress', JSON.stringify(dataToSave));
        } catch (error) {
            console.error('Error saving progress:', error);
            alert('Error al guardar el progreso. Intenta nuevamente.');
        }
    }

    function loadProgress() {
        try {
            const savedData = localStorage.getItem('funnelCraftProgress');
            if (!savedData) return;

            const data = JSON.parse(savedData);
            let hasData = false;

            // Restore form data
            for (let key in data) {
                if (key.startsWith('_')) continue; // Skip internal data

                const elements = form.querySelectorAll(`[name="${key}"]`);
                if (!elements.length) continue;

                hasData = true;
                const values = Array.isArray(data[key]) ? data[key] : [data[key]];

                if (elements[0].type === 'radio' || elements[0].type === 'checkbox') {
                    elements.forEach(input => {
                        if (values.includes(input.value)) {
                            input.checked = true;
                            input.dispatchEvent(new Event('change', { bubbles: true }));
                        }
                    });
                } else {
                    elements[0].value = data[key];
                    elements[0].dispatchEvent(new Event('input', { bubbles: true }));
                }
            }

            // Restore costs if available
            if (data._costs) {
                Object.assign(costs, data._costs);
            }

            // Restore current step if available
            if (typeof data._currentStep === 'number' && data._currentStep >= 0) {
                currentStep = Math.min(data._currentStep, TOTAL_STEPS - 1);
            }

            // Update UI
            updateAllCosts();
            showStep(currentStep);

            if (hasData) {
                alert('¡Progreso anterior cargado exitosamente!');
            }
        } catch (error) {
            console.error('Error loading progress:', error);
            localStorage.removeItem('funnelCraftProgress');
        }
    }

    // --- CLEAR FORM (MEJORADO) ---
    function clearForm() {
        if (confirm('¿Estás seguro de que quieres limpiar todo el formulario?\n\nEsto eliminará todo el progreso guardado y no se puede deshacer.')) {
            try {
                // Clear localStorage first
                localStorage.removeItem('funnelCraftProgress');

                // Reset form and trigger automatic UI updates
                resetFormState();

                // Additional cleanup for dynamic containers
                const containersToReset = [
                    'testimonialsContainer',
                    'socialMediaContainer',
                    'faqContainer',
                    'pricingPlansContainer',
                    'socialProofContainer',
                    'bonusContainer'
                ];

                containersToReset.forEach(containerId => {
                    const container = document.getElementById(containerId);
                    if (container) {
                        // Remove all but first child
                        while (container.children.length > 1) {
                            container.removeChild(container.lastChild);
                        }
                        // Reset first child if exists
                        const firstItem = container.firstElementChild;
                        if (firstItem) {
                            firstItem.querySelectorAll('input, select, textarea').forEach(field => {
                                if (field.type === 'checkbox' || field.type === 'radio') {
                                    field.checked = false;
                                } else {
                                    field.value = '';
                                }
                                field.dispatchEvent(new Event('change', { bubbles: true }));
                            });
                        }
                    }
                });

                alert('Formulario limpiado exitosamente.');
            } catch (error) {
                console.error('Error clearing form:', error);
                alert('Error al limpiar el formulario. Recarga la página para empezar desde cero.');
            }
        }
    }

    // --- UTILITY FUNCTIONS ---
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // Debounced cost update to improve performance
    const debouncedUpdateCosts = debounce(updateAllCosts, 300);

    // --- ERROR HANDLING ---
    window.addEventListener('error', (event) => {
        console.error('JavaScript error:', event.error);
        // Don't show alerts for minor errors, just log them
    });

    window.addEventListener('unhandledrejection', (event) => {
        console.error('Unhandled promise rejection:', event.reason);
        event.preventDefault(); // Prevent the default browser handling
    });

    // --- ACCESSIBILITY IMPROVEMENTS (MEJORADO) ---
    function improveAccessibility() {
        // Add ARIA labels to step dots
        stepDots.forEach((dot, index) => {
            dot.setAttribute('aria-label', `Paso ${index + 1}`);
            dot.setAttribute('role', 'button');
            dot.setAttribute('tabindex', '0');

            // Add keyboard support for step dots
            dot.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    const stepToGo = parseInt(e.target.dataset.step);
                    if (stepToGo <= currentStep) {
                        // Cancelar modo edición si está activo
                        if (isEditingFromSummary) {
                            isEditingFromSummary = false;
                            resetNavigationButtonText();
                        }
                        showStep(stepToGo);
                    }
                }
            });
        });

        // Improve form field accessibility
        form.querySelectorAll('input, select, textarea').forEach(field => {
            const label = field.closest('.input-group')?.querySelector('label');
            if (label && !field.getAttribute('aria-labelledby') && !field.getAttribute('aria-label')) {
                const labelId = `label-${Math.random().toString(36).substr(2, 9)}`;
                label.id = labelId;
                field.setAttribute('aria-labelledby', labelId);
            }
        });
    }

    // --- PERFORMANCE OPTIMIZATIONS ---
    function optimizePerformance() {
        // Use requestAnimationFrame for smooth animations
        const smoothScroll = (element) => {
            const start = window.pageYOffset;
            const target = element.offsetTop;
            const distance = target - start;
            const duration = 500;
            let startTime = null;

            const animation = (currentTime) => {
                if (startTime === null) startTime = currentTime;
                const timeElapsed = currentTime - startTime;
                const progress = Math.min(timeElapsed / duration, 1);

                const ease = progress * (2 - progress); // easeOutQuad
                window.scrollTo(0, start + distance * ease);

                if (timeElapsed < duration) {
                    requestAnimationFrame(animation);
                }
            };

            requestAnimationFrame(animation);
        };

        // Replace the existing scroll behavior in showStep
        const originalShowStep = showStep;
        window.showStepOptimized = function (stepIndex) {
            originalShowStep(stepIndex);
            smoothScroll(document.body);
        };
    }

    // --- BROWSER COMPATIBILITY ---
    function ensureCompatibility() {
        // Polyfill for FormData.forEach if needed
        if (!FormData.prototype.forEach) {
            FormData.prototype.forEach = function (callback, thisArg) {
                for (const [key, value] of this.entries()) {
                    callback.call(thisArg, value, key, this);
                }
            };
        }

        // Ensure smooth scrolling works in older browsers
        if (!('scrollBehavior' in document.documentElement.style)) {
            window.scrollTo = (function (originalScrollTo) {
                return function (x, y) {
                    if (typeof x === 'object') {
                        originalScrollTo.call(this, x.left || 0, x.top || 0);
                    } else {
                        originalScrollTo.call(this, x, y);
                    }
                };
            })(window.scrollTo);
        }
    }

    // --- INITIALIZE EVERYTHING ---
    function startApplication() {
        try {
            ensureCompatibility();
            initializeForm();
            improveAccessibility();
            optimizePerformance();

            // Add some visual feedback when the app is ready
            document.body.classList.add('app-ready');

            console.log('FunnelCraft Pro form initialized successfully');
        } catch (error) {
            console.error('Error initializing application:', error);
            alert('Error al inicializar la aplicación. Por favor, recarga la página.');
        }
    }

    // Start the application
    startApplication();

}); // End of DOMContentLoaded
    </script>

</body>

</html>