<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constructor de Contenidos para Funnel - Versi√≥n Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-hue: 221;
            --secondary-hue: 196;
            --primary: hsl(var(--primary-hue), 83%, 60%);
            --primary-dark: hsl(var(--primary-hue), 83%, 45%);
            --primary-light: hsl(var(--primary-hue), 95%, 95%);
            --primary-glow: hsla(var(--primary-hue), 83%, 60%, 0.4);
            
            --secondary: hsl(var(--secondary-hue), 84%, 50%);
            
            --text-dark: hsl(215, 24%, 23%);
            --text-light: hsl(217, 16%, 45%);
            --border-color: hsl(220, 23%, 94%);
            --background-light: #ffffff;
            --background-soft: #f9fafb;

            --success: #10b981;
            --warning: #f59e0b;
            --premium: #8b5cf6;
            
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.02), 0 1px 2px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -1px rgba(0,0,0,0.03);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.05), 0 4px 6px -2px rgba(0,0,0,0.03);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.05), 0 10px 10px -5px rgba(0,0,0,0.02);
            --shadow-2xl: 0 25px 50px -12px rgba(0,0,0,0.08);
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--text-light);
            margin: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Improved Header Styles */
        .header-background {
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            position: relative;
            overflow: hidden;
        }

        .header-background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Ccircle cx='30' cy='30' r='4'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            opacity: 0.5;
        }
        
        /* --- Responsive Logo Fix --- */
        .logojavz {
            position: static;
            display: block;
            width: 180px;
            margin: 0 auto 1.5rem auto;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
            transition: transform 0.3s ease;
        }

        .logojavz:hover {
            transform: scale(1.02);
        }

        @media (min-width: 1024px) {
            .logojavz {
                position: absolute;
                top: 2rem;
                right: 2rem;
                width: 280px;
                margin: 0;
            }
        }

        /* Improved Footer Styles */
        
        .footer-gradient {
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #0f172a 100%);
            position: relative;
        }

        .footer-pattern {
            background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.05) 1px, transparent 0);
            background-size: 20px 20px;
        }

        .footer-logo {
            transition: all 0.3s ease;
        }

        .footer-logo:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }

        .footer-link {
            position: relative;
            transition: all 0.3s ease;
        }

        .footer-link:hover {
            color: var(--primary);
            transform: translateY(-1px);
        }

        .footer-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .footer-link:hover::after {
            width: 100%;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: var(--background-soft);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, hsl(var(--primary-hue), 70%, 85%), hsl(var(--secondary-hue), 70%, 85%));
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, hsl(var(--primary-hue), 70%, 75%), hsl(var(--secondary-hue), 70%, 75%));
        }

        .module-card {
            background: linear-gradient(135deg, var(--background-light) 0%, #f8fafc 100%);
            border: 2px solid var(--border-color);
            border-radius: 1.5rem;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-md);
        }

        .module-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-2xl);
            border-color: hsl(var(--primary-hue), 80%, 80%);
        }

        .module-card.selected {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-glow), var(--shadow-2xl);
            transform: translateY(-4px) scale(1.03);
            background: linear-gradient(135deg, var(--primary-light) 0%, #f0f7ff 100%);
        }

        .module-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            filter: saturate(0.5);
            transform: none;
            box-shadow: var(--shadow-sm);
            border-color: var(--border-color);
        }

        .module-card.disabled:hover {
            transform: none;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--background-light);
            font-weight: 600;
            border: none;
            border-radius: 1rem;
            padding: 1rem 2rem;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 25px -6px hsla(var(--primary-hue), 83%, 60%, 0.4);
        }

        .btn-primary:active:not(:disabled) {
            transform: translateY(-1px) scale(0.98);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--text-dark);
            font-weight: 600;
            border: 2px solid var(--border-color);
            border-radius: 1rem;
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .custom-input {
            background: linear-gradient(135deg, var(--background-light) 0%, #f8fafc 100%);
            border: 2px solid var(--border-color);
            border-radius: 1rem;
            padding: 1rem 1.25rem;
            font-size: 1rem;
            color: var(--text-dark);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .custom-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-glow);
            background: var(--background-light);
        }

        .custom-input.input-error {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        }
        .custom-input.input-error:focus {
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.3);
        }

        .custom-checkbox {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            position: relative;
            background: linear-gradient(135deg, var(--background-light) 0%, #f8fafc 100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            flex-shrink: 0;
        }

        .custom-checkbox:checked {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-color: var(--primary);
            animation: checkbox-pop 0.3s ease-out;
        }

        .custom-checkbox:checked::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 7px;
            width: 6px;
            height: 12px;
            border: solid var(--background-light);
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }

        @keyframes checkbox-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 56px;
            height: 32px;
        }

        .toggle-switch input { opacity: 0; width: 0; height: 0; }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, hsl(220, 14%, 88%) 0%, hsl(220, 14%, 78%) 100%);
            transition: .4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 32px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background: linear-gradient(135deg, var(--background-light) 0%, #f8fafc 100%);
            transition: .4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        input:checked + .slider {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .progress-bar-fill {
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            height: 100%;
            border-radius: inherit;
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .tooltip-container {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .tooltip-text {
            visibility: hidden;
            width: 280px;
            background: linear-gradient(135deg, var(--text-dark) 0%, #374151 100%);
            color: var(--background-light);
            text-align: center;
            border-radius: 12px;
            padding: 12px 16px;
            position: absolute;
            z-index: 20;
            bottom: 150%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.875rem;
            font-weight: 500;
            transform: translateY(8px);
            box-shadow: var(--shadow-xl);
        }

        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

        .char-counter {
            text-align: right;
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 8px;
            font-weight: 500;
        }

        .color-picker {
            width: 56px;
            height: 56px;
            border: 3px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
        }

        .color-picker:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
        }
        
        .cost-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
            border: 2px solid #f59e0b;
            color: #92400e;
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-top: 1rem;
            box-shadow: var(--shadow-md);
        }
        
        .cost-warning.data-warning {
            background: linear-gradient(135deg, #fecaca 0%, #fed7d7 100%);
            border-color: #ef4444;
            color: #991b1b;
        }

        .premium-badge {
            background: linear-gradient(135deg, var(--premium) 0%, #a855f7 100%);
            color: white;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 2px 4px rgba(139, 92, 246, 0.3);
        }

        /* --- Section Animation --- */
        .form-section {
            animation: fadeInUp 0.6s ease-out forwards;
            background: linear-gradient(135deg, var(--background-light) 0%, #f8fafc 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            
        }

        @keyframes fadeInUp {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }

        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-2xl);
        }

        /* Summary Modal Improvements */
        .modal-backdrop {
            backdrop-filter: blur(10px);
            background: rgba(0,0,0,0.7);
        }

        .summary-card {
            background: linear-gradient(135deg, var(--background-light) 0%, #f8fafc 100%);
            border-radius: 2rem;
            box-shadow: var(--shadow-2xl);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .summary-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 1rem;
            border: 1px solid var(--border-color);
        }

        .optional-label {
            color: #10b981;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
        }

        @media (max-width: 768px) {
            #moduleSelector {
                grid-template-columns: 1fr;
            }
            body {
                font-size: 95%;
            }
            header {
                padding: 2rem 0;
            }
            .logojavz {
                width: 150px;
            }
        }

        @media (max-width: 640px) {
            .form-section {
                padding: 1rem;
                margin: 0.5rem;
                border-radius: 1.5rem;
            }
            .btn-primary, .btn-secondary {
                padding: 0.875rem 1.5rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body class="bg-white text-gray-800">

    <div class="fixed top-0 left-0 w-full h-2 bg-gray-200 z-50 rounded-b-lg overflow-hidden">
        <div id="progressBar" class="h-full progress-bar-fill" style="width: 0%;"></div>
    </div>

    <header class="py-16 md:py-24 relative header-background text-white">
        <img src="logo-removebg-preview.png" alt="Logo" class="logojavz">
        <div class="container mx-auto px-4 md:px-8 max-w-6xl relative z-10 text-center lg:text-left">
            <h1 class="text-5xl md:text-7xl font-black mb-6 leading-tight">
                <span class="gradient-text">Constructor de Funnels</span>
            </h1>
            <p class="text-xl md:text-2xl font-light opacity-90 max-w-3xl mx-auto lg:mx-0 leading-relaxed">
                Define cada componente de tu embudo de ventas paso a paso para un lanzamiento exitoso. 
                <span class="font-semibold text-blue-200">Versi√≥n Premium</span>
            </p>
            <div class="flex items-center justify-center lg:justify-start mt-8 space-x-6 text-sm opacity-80">
                <div class="flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Configuraci√≥n Completa</span>
                </div>
                <div class="flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Automatizaci√≥n de </span>
                </div>
                <div class="flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Soporte Personalizado</span>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content container mx-auto p-4 md:p-8 max-w-6xl -mt-12 relative z-20">
        <form id="requirementsForm" class="space-y-8" action="https://formspree.io/f/mqalorjq" method="POST" novalidate>

            <section class="form-section bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">1. Tus Datos de Contacto</h2>
                        <p class="text-gray-600 text-lg">Para poder ponernos en contacto contigo y coordinar tu proyecto.</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="clientName" class="block text-gray-700 font-semibold mb-3 text-lg">Nombre Completo *</label>
                        <input type="text" id="clientName" name="client_name" class="w-full custom-input" placeholder="Tu nombre completo" required>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="clientEmail" class="block text-gray-700 font-semibold mb-3 text-lg">Email Principal *</label>
                        <input type="email" id="clientEmail" name="client_email" class="w-full custom-input" placeholder="tu@email.com" required>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido y debe ser un email v√°lido.</span>
                    </div>
                    <div>
                        <label for="clientPhone" class="block text-gray-700 font-semibold mb-3 text-lg">Tel√©fono/WhatsApp *</label>
                        <input type="tel" id="clientPhone" name="client_phone" class="w-full custom-input" placeholder="+506 8888-8888" required>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="clientBusiness" class="block text-gray-700 font-semibold mb-3 text-lg">
                            Nombre del Negocio/Empresa
                            <span class="optional-label">Opcional</span>
                        </label>
                        <input type="text" id="clientBusiness" name="client_business" class="w-full custom-input" placeholder="Nombre de tu empresa">
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">2. Contenido Principal del Funnel</h2>
                        <p class="text-gray-600 text-lg">La base de tu p√°gina de ventas que convertir√° visitantes en clientes.</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <div>
                        <label for="heroTitle" class="block text-gray-700 font-semibold mb-3 text-lg flex items-center">T√≠tulo Principal (Gancho) *
                            <span class="tooltip-container ml-2">
                                <svg class="w-5 h-5 text-gray-400 hover:text-blue-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <span class="tooltip-text">La primera frase que leer√° tu cliente. Debe captar su atenci√≥n y prometer una soluci√≥n a su problema principal.</span>
                            </span>
                        </label>
                        <textarea id="heroTitle" name="hero_title" class="w-full custom-input" placeholder="Ej: Domina el Marketing Digital y Multiplica tus Ventas en 30 D√≠as" rows="2" maxlength="100" required></textarea>
                        <div class="char-counter" id="heroTitleCounter">0 / 100</div>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="heroDescription" class="block text-gray-700 font-semibold mb-3 text-lg">Subt√≠tulo o Descripci√≥n *</label>
                        <textarea id="heroDescription" name="hero_description" class="w-full custom-input" placeholder="Ej: Aprende las t√©cnicas exactas que utilizan los expertos para generar ingresos constantes, sin necesidad de experiencia previa." rows="3" maxlength="250" required></textarea>
                        <div class="char-counter" id="heroDescriptionCounter">0 / 250</div>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="ctaText" class="block text-gray-700 font-semibold mb-3 text-lg">Texto del Bot√≥n Principal *</label>
                        <input type="text" id="ctaText" name="cta_text" class="w-full custom-input" placeholder="Ej: ¬°Quiero Acceder Ahora!, Reservar mi cupo, Descargar Gu√≠a Gratuita" required>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="ctaSecondary" class="block text-gray-700 font-semibold mb-3 text-lg">
                            Texto del Bot√≥n Secundario
                            <span class="optional-label">Opcional</span>
                        </label>
                        <input type="text" id="ctaSecondary" name="cta_secondary" class="w-full custom-input" placeholder="Ej: Ver m√°s informaci√≥n, Contactar, Saber m√°s">
                    </div>
                </div>
            </section>
            
            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                     <div class="w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">3. Estrategia y Objetivos</h2>
                        <p class="text-gray-600 text-lg">Define el prop√≥sito y la audiencia de tu funnel para maximizar conversiones.</p>
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="funnelObjective" class="block text-gray-700 font-semibold mb-3 text-lg">Objetivo Principal del Funnel *</label>
                        <input type="text" id="funnelObjective" name="funnel_objective" class="w-full custom-input" placeholder="Ej: Vender un curso online, generar leads para un servicio, registrar asistentes a un webinar" required>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="targetAudience" class="block text-gray-700 font-semibold mb-3 text-lg">Cliente Ideal (Avatar) *</label>
                        <textarea id="targetAudience" name="target_audience" class="w-full custom-input min-h-32" placeholder="Describe a tu cliente ideal: sus problemas, deseos, demograf√≠a, y qu√© le impide lograr sus metas." rows="4" required></textarea>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="uniqueValue" class="block text-gray-700 font-semibold mb-3 text-lg">Propuesta √önica de Valor (PUV) *</label>
                        <textarea id="uniqueValue" name="unique_value" class="w-full custom-input min-h-28" placeholder="¬øQu√© hace que tu oferta sea √∫nica y diferente a la de la competencia? ¬øCu√°l es el principal beneficio que obtendr√° tu cliente?" rows="3" required></textarea>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    <div>
                        <label for="funnelType" class="block text-gray-700 font-semibold mb-3 text-lg">Tipo de Funnel *</label>
                        <select id="funnelType" name="funnel_type" class="w-full custom-input" required>
                            <option value="">Seleccionar tipo de funnel...</option>
                            <option value="lead-magnet">Lead Magnet - Captura de correos</option>
                            <option value="sales-page">P√°gina de Ventas - Venta directa</option>
                            <option value="webinar">Webinar Funnel - Evento + Venta</option>
                            <option value="tripwire">Tripwire - Oferta de bajo costo</option>
                            <option value="membership">Membres√≠a/Suscripci√≥n</option>
                            <option value="ecommerce">E-commerce - Tienda online</option>
                            <option value="service">Servicios profesionales</option>
                            <option value="application">Aplicaci√≥n/Formulario</option>
                        </select>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">4. Sobre el Creador/Instructor</h2>
                        <p class="text-gray-600 text-lg">Tu credibilidad es clave para la conversi√≥n.
                            <span class="optional-label">Opcional</span>
                        </p>
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="instructorBio" class="block text-gray-700 font-semibold mb-3 text-lg">
                            Biograf√≠a del Instructor
                            <span class="optional-label">Opcional</span>
                        </label>
                        <textarea id="instructorBio" name="instructor_bio" class="w-full custom-input" placeholder="Describe tu experiencia, logros y por qu√© eres la persona indicada para ofrecer esta soluci√≥n." rows="5"></textarea>
                        <p class="text-sm text-gray-500 mt-2">Si no llenas este campo, podemos crear una biograf√≠a profesional basada en la informaci√≥n que proporciones.</p>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">5. Temario / ¬øQu√© aprender√°n?</h2>
                        <p class="text-gray-600 text-lg">El contenido espec√≠fico que ofreces.
                            <span class="optional-label">Opcional</span>
                        </p>
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="topicsText" class="block text-gray-700 font-semibold mb-3 text-lg">
                            Lista de M√≥dulos o Temas
                            <span class="optional-label">Opcional</span>
                        </label>
                        <textarea id="topicsText" name="topics" class="w-full custom-input" placeholder="Lista los m√≥dulos o puntos clave que se cubrir√°n. Ej: - M√≥dulo 1: Fundamentos de la Publicidad Digital. - M√≥dulo 2: Creaci√≥n de Contenido que Vende..." rows="6"></textarea>
                        <p class="text-sm text-gray-500 mt-2">Si no tienes el temario definido, podemos crearlo basado en tu objetivo y audiencia.</p>
                    </div>
                    <div>
                        <label for="audienceText" class="block text-gray-700 font-semibold mb-3 text-lg">
                            ¬øPara Qui√©n Es?
                            <span class="optional-label">Opcional</span>
                        </label>
                        <textarea id="audienceText" name="audience_details" class="w-full custom-input" placeholder="Lista en vi√±etas los perfiles de personas que m√°s se beneficiar√≠an. Ej: - Emprendedores que buscan escalar su negocio. - Marketers que quieren actualizar sus estrategias..." rows="5"></textarea>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                 <div class="flex items-center mb-8">
                        <div class="w-14 h-14 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                        </div>
                        <div>
                               <h2 class="text-3xl md:text-4xl font-bold text-gray-800">6. Recopilaci√≥n de Datos</h2>
                               <p class="text-gray-600 text-lg">¬øQu√© informaci√≥n necesitas de tus clientes potenciales?</p>
                        </div>
                 </div>
                
                 <div class="bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-300 rounded-2xl p-6 mb-6 shadow-lg">
                        <h3 class="font-bold text-green-800 text-xl mb-3 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            üí° Campos de Captura
                        </h3>
                        <p class="text-green-700 mb-4 text-lg">Puedes seleccionar hasta <strong>4 campos GRATIS</strong> (anteriormente 3). Cada campo adicional tiene un costo de <strong>$5 USD</strong>.</p>
                        <div class="flex items-center space-x-2 text-green-700">
                               <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                               <span class="font-semibold">Correo Electr√≥nico siempre est√° incluido</span>
                        </div>
                 </div>
                
                 <div class="space-y-4">
                    <p class="text-gray-700 font-semibold mb-4 text-lg">Selecciona los campos que deseas incluir en tu formulario de captura:</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 overflow-auto">
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-green-400 cursor-pointer transition-all bg-green-50 border-green-300">
                            <input type="checkbox" name="user_data_fields[]" value="email" class="custom-checkbox" checked disabled>
                            <span class="font-medium text-gray-700">Correo Electr√≥nico <span class="text-green-600 text-sm font-bold">(Incluido)</span></span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="full_name" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Nombre Completo</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="phone" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">N√∫mero de Tel√©fono</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="whatsapp" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">WhatsApp</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="company" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Nombre de la Empresa</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="job_title" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Cargo/Profesi√≥n</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="country" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Pa√≠s</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="city" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Ciudad</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="age" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Edad</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="gender" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">G√©nero</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="income" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Nivel de Ingresos</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="experience" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Nivel de Experiencia</span>
                        </label>
                        <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-all">
                            <input type="checkbox" name="user_data_fields[]" value="website" class="custom-checkbox data-field-checkbox">
                            <span class="font-medium text-gray-700">Sitio Web</span>
                        </label>
                    </div>
                    
                    <div id="dataFieldsCostWarning" class="cost-warning data-warning hidden">
                        <div class="flex items-center space-x-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg>
                            <div>
                                <strong class="text-lg">Costo adicional aplicado</strong>
                                <p id="dataFieldsCostText" class="text-sm mt-1"></p>
                            </div>
                        </div>
                    </div>
                 </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-pink-500 to-rose-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">7. Identidad de Marca</h2>
                        <p class="text-gray-600 text-lg">Define los colores, fuentes y sube tus archivos para personalizar tu funnel.
                            <span class="optional-label">Opcional</span>
                        </p>
                    </div>
                </div>
                
                <div class="space-y-8">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">Colores de tu Marca</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="primaryColor" class="block text-gray-700 font-semibold mb-3 text-lg">Color Principal</label>
                                <div class="flex items-center space-x-4">
                                    <input type="color" id="primaryColor" name="primary_color" value="#3B82F6" class="color-picker">
                                    <input type="text" id="primaryColorHex" name="primary_color_hex" class="flex-1 custom-input" value="#3B82F6" placeholder="#3B82F6">
                                </div>
                            </div>
                            <div>
                                <label for="secondaryColor" class="block text-gray-700 font-semibold mb-3 text-lg">Color Secundario</label>
                                <div class="flex items-center space-x-4">
                                    <input type="color" id="secondaryColor" name="secondary_color" value="#10B981" class="color-picker">
                                    <input type="text" id="secondaryColorHex" name="secondary_color_hex" class="flex-1 custom-input" value="#10B981" placeholder="#10B981">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">Fuentes Tipogr√°ficas</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="headingFont" class="block text-gray-700 font-semibold mb-3 text-lg">Fuente para T√≠tulos</label>
                                <select id="headingFont" name="heading_font" class="w-full custom-input">
                                    <option value="inter">Inter (Moderna, limpia)</option>
                                    <option value="poppins">Poppins (Redondeada, amigable)</option>
                                    <option value="montserrat">Montserrat (Elegante, profesional)</option>
                                    <option value="roboto">Roboto (Vers√°til, clara)</option>
                                    <option value="playfair">Playfair Display (Elegante, serif)</option>
                                    <option value="oswald">Oswald (Impactante, condensada)</option>
                                </select>
                            </div>
                            <div>
                                <label for="bodyFont" class="block text-gray-700 font-semibold mb-3 text-lg">Fuente para Texto</label>
                                <select id="bodyFont" name="body_font" class="w-full custom-input">
                                    <option value="inter">Inter (Moderna, limpia)</option>
                                    <option value="roboto">Roboto (Vers√°til, clara)</option>
                                    <option value="opensans">Open Sans (Legible, neutra)</option>
                                    <option value="lato">Lato (Profesional, humanista)</option>
                                    <option value="sourcesans">Source Sans Pro (T√©cnica, clara)</option>
                                    <option value="nunito">Nunito Sans (Amigable, redondeada)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-300 rounded-2xl p-6 shadow-lg">
                        <h3 class="font-bold text-green-800 text-xl mb-3 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                            Subir Archivos de tu Marca
                        </h3>
                        <p class="text-green-700 mb-4 text-lg">Logo, im√°genes, videos y cualquier archivo que necesites para tu funnel.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6">
                            <div class="flex items-center space-x-2 text-green-700">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                <span>Videos promocionales o explicativos</span>
                            </div>
                            <div class="flex items-center space-x-2 text-green-700">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                <span>Fotos del equipo o testimonios</span>
                            </div>
                        </div>
                        <a href="https://drive.google.com/drive/folders/1UyFbNW71LQ2rWQK4NKjwu0TUxWRfkBnr?usp=drive_link" target="_blank" class="inline-flex items-center space-x-3 bg-green-600 text-white font-bold py-4 px-6 rounded-xl hover:bg-green-700 transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                            <span>Subir Archivos a Google Drive</span>
                        </a>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">8. Configuraci√≥n de Contacto</h2>
                        <p class="text-gray-600 text-lg">Define c√≥mo los usuarios pueden contactarte.
                            <span class="optional-label">Opcional</span>
                        </p>
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="supportEmail" class="block text-gray-700 font-semibold mb-3 text-lg">
                            Email de Soporte
                            <span class="optional-label">Opcional</span>
                        </label>
                        <input type="email" id="supportEmail" name="support_email" class="w-full custom-input" placeholder="soporte@tuempresa.com">
                        <p class="text-sm text-gray-500 mt-2">Si no proporcionas un email, usaremos tu email principal.</p>
                    </div>
                    
                    <div class="bg-blue-50 border-2 border-blue-200 rounded-2xl p-6 flex items-center justify-between shadow-md">
                        <div>
                            <h3 class="font-bold text-blue-800 text-xl">¬øIncluir n√∫mero de tel√©fono?</h3>
                            <p class="text-blue-700">Permitir que los clientes te contacten por WhatsApp o llamada</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="includePhoneToggle" name="include_phone">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div id="phoneSection" class="hidden space-y-4">
                        <div>
                            <label for="contactPhone" class="block text-gray-700 font-semibold mb-3 text-lg">N√∫mero de Tel√©fono/WhatsApp</label>
                            <input type="tel" id="contactPhone" name="contact_phone" class="w-full custom-input" placeholder="+506 8888-8888">
                        </div>
                        <div>
                            <label for="whatsappMessage" class="block text-gray-700 font-semibold mb-3 text-lg">Mensaje predeterminado de WhatsApp</label>
                            <textarea id="whatsappMessage" name="whatsapp_message" class="w-full custom-input" placeholder="Hola! Me interesa saber m√°s sobre..." rows="2"></textarea>
                        </div>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8">
                    <div class="flex items-center mb-4 sm:mb-0">
                        <div class="w-14 h-14 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path></svg>
                        </div>
                        <div>
                            <h2 class="text-3xl md:text-4xl font-bold text-gray-800">9. M√≥dulos Extras del Funnel</h2>
                            <p class="text-gray-600 text-lg">Componentes opcionales para potenciar tu conversi√≥n.</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div id="extrasCounter" class="font-bold text-xl text-gray-700 bg-gray-100 py-2 px-4 rounded-lg transition-colors duration-300">0 seleccionados</div>
                        <div id="extraCostDisplay" class="font-bold text-xl text-green-600 transition-all duration-300"></div>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-amber-50 to-orange-100 border-2 border-amber-300 rounded-2xl p-6 mb-8 shadow-lg">
                    <h3 class="font-bold text-amber-800 text-xl mb-3 flex items-center">
                        <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        üéØ Selecciona los m√≥dulos que necesites
                    </h3>
                    <p class="text-amber-700 text-lg">Los primeros <strong>4 m√≥dulos son GRATIS</strong>. A partir del quinto m√≥dulo, se aplica un costo de <strong>$15 USD</strong> por cada uno.</p>
                </div>

                <div id="extrasSelector" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-8"></div>
                <div id="extrasFormSections" class="space-y-6"></div>
                
                <div id="extraModulesCostWarning" class="cost-warning hidden">
                    <div class="flex items-center space-x-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg>
                        <div>
                            <strong class="text-lg">Costo adicional aplicado</strong>
                            <p id="extraModulesCostText" class="text-sm mt-1"></p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">10. Comunicaciones de Bienvenida y Seguimiento</h2>
                        <p class="text-gray-600 text-lg">Automatiza la bienvenida y el seguimiento de tus nuevos leads.</p>
                    </div>
                </div>
                <div class="space-y-8">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">Mensaje de Bienvenida</h3>
                        <p class="text-gray-600 mb-4 text-lg">Elige si quieres enviar un mensaje autom√°tico a los nuevos usuarios al registrarse.</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer">
                                <input type="radio" name="welcome_message_type" value="none" class="custom-checkbox" checked>
                                <span class="font-semibold">Ninguno</span>
                            </label>
                            <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer">
                                <input type="radio" name="welcome_message_type" value="email" class="custom-checkbox">
                                <span class="font-semibold">Correo Electr√≥nico</span>
                            </label>
                            <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-xl hover:border-purple-300 cursor-pointer relative">
                                <input type="radio" name="welcome_message_type" value="whatsapp" class="custom-checkbox">
                                <span class="font-semibold">WhatsApp</span>
                                <span class="premium-badge">PREMIUM</span>
                            </label>
                        </div>
            
                        <div id="welcomeEmailSection" class="hidden mt-6 space-y-4 bg-gray-50 p-6 rounded-xl border border-gray-200">
                            <h4 class="font-bold text-gray-700 text-lg">Configuraci√≥n de Correo de Bienvenida</h4>
                            <div>
                                <label for="welcomeEmailFrom" class="block text-gray-700 font-semibold mb-2">Correo Remitente</label>
                                <input type="email" id="welcomeEmailFrom" name="welcome_email_from" class="w-full custom-input" placeholder="ej: info@tuempresa.com">
                            </div>
                            <div>
                                <label for="welcomeEmailSubject" class="block text-gray-700 font-semibold mb-2">Asunto del Correo</label>
                                <input type="text" id="welcomeEmailSubject" name="welcome_email_subject" class="w-full custom-input" placeholder="¬°Bienvenido/a! Aqu√≠ tienes tu acceso.">
                            </div>
                            <div>
                                <label for="welcomeEmailTemplate" class="block text-gray-700 font-semibold mb-2">Plantilla del Mensaje</label>
                                <textarea id="welcomeEmailTemplate" name="welcome_email_template" class="w-full custom-input" placeholder="Hola [Nombre], gracias por registrarte. Puedes acceder a tu contenido aqu√≠: [Enlace]" rows="5"></textarea>
                            </div>
                        </div>
            
                        <div id="welcomeWhatsappSection" class="hidden mt-6 space-y-4 bg-purple-50 p-6 rounded-xl border-2 border-purple-200">
                            <h4 class="font-bold text-purple-800 text-lg flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                Configuraci√≥n Premium de WhatsApp
                            </h4>
                            <div id="whatsappCostWarning" class="bg-gradient-to-r from-purple-100 to-violet-100 border-2 border-purple-300 rounded-xl p-4">
                                <div class="flex items-center space-x-2">
                                    <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg>
                                    <div>
                                        <strong class="text-purple-800 text-lg">Costo adicional: $30.00 USD</strong>
                                        <p class="text-purple-700 text-sm mt-1">Requiere una cuenta de WhatsApp Business API activa y configuraci√≥n especializada.</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="welcomeWhatsappFrom" class="block text-gray-700 font-semibold mb-2">N√∫mero de Tel√©fono Remitente (con WhatsApp Business API)</label>
                                <input type="tel" id="welcomeWhatsappFrom" name="welcome_whatsapp_from" class="w-full custom-input" placeholder="+50688888888">
                            </div>
                            <div>
                                <label for="welcomeWhatsappMessage" class="block text-gray-700 font-semibold mb-2">Mensaje de Bienvenida</label>
                                <textarea id="welcomeWhatsappMessage" name="welcome_whatsapp_message" class="w-full custom-input" placeholder="¬°Hola {{1}}! Gracias por registrarte en {{2}}. Aqu√≠ tienes tu acceso: {{3}}" rows="4"></textarea>
                                <p class="text-xs text-gray-500 mt-1">Usa variables como `{{1}}` para el nombre del cliente. El mensaje debe ser pre-aprobado por Meta.</p>
                            </div>
                        </div>
                    </div>
            
                    <hr class="border-gray-300">
            
                    <div>
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 flex items-center justify-between shadow-md">
                            <div>
                                <h3 class="font-bold text-blue-800 text-xl">¬øHabilitar correos de seguimiento?</h3>
                                <p class="text-blue-700 text-lg">Nutre a tus leads con una secuencia de correos autom√°ticos para mejorar las conversiones.</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enableFollowUpToggle" name="enable_follow_up">
                                <span class="slider"></span>
                            </label>
                        </div>
            
                        <div id="followUpSection" class="hidden mt-6 space-y-6 bg-gray-50 p-6 rounded-xl border border-gray-200">
                             <div class="bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-300 rounded-2xl p-4 shadow-lg">
                                <h4 class="font-bold text-green-800 text-lg mb-2">Incluye 3 correos de seguimiento GRATIS</h4>
                                <p class="text-green-700">Cada correo adicional tiene un costo de <strong>$3 USD</strong>. M√°ximo recomendado: 7 correos.</p>
                             </div>
                            
                            <div class="space-y-4">
                                <h5 class="font-bold text-gray-700 text-lg">Configuraci√≥n de correos gratuitos</h5>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label for="followUpDelay1" class="block text-gray-700 font-semibold mb-2">Correo 1 - D√≠as despu√©s</label>
                                        <input type="number" id="followUpDelay1" name="follow_up_delay_free[]" class="w-full custom-input" placeholder="1" min="1" max="365">
                                        <p class="text-xs text-gray-500 mt-1">Ej: 1 d√≠a despu√©s del registro</p>
                                    </div>
                                    <div>
                                        <label for="followUpDelay2" class="block text-gray-700 font-semibold mb-2">Correo 2 - D√≠as despu√©s</label>
                                        <input type="number" id="followUpDelay2" name="follow_up_delay_free[]" class="w-full custom-input" placeholder="3" min="1" max="365">
                                        <p class="text-xs text-gray-500 mt-1">Ej: 3 d√≠as despu√©s del registro</p>
                                    </div>
                                    <div>
                                        <label for="followUpDelay3" class="block text-gray-700 font-semibold mb-2">Correo 3 - D√≠as despu√©s</label>
                                        <input type="number" id="followUpDelay3" name="follow_up_delay_free[]" class="w-full custom-input" placeholder="7" min="1" max="365">
                                        <p class="text-xs text-gray-500 mt-1">Ej: 7 d√≠as despu√©s del registro</p>
                                    </div>
                                </div>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <p class="text-blue-700 text-sm">üí° <strong>Tip:</strong> Los correos de seguimiento m√°s efectivos siguen el patr√≥n: D√≠a 1 (bienvenida y entrega), D√≠a 3 (valor adicional), D√≠a 7 (llamada a la acci√≥n principal).</p>
                                </div>
                            </div>
                            
                            <hr class="border-gray-200">
            
                            <div>
                                <h5 class="font-bold text-gray-700 text-lg">Correos adicionales (con costo)</h5>
                                <div id="additionalFollowUpContainer" class="space-y-4 mt-4">
                                    </div>
                                <button type="button" id="addFollowUpBtn" class="mt-4 text-blue-600 font-semibold py-3 px-6 rounded-xl border-2 border-blue-200 hover:bg-blue-50 transition-all hover:scale-105 shadow-md">
                                    + Agregar correo adicional ($3 c/u)
                                </button>
                                <div id="followUpCostWarning" class="cost-warning hidden mt-4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">11. Informaci√≥n Adicional del Funnel</h2>
                        <p class="text-gray-600 text-lg">Detalles importantes que nos ayudar√°n a crear tu funnel perfecto.</p>
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="trafficSource" class="block text-gray-700 font-semibold mb-3 text-lg">¬øDe d√≥nde vendr√° tu tr√°fico principal? *</label>
                        <select id="trafficSource" name="traffic_source" class="w-full custom-input" required>
                            <option value="">Seleccionar fuente de tr√°fico...</option>
                            <option value="facebook-ads">Facebook/Instagram Ads</option>
                            <option value="google-ads">Google Ads</option>
                            <option value="social-organic">Redes Sociales Org√°nicas</option>
                            <option value="email-list">Lista de Email existente</option>
                            <option value="seo-organic">SEO/Tr√°fico Org√°nico</option>
                            <option value="influencers">Influencers/Afiliados</option>
                            <option value="referrals">Referencias/Boca a boca</option>
                            <option value="offline">Marketing Offline</option>
                            <option value="multiple">M√∫ltiples fuentes</option>
                        </select>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    
                    <div>
                        <label for="timeframe" class="block text-gray-700 font-semibold mb-3 text-lg">¬øCu√°ndo necesitas que est√© listo el funnel? *</label>
                        <select id="timeframe" name="timeframe" class="w-full custom-input" required>
                            <option value="">Seleccionar tiempo...</option>
                            <option value="asap">Lo antes posible (rush)</option>
                            <option value="1-week">En 1 semana</option>
                            <option value="2-weeks">En 2 semanas</option>
                            <option value="1-month">En 1 mes</option>
                            <option value="flexible">Soy flexible con los tiempos</option>
                        </select>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    
                    <div>
                        <label for="currentBusiness" class="block text-gray-700 font-semibold mb-3 text-lg">¬øYa tienes un negocio funcionando o est√°s empezando? *</label>
                        <select id="currentBusiness" name="business_stage" class="w-full custom-input" required>
                            <option value="">Seleccionar etapa...</option>
                            <option value="startup">Empezando desde cero</option>
                            <option value="early">Negocio nuevo (menos de 6 meses)</option>
                            <option value="established">Negocio establecido (6+ meses)</option>
                            <option value="scaling">Negocio en crecimiento, quiero escalar</option>
                            <option value="mature">Negocio maduro, optimizando conversiones</option>
                        </select>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    
                    <div>
                        <label for="mainChallenge" class="block text-gray-700 font-semibold mb-3 text-lg">¬øCu√°l es tu principal desaf√≠o actual? *</label>
                        <select id="mainChallenge" name="main_challenge" class="w-full custom-input" required>
                            <option value="">Seleccionar desaf√≠o...</option>
                            <option value="traffic">Generar tr√°fico</option>
                            <option value="conversion">Mejorar conversiones</option>
                            <option value="leads">Capturar m√°s leads</option>
                            <option value="sales">Cerrar m√°s ventas</option>
                            <option value="trust">Generar confianza/credibilidad</option>
                            <option value="competition">Diferenciarse de la competencia</option>
                            <option value="pricing">Definir precios correctos</option>
                            <option value="automation">Automatizar procesos</option>
                        </select>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    
                    <div>
                        <label for="successMetric" class="block text-gray-700 font-semibold mb-3 text-lg">¬øC√≥mo medir√°s el √©xito de tu funnel? *</label>
                        <textarea id="successMetric" name="success_metric" class="w-full custom-input" placeholder="Ej: 50 leads por d√≠a, 5 ventas semanales, ROI del 300%, etc." rows="3" required></textarea>
                        <span class="error-message text-red-500 text-sm mt-1 hidden">Este campo es requerido.</span>
                    </div>
                    
                    <div>
                        <label for="inspiration" class="block text-gray-700 font-semibold mb-3 text-lg">
                            ¬øHay alg√∫n funnel o p√°gina que te guste como referencia?
                            <span class="optional-label">Opcional</span>
                        </label>
                        <textarea id="inspiration" name="inspiration" class="w-full custom-input" placeholder="Pega aqu√≠ URLs de p√°ginas que te gusten o describe el estilo que buscas" rows="3"></textarea>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-8">
                    <div class="w-14 h-14 bg-gradient-to-br from-slate-500 to-gray-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 01-9 9m9-9H3m9 9v9a9 9 0 01-9-9m9-9a9 9 0 00-9-9 9 9 0 009 9zm0 0a9 9 0 00-9-9"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">12. Configuraci√≥n T√©cnica</h2>
                        <p class="text-gray-600 text-lg">Configuraci√≥n de dominio y aspectos t√©cnicos.
                            <span class="optional-label">Opcional</span>
                        </p>
                    </div>
                </div>
                <div class="space-y-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">Tipo de Dominio</label>
                        <div class="space-y-3">
                            <label class="flex items-center space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer bg-green-50 border-green-300">
                                <input type="radio" name="domain_type" value="free" class="custom-checkbox" checked>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800 text-lg">Dominio Gratuito (Recomendado)</h4>
                                    <p class="text-gray-600">Usaremos un subdominio gratuito como: <strong>tufunnel.mipagina.com</strong></p>
                                </div>
                            </label>
                            <label class="flex items-center space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer">
                                <input type="radio" name="domain_type" value="custom" class="custom-checkbox">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800 text-lg">Dominio Personalizado</h4>
                                    <p class="text-gray-600">Ya tengo mi propio dominio o quiero comprar uno</p>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <div id="customDomainSection" class="hidden">
                        <label for="customDomain" class="block text-gray-700 font-semibold mb-3 text-lg">Tu Dominio Personalizado</label>
                        <input type="text" id="customDomain" name="custom_domain" class="w-full custom-input" placeholder="Ej: mifunnel.com, ventas.miempresa.com">
                        <p class="text-gray-500 mt-2">Si no tienes dominio, te ayudamos a conseguir uno por un costo adicional.</p>
                    </div>
                    
                    <div>
                        <label for="preferredSubdomain" class="block text-gray-700 font-semibold mb-3 text-lg">
                            Nombre preferido para el subdominio
                            <span class="optional-label">Opcional</span>
                        </label>
                        <input type="text" id="preferredSubdomain" name="preferred_subdomain" class="w-full custom-input" placeholder="Ej: ventas, curso, promo, landing">
                        <p class="text-gray-500 mt-2">Esto ser√° parte de tu URL: <strong>tunombre</strong>.mipagina.com</p>
                    </div>
                </div>
            </section>

            <section class="form-section hidden bg-white rounded-3xl p-6 md:p-10 card-hover border border-gray-100 shadow-lg">
                <div class="flex items-center mb-6">
                    <div class="w-14 h-14 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center mr-4 shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-800">13. Notas Adicionales</h2>
                        <p class="text-gray-600 text-lg">Cualquier detalle final que quieras agregar.
                            <span class="optional-label">Opcional</span>
                        </p>
                    </div>
                </div>
                <label for="additionalNotes" class="block text-gray-700 font-semibold mb-3 text-lg">
                    Notas Adicionales
                    <span class="optional-label">Opcional</span>
                </label>
                <textarea id="additionalNotes" name="additional_notes" class="w-full custom-input min-h-32" placeholder="Escribe aqu√≠ cualquier informaci√≥n adicional, requerimientos especiales, dudas o comentarios que consideres importantes..." rows="6"></textarea>
                <p class="text-sm text-gray-500 mt-2">Este es un buen lugar para mencionar funcionalidades espec√≠ficas, integraciones con otras herramientas, o cualquier detalle que no se haya cubierto en las secciones anteriores.</p>
            </section>
            
            <!-- Resumen de Costos siempre visible antes del env√≠o -->
            <div id="totalCostSummarySection" class="bg-gradient-to-br from-blue-50 to-indigo-100 border-2 border-blue-300 rounded-3xl p-8 shadow-xl" style="display: none;">
                <div class="text-center">
                    <div class="flex items-center justify-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="text-3xl font-bold text-blue-800 mb-4">Resumen de Costos Adicionales</h3>
                    <div id="totalCostBreakdown" class="text-xl text-blue-700 mt-4 space-y-2 bg-white rounded-2xl p-6 shadow-md"></div>
                    <div id="totalCostAmount" class="text-4xl font-bold text-blue-900 mt-6 bg-white rounded-2xl p-4 shadow-md"></div>
                    <p class="text-lg text-gray-600 mt-4 bg-white rounded-xl p-3">Estos montos se a√±adir√°n a la cotizaci√≥n final del proyecto.</p>
                </div>
            </div>

            <!-- Secci√≥n de Resumen Final antes del env√≠o -->
            <section id="finalSummarySection" class="form-section hidden bg-white rounded-3xl p-8 md:p-12 border-2 border-blue-200 shadow-2xl">
                <div class="text-center mb-8">
                    <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl">
                        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-4xl md:text-5xl font-bold gradient-text mb-4">Resumen de tu Proyecto</h2>
                    <p class="text-xl text-gray-600">Revisa toda la informaci√≥n antes de enviar</p>
                </div>

                <div id="summaryContent" class="space-y-6 mb-8">
                    <!-- El contenido del resumen se generar√° din√°micamente -->
                </div>

                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button type="button" id="editProjectBtn" class="btn-secondary text-lg">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        Modificar Proyecto
                    </button>
                    <button type="submit" id="generateSummaryBtn" class="btn-primary text-xl shadow-2xl relative overflow-hidden group">
                        <span class="relative z-10 flex items-center justify-center space-x-3">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                            <span>Enviar Proyecto</span>
                        </span>
                    </button>
                </div>
            </section>

            <!-- Hidden fields para costos -->
            <input type="hidden" name="extra_data_fields_count" id="extraDataFieldsCountHidden">
            <input type="hidden" name="extra_data_fields_cost" id="extraDataFieldsCostHidden">
            <input type="hidden" name="extra_modules_count" id="extraModulesCountHidden">
            <input type="hidden" name="extra_modules_cost" id="extraModulesCostHidden">
            <input type="hidden" name="whatsapp_cost" id="whatsappCostHidden" value="0">
            <input type="hidden" name="follow_up_emails_count" id="extraFollowUpCountHidden" value="0">
            <input type="hidden" name="follow_up_emails_cost" id="extraFollowUpCostHidden" value="0">
            <input type="hidden" name="total_extra_cost" id="totalExtraCostHidden">
            <textarea name="summary" id="summaryHidden" class="hidden"></textarea>

            <!-- Honeypot for spam -->
            <div style="display:none;">
                <label for="bot-field">No llenar</label>
                <input type="text" name="bot-field" id="bot-field">
            </div>

            <!-- Controles de navegaci√≥n -->
            <div id="navigation-controls" class="mt-8 pt-6 border-t-2 border-gray-200">
                <div class="flex flex-col-reverse sm:flex-row items-center justify-between gap-4">
                    <div class="flex items-center gap-4 w-full sm:w-auto">
                        <button type="button" id="prevBtn" class="btn-secondary w-1/2 sm:w-auto">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                            Atr√°s
                        </button>
                        <button type="button" id="clearFormBtn" class="text-gray-600 hover:text-red-500 font-semibold py-3 px-6 rounded-xl bg-white border-2 border-gray-200 hover:border-red-300 shadow-md hover:shadow-lg transition-all w-1/2 sm:w-auto">
                            <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                            Limpiar
                        </button>
                    </div>
                    
                    <div class="w-full sm:w-auto">
                        <button type="button" id="nextBtn" class="w-full btn-primary text-lg">
                            <span>Siguiente</span>
                            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                        </button>
                        <button type="button" id="reviewProjectBtn" class="btn-primary text-xl shadow-2xl relative overflow-hidden group hidden w-full">
                            <span class="relative z-10 flex items-center justify-center space-x-3">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg>
                                <span>Revisar Proyecto</span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>

        </form>
    </main>

    <!-- Footer Mejorado -->
    <footer class="footer-gradient footer-pattern py-16 mt-16">
        <div class="container mx-auto px-4 max-w-6xl">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
                <!-- Logo y descripci√≥n -->
                <div class="md:col-span-2">
                    <img src="logo-removebg-preview.png" alt="Logo" class="footer-logo h-16 w-auto mb-6">
                    <p class="text-slate-300 text-lg leading-relaxed mb-6">
                        Especialistas en la creaci√≥n de funnels de conversi√≥n de alto rendimiento. 
                        Transformamos visitantes en clientes con estrategias probadas y tecnolog√≠a avanzada.
                    </p>
                    <div class="flex space-x-4">
                        <div class="w-12 h-12 bg-slate-700 hover:bg-blue-600 rounded-xl flex items-center justify-center transition-all cursor-pointer">
                            <svg class="w-6 h-6 text-slate-300" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04 .67.11 .98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
                            </svg>
                        </div>
                        <div class="w-12 h-12 bg-slate-700 hover:bg-blue-800 rounded-xl flex items-center justify-center transition-all cursor-pointer">
                            <svg class="w-6 h-6 text-slate-300" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
                            </svg>
                        </div>
                        <div class="w-12 h-12 bg-slate-700 hover:bg-purple-600 rounded-xl flex items-center justify-center transition-all cursor-pointer">
                            <svg class="w-6 h-6 text-slate-300" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.748-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-12.014C24.007 5.367 18.641.001 12.017.001z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- Servicios -->
                <div>
                    <h3 class="text-xl font-bold text-white mb-6">Nuestros Servicios</h3>
                    <ul class="space-y-3">
                        <li><a href="#" class="footer-link text-slate-300 hover:text-white">Funnels de Ventas</a></li>
                        <li><a href="#" class="footer-link text-slate-300 hover:text-white">Landing Pages</a></li>
                        <li><a href="#" class="footer-link text-slate-300 hover:text-white">Email Marketing</a></li>
                        <li><a href="#" class="footer-link text-slate-300 hover:text-white">Automatizaci√≥n</a></li>
                        <li><a href="#" class="footer-link text-slate-300 hover:text-white">Consultor√≠a Digital</a></li>
                    </ul>
                </div>
                
                <!-- Contacto -->
                <div>
                    <h3 class="text-xl font-bold text-white mb-6">Contacto</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                            <a href="mailto:info@javz.com" class="footer-link text-slate-300">info@javz.com</a>
                        </div>
                        <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            <span class="text-slate-300">+506 8888-8888</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="text-slate-300">San Jos√©, Costa Rica</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- L√≠nea divisoria y copyright -->
            <div class="border-t border-slate-600 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-slate-400 text-sm mb-4 md:mb-0">
                        &copy; <span id="currentYear"></span> Javz. Todos los derechos reservados.
                    </p>
                    <div class="flex space-x-6 text-sm">
                        <a href="#" class="footer-link text-slate-400 hover:text-white">T√©rminos de Servicio</a>
                        <a href="#" class="footer-link text-slate-400 hover:text-white">Pol√≠tica de Privacidad</a>
                        <a href="#" class="footer-link text-slate-400 hover:text-white">Cookies</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Modal de confirmaci√≥n mejorado -->
    <div id="summaryModal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50 modal-backdrop">
        <div class="summary-card w-full max-w-lg flex flex-col text-center p-10 md:p-12 transform scale-95 opacity-0 transition-all duration-500" id="modalContent">
            <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl">
                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
            </div>
            <h2 class="text-4xl md:text-5xl font-bold gradient-text mb-6">¬°Proyecto Enviado!</h2>
            <p class="text-gray-600 mb-8 text-xl leading-relaxed">
                Hemos recibido toda tu informaci√≥n correctamente. Nuestro equipo revisar√° tu proyecto y se pondr√° en contacto contigo en un plazo m√°ximo de <strong>24 horas</strong>.
            </p>
            <div class="bg-blue-50 rounded-2xl p-6 mb-8 border border-blue-200">
                <h3 class="font-bold text-blue-800 mb-2">¬øQu√© sigue ahora?</h3>
                <ul class="text-blue-700 text-left space-y-2">
                    <li>‚úÖ An√°lisis detallado de tu proyecto</li>
                    <li>‚úÖ Cotizaci√≥n personalizada</li>
                    <li>‚úÖ Llamada de estrategia (opcional)</li>
                    <li>‚úÖ Inicio del desarrollo</li>
                </ul>
            </div>
            <button id="closeModalBtn" class="w-full btn-primary text-xl py-4">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Perfecto, Gracias
            </button>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- START: Section Navigation Logic ---
    const form = document.getElementById('requirementsForm');
    const sections = Array.from(form.querySelectorAll('.form-section'));
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const reviewBtn = document.getElementById('reviewProjectBtn');
    const submitBtn = document.getElementById('generateSummaryBtn');
    const editBtn = document.getElementById('editProjectBtn');
    const progressBar = document.getElementById('progressBar');
    
    let currentSectionIndex = 0;
    const totalSections = sections.length;

    function updateNavigation() {
        // Update button visibility based on current section
        prevBtn.style.display = currentSectionIndex === 0 ? 'none' : 'inline-flex';
        nextBtn.style.display = currentSectionIndex === totalSections - 2 ? 'none' : 'inline-flex';
        reviewBtn.style.display = currentSectionIndex === totalSections - 2 ? 'inline-flex' : 'none';
        submitBtn.style.display = 'none'; // Solo visible en la secci√≥n de resumen

        // Update progress bar
        const progress = ((currentSectionIndex) / (totalSections - 1)) * 100;
        progressBar.style.width = `${progress}%`;

        // Show the current section and hide others
        sections.forEach((section, index) => {
            section.classList.toggle('hidden', index !== currentSectionIndex);
        });
        
        // Update stepper
        document.querySelectorAll('.step-pill').forEach((pill, index) => {
            pill.classList.toggle('bg-blue-100 text-blue-800', index === currentSectionIndex);
            pill.classList.toggle('active', index === currentSectionIndex);
            pill.querySelector('span:first-child').classList.toggle('bg-blue-500', index === currentSectionIndex);
            pill.classList.toggle('completed', index < currentSectionIndex);
            pill.classList.toggle('bg-green-100 text-green-800', index < currentSectionIndex);
            pill.querySelector('span:first-child').classList.toggle('bg-green-500', index < currentSectionIndex);
        });
        
        // Update cost summary visibility
        updateTotalCostSummary();
        
        // Scroll to the top of the main content area for better UX
        document.querySelector('.main-content').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function validateCurrentSection() {
        const currentSectionEl = sections[currentSectionIndex];
        const inputs = currentSectionEl.querySelectorAll('input[required], textarea[required], select[required]');
        let allValid = true;

        inputs.forEach(input => {
            const errorSpan = input.nextElementSibling;
            input.classList.remove('input-error');
            if (errorSpan && errorSpan.classList.contains('error-message')) {
                errorSpan.classList.add('hidden');
            }
            if (!input.checkValidity()) {
                input.classList.add('input-error');
                if (errorSpan && errorSpan.classList.contains('error-message')) {
                    errorSpan.textContent = input.validationMessage || 'Este campo es requerido.';
                    errorSpan.classList.remove('hidden');
                }
                allValid = false;
            }
        });
        
        if (!allValid) {
            const firstInvalid = currentSectionEl.querySelector('.input-error');
            if (firstInvalid) {
                firstInvalid.focus();
                firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        return allValid;
    }

    nextBtn.addEventListener('click', () => {
        if (validateCurrentSection()) {
            if (currentSectionIndex < totalSections - 1) {
                currentSectionIndex++;
                updateNavigation();
            }
        }
    });

    prevBtn.addEventListener('click', () => {
        if (currentSectionIndex > 0) {
            currentSectionIndex--;
            updateNavigation();
        }
    });

    // Bot√≥n de revisar proyecto
    reviewBtn.addEventListener('click', () => {
        if (validateCurrentSection()) {
            generateProjectSummary();
            currentSectionIndex = totalSections - 1; // Ir a la √∫ltima secci√≥n (resumen)
            updateNavigation();
        }
    });

    // Bot√≥n de editar (volver a la pen√∫ltima secci√≥n)
    editBtn.addEventListener('click', () => {
        currentSectionIndex = totalSections - 2;
        updateNavigation();
    });
    // --- END: Section Navigation Logic ---

    // M√≥dulos extras actualizados (sin los que est√°n por defecto)
    const extrasModules = [
        { id: 'testimonials', name: 'Testimonios', icon: 'message-circle', description: 'Rese√±as y testimonios de clientes' },
        { id: 'pricing', name: 'Tabla de Precios', icon: 'dollar-sign', description: 'Planes y opciones de precio' },
        { id: 'bonus', name: 'Bonus', icon: 'gift', description: 'Productos o servicios adicionales' },
        { id: 'guarantee', name: 'Garant√≠a', icon: 'shield', description: 'Garant√≠a de satisfacci√≥n' },
        { id: 'faq', name: 'Preguntas Frecuentes', icon: 'help-circle', description: 'Respuestas a dudas comunes' },
        
        { id: 'countdown', name: 'Contador de Urgencia', icon: 'clock', description: 'Tiempo limitado para la oferta' },
        { id: 'video', name: 'Video de Ventas', icon: 'video', description: 'Video promocional o explicativo' },
        { id: 'socials', name: 'Redes Sociales', icon: 'share-2', description: 'Enlaces a perfiles sociales (m√°x. 4)' },
        { id: 'leadMagnet', name: 'Lead Magnet', icon: 'gift', description: 'Incentivo gratuito para captar leads' },
        
        { id: 'webinar', name: 'Integraci√≥n Webinar', icon: 'video', description: 'Registro para webinar o evento' },
        { id: 'legal', name: 'Aspectos Legales', icon: 'file-text', description: 'T√©rminos, pol√≠ticas y aspectos legales' },
    ];
    
    // Constantes para la l√≥gica de costos (cambiado FREE_DATA_FIELDS_LIMIT a 4)
    const FREE_DATA_FIELDS_LIMIT = 4; // Cambiado de 3 a 4
    const COST_PER_EXTRA_DATA_FIELD = 5;
    const FREE_MODULE_LIMIT = 4;
    const COST_PER_EXTRA_MODULE = 15;
    const COST_PER_WHATSAPP = 30;
    const COST_PER_EXTRA_FOLLOW_UP = 3;

    const extrasSectionTemplates = {
        testimonials: `<h3 class="text-xl font-bold mb-4">Testimonios</h3><textarea id="testimonialsText" name="testimonials" class="w-full p-3 rounded-xl custom-input" placeholder="Pega aqu√≠ 2 o 3 de tus mejores testimonios. Incluye el nombre de la persona. Ej: 'Este curso cambi√≥ mi negocio.' - Juan P√©rez" rows="6"></textarea>`,
        pricing: `<h3 class="text-xl font-bold mb-4">Tabla de Precios</h3><div class="space-y-4"><div><label for="pricingText" class="block text-gray-700 font-semibold mb-2">Planes y Precios</label><textarea id="pricingText" name="pricing" class="w-full p-3 rounded-xl custom-input" placeholder="Describe tus planes o precios. Ej: Plan B√°sico: $97 - Acceso al curso. Plan Premium: $147 - Acceso al curso + 3 bonus." rows="5"></textarea></div><div><label for="pricingStrategy" class="block text-gray-700 font-semibold mb-2">Estrategia de Precios</label><select id="pricingStrategy" name="pricing_strategy" class="w-full p-3 rounded-xl custom-input"><option value="">Seleccionar...</option><option value="precio-unico">Precio √∫nico</option><option value="precios-escalonados">Precios escalonados (3 planes)</option><option value="oferta-limitada">Oferta por tiempo limitado</option><option value="freemium">Freemium + Premium</option></select></div></div>`,
        bonus: `<h3 class="text-xl font-bold mb-4">Bonus</h3><textarea id="bonusText" name="bonus" class="w-full p-3 rounded-xl custom-input" placeholder="Lista los bonus adicionales que ofreces con la compra. Ej: - Bonus 1: Plantillas de anuncios listas para usar (Valor $47)." rows="5"></textarea>`,
        guarantee: `<h3 class="text-xl font-bold mb-4">Garant√≠a</h3><div class="space-y-4"><div><label for="guaranteeText" class="block text-gray-700 font-semibold mb-2">Descripci√≥n de la Garant√≠a</label><textarea id="guaranteeText" name="guarantee" class="w-full p-3 rounded-xl custom-input" placeholder="Describe tu garant√≠a. Ej: Garant√≠a de satisfacci√≥n de 15 d√≠as. Si no est√°s satisfecho, te devolvemos el 100% de tu dinero." rows="4"></textarea></div><div><label for="guaranteePeriod" class="block text-gray-700 font-semibold mb-2">Per√≠odo de Garant√≠a</label><select id="guaranteePeriod" name="guarantee_period" class="w-full p-3 rounded-xl custom-input"><option value="">Seleccionar...</option><option value="7-dias">7 d√≠as</option><option value="15-dias">15 d√≠as</option><option value="30-dias">30 d√≠as</option><option value="60-dias">60 d√≠as</option><option value="90-dias">90 d√≠as</option><option value="sin-garantia">Sin garant√≠a</option></select></div></div>`,
        faq: `<h3 class="text-xl font-bold mb-4">Preguntas Frecuentes (FAQ)</h3><textarea id="faqText" name="faq" class="w-full p-3 rounded-xl custom-input" placeholder="Escribe 3-5 preguntas frecuentes con sus respuestas. Ej: P: ¬øTendr√© acceso de por vida? R: S√≠, el acceso es vitalicio." rows="6"></textarea>`,
        countdown: `<h3 class="text-xl font-bold mb-4">Contador de Urgencia</h3><div class="space-y-4"><div><label for="countdownDate" class="block text-gray-700 font-semibold mb-2">Fecha de Finalizaci√≥n</label><input type="text" id="countdownDate" name="countdown_date" class="w-full p-3 rounded-xl custom-input" placeholder="Fecha y hora de finalizaci√≥n de la oferta. Ej: 31 de agosto de 2025, 23:59"></div><div><label for="urgencyMessage" class="block text-gray-700 font-semibold mb-2">Mensaje de Urgencia</label><input type="text" id="urgencyMessage" name="urgency_message" class="w-full p-3 rounded-xl custom-input" placeholder="Ej: ¬°Solo quedan 24 horas!, Oferta limitada, √öltimos cupos disponibles"></div></div>`,
        video: `<h3 class="text-xl font-bold mb-4">Video de Ventas</h3><div class="space-y-4"><div><label for="videoType" class="block text-gray-700 font-semibold mb-2">Tipo de Video</label><select id="videoType" name="video_type" class="w-full p-3 rounded-xl custom-input"><option value="">Seleccionar...</option><option value="vsl">Video Sales Letter (VSL)</option><option value="testimonios">Video de testimonios</option><option value="demo">Demo del producto</option><option value="explicativo">Video explicativo</option><option value="personal">Video personal del creador</option></select></div><div><label for="videoContent" class="block text-gray-700 font-semibold mb-2">Contenido del Video</label><textarea id="videoContent" name="video_content" class="w-full p-3 rounded-xl custom-input" placeholder="Describe qu√© debe incluir el video: puntos clave, duraci√≥n estimada, estilo, etc." rows="4"></textarea></div></div>`,
        socials: `<h3 class="text-xl font-bold mb-4">Redes Sociales</h3><div class="bg-amber-50 border-2 border-amber-200 rounded-xl p-4 mb-4"><p class="text-amber-800 text-sm font-medium">M√°ximo 4 redes sociales permitidas</p></div><div id="socials-container" class="space-y-3 mb-3"></div><button type="button" id="addSocialBtn" class="text-blue-600 font-semibold py-2 px-4 rounded-lg border-2 border-blue-200 hover:bg-blue-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed">Agregar Red Social</button>`,
        leadMagnet: `<h3 class="text-xl font-bold mb-4">Lead Magnet</h3><div class="space-y-4"><div><label for="leadMagnetType" class="block text-gray-700 font-semibold mb-2">Tipo de Lead Magnet</label><select id="leadMagnetType" name="lead_magnet_type" class="w-full p-3 rounded-xl custom-input"><option value="">Seleccionar...</option><option value="ebook">E-book / Gu√≠a PDF</option><option value="checklist">Checklist</option><option value="plantillas">Plantillas</option><option value="webinar">Webinar gratuito</option><option value="curso-mini">Mini curso</option><option value="auditoria">Auditor√≠a gratuita</option></select></div><div><label for="leadMagnetTitle" class="block text-gray-700 font-semibold mb-2">T√≠tulo del Lead Magnet</label><input type="text" id="leadMagnetTitle" name="lead_magnet_title" class="w-full p-3 rounded-xl custom-input" placeholder="Ej: Gu√≠a Completa de Marketing Digital para Principiantes"></div><div><label for="leadMagnetDescription" class="block text-gray-700 font-semibold mb-2">Descripci√≥n</label><textarea id="leadMagnetDescription" name="lead_magnet_description" class="w-full p-3 rounded-xl custom-input" placeholder="Describe qu√© contiene el lead magnet y qu√© beneficio obtendr√° el usuario" rows="3"></textarea></div></div>`,
        webinar: `<h3 class="text-xl font-bold mb-4">Integraci√≥n Webinar</h3><div class="space-y-4"><div><label for="webinarTitle" class="block text-gray-700 font-semibold mb-2">T√≠tulo del Webinar</label><input type="text" id="webinarTitle" name="webinar_title" class="w-full p-3 rounded-xl custom-input" placeholder="Ej: Masterclass Gratuita: C√≥mo Duplicar tus Ventas en 30 D√≠as"></div><div><label for="webinarDescription" class="block text-gray-700 font-semibold mb-2">Descripci√≥n del Webinar</label><textarea id="webinarDescription" name="webinar_description" class="w-full p-3 rounded-xl custom-input" placeholder="Describe qu√© aprender√°n en el webinar, cu√°ndo ser√°, etc." rows="4"></textarea></div><div><label for="webinarPlatform" class="block text-gray-700 font-semibold mb-2">Plataforma del Webinar</label><select id="webinarPlatform" name="webinar_platform" class="w-full p-3 rounded-xl custom-input"><option value="">Seleccionar...</option><option value="zoom">Zoom</option><option value="webinarjam">WebinarJam</option><option value="everwebinar">EverWebinar</option><option value="demio">Demio</option><option value="goto">GoToWebinar</option><option value="otro">Otro</option></select></div></div>`,
        legal: `<h3 class="text-xl font-bold mb-4">Aspectos Legales y Pol√≠ticas</h3><div class="space-y-6"><div><label for="termsConditions" class="block text-gray-700 font-semibold mb-2">¬øNecesitas T√©rminos y Condiciones personalizados?</label><select id="termsConditions" name="terms_conditions" class="w-full p-3 rounded-xl custom-input"><option value="si">S√≠, crear t√©rminos personalizados</option><option value="no">No, usar√© t√©rminos gen√©ricos</option><option value="tengo">Ya tengo mis t√©rminos</option></select></div><div><label for="privacyPolicy" class="block text-gray-700 font-semibold mb-2">¬øNecesitas Pol√≠tica de Privacidad personalizada?</label><select id="privacyPolicy" name="privacy_policy" class="w-full p-3 rounded-xl custom-input"><option value="si">S√≠, crear pol√≠tica personalizada</option><option value="no">No, usar√© pol√≠tica gen√©rica</option><option value="tengo">Ya tengo mi pol√≠tica</option></select></div><div><label for="refundPolicy" class="block text-gray-700 font-semibold mb-2">Pol√≠tica de Reembolsos</label><textarea id="refundPolicy" name="refund_policy" class="w-full p-3 rounded-xl custom-input" placeholder="Describe tu pol√≠tica de reembolsos: plazos, condiciones, proceso, etc." rows="4"></textarea></div><div><label for="businessInfo" class="block text-gray-700 font-semibold mb-2">Informaci√≥n del Negocio</label><textarea id="businessInfo" name="business_info" class="w-full p-3 rounded-xl custom-input" placeholder="Nombre completo/empresa, direcci√≥n f√≠sica, n√∫mero de contacto, email de soporte" rows="3"></textarea></div></div>`,
    };

    const extrasSelector = document.getElementById('extrasSelector');
    const extrasFormSections = document.getElementById('extrasFormSections');
    
    const iconSVGs = {
        'home': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>',
        'users': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a4 4 0 11-8 0 4 4 0 018 0z"></path>',
        'message-circle': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>',
        'dollar-sign': '<path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>',
        'gift': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path>',
        'shield': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>',
        'help-circle': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>',
        'award': '<circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 22 12 17 17 22 15.79 13.88"/>',
        'clock': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>',
        'video': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>',
        'share-2': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>',
        'file-text': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>',
    };
    
    const getIconSVG = (iconName) => iconSVGs[iconName] || iconSVGs['home'];

    // Create extras modules
    extrasModules.forEach(module => {
        const moduleCard = document.createElement('div');
        moduleCard.className = `extra-module-wrapper`;
        moduleCard.innerHTML = `
            <label class="flex flex-col p-5 border-2 border-gray-200 rounded-2xl module-card bg-white transition-all hover:shadow-lg cursor-pointer h-full">
                <input type="checkbox" id="extra-toggle-${module.id}" class="extra-toggle custom-checkbox mb-3 self-start">
                <div class="flex items-center space-x-3 mb-3">
                    <div class="icon-container w-12 h-12 bg-gray-400 rounded-xl flex items-center justify-center">
                         <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${getIconSVG(module.icon)}</svg>
                    </div>
                    <span class="font-semibold text-gray-800 text-lg">${module.name}</span>
                </div>
                <p class="text-sm text-gray-600 leading-relaxed">${module.description}</p>
            </label>`;
        extrasSelector.appendChild(moduleCard);

        const sectionContainer = document.createElement('div');
        sectionContainer.id = `extra-container-${module.id}`;
        sectionContainer.className = 'hidden';
        sectionContainer.innerHTML = `
            <div class="bg-gray-50 rounded-2xl p-6 border border-gray-200 shadow-md">
                ${extrasSectionTemplates[module.id] || `<h3 class="text-xl font-bold mb-4">${module.name}</h3><p>Configuraci√≥n para ${module.name}</p>`}
            </div>`;
        extrasFormSections.appendChild(sectionContainer);
    });

    const updateExtraModuleState = (checkbox) => {
        const moduleCard = checkbox.closest('.module-card');
        const sectionContainer = document.getElementById(`extra-container-${checkbox.id.replace('extra-toggle-','')}`);
        const iconContainer = moduleCard.querySelector('.icon-container');
        
        moduleCard.classList.toggle('selected', checkbox.checked);
        iconContainer.classList.toggle('bg-gray-400', !checkbox.checked);
        iconContainer.classList.toggle('bg-gradient-to-br', checkbox.checked);
        iconContainer.classList.toggle('from-amber-500', checkbox.checked);
        iconContainer.classList.toggle('to-orange-600', checkbox.checked);
        
        if(sectionContainer) {
            sectionContainer.classList.toggle('hidden', !checkbox.checked);
        }
        saveToLocalStorage();
    };

    const updateDataFieldsCost = () => {
        const checkedDataFields = document.querySelectorAll('.data-field-checkbox:checked');
        const totalSelectedFields = checkedDataFields.length;
        const warningEl = document.getElementById('dataFieldsCostWarning');
        const textEl = document.getElementById('dataFieldsCostText');
        const hiddenCountEl = document.getElementById('extraDataFieldsCountHidden');
        const hiddenCostEl = document.getElementById('extraDataFieldsCostHidden');

        let extraDataFields = 0;
        let extraDataCost = 0;

        if (totalSelectedFields > FREE_DATA_FIELDS_LIMIT) {
            extraDataFields = totalSelectedFields - FREE_DATA_FIELDS_LIMIT;
            extraDataCost = extraDataFields * COST_PER_EXTRA_DATA_FIELD;
        }

        hiddenCountEl.value = extraDataFields;
        hiddenCostEl.value = extraDataCost;

        if (extraDataCost > 0) {
            textEl.innerHTML = `Has seleccionado ${extraDataFields} campos adicionales (${totalSelectedFields} en total).<br>Costo adicional: <strong>${extraDataCost.toFixed(2)} USD</strong>`;
            warningEl.classList.remove('hidden');
        } else {
            warningEl.classList.add('hidden');
        }

        updateTotalCostSummary();
    };

    const updateExtraModuleCost = () => {
        const checkedToggles = document.querySelectorAll('.extra-toggle:checked');
        const checkedCount = checkedToggles.length;
        const counterEl = document.getElementById('extrasCounter');
        const costDisplayEl = document.getElementById('extraCostDisplay');
        const warningEl = document.getElementById('extraModulesCostWarning');
        const textEl = document.getElementById('extraModulesCostText');
        const hiddenCountEl = document.getElementById('extraModulesCountHidden');
        const hiddenCostEl = document.getElementById('extraModulesCostHidden');

        if (counterEl) {
            counterEl.textContent = `${checkedCount} seleccionados`;
        }

        let extraModules = 0;
        let extraCost = 0;

        if (checkedCount > FREE_MODULE_LIMIT) {
            extraModules = checkedCount - FREE_MODULE_LIMIT;
            extraCost = extraModules * COST_PER_EXTRA_MODULE;
        }

        hiddenCountEl.value = extraModules;
        hiddenCostEl.value = extraCost;

        if (extraCost > 0) {
            costDisplayEl.textContent = `+ ${extraCost} USD`;
            textEl.innerHTML = `Has seleccionado ${extraModules} m√≥dulos adicionales (${checkedCount} total).<br>Costo adicional: <strong>${extraCost.toFixed(2)} USD</strong>`;
            warningEl.classList.remove('hidden');
        } else {
            costDisplayEl.textContent = '';
            warningEl.classList.add('hidden');
        }

        updateTotalCostSummary();
    };

    const updateFollowUpCost = () => {
        const followUpEnabled = document.getElementById('enableFollowUpToggle').checked;
        const warningEl = document.getElementById('followUpCostWarning');
        const countHiddenEl = document.getElementById('extraFollowUpCountHidden');
        const costHiddenEl = document.getElementById('extraFollowUpCostHidden');
        
        if (!followUpEnabled) {
            warningEl.classList.add('hidden');
            countHiddenEl.value = 0;
            costHiddenEl.value = 0;
            updateTotalCostSummary();
            return;
        }

        const additionalEmails = document.querySelectorAll('#additionalFollowUpContainer > div').length;
        const cost = additionalEmails * COST_PER_EXTRA_FOLLOW_UP;

        countHiddenEl.value = additionalEmails;
        costHiddenEl.value = cost;
        
        if (cost > 0) {
            warningEl.innerHTML = `<div class="flex items-center space-x-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg>
                <div><strong>Costo adicional aplicado:</strong> <span class="text-sm mt-1">${additionalEmails} correos √ó ${COST_PER_EXTRA_FOLLOW_UP} = <strong>${cost.toFixed(2)} USD</strong></span></div>
            </div>`;
            warningEl.classList.remove('hidden');
        } else {
            warningEl.classList.add('hidden');
        }
        
        updateTotalCostSummary();
    };

    const updateTotalCostSummary = () => {
        const dataFieldsCost = parseInt(document.getElementById('extraDataFieldsCostHidden').value) || 0;
        const modulesCost = parseInt(document.getElementById('extraModulesCostHidden').value) || 0;
        
        const welcomeType = document.querySelector('input[name="welcome_message_type"]:checked')?.value;
        const whatsappCost = (welcomeType === 'whatsapp') ? COST_PER_WHATSAPP : 0;
        document.getElementById('whatsappCostHidden').value = whatsappCost;

        const followUpCost = parseInt(document.getElementById('extraFollowUpCostHidden').value) || 0;

        const totalCost = dataFieldsCost + modulesCost + whatsappCost + followUpCost;
        
        const summaryEl = document.getElementById('totalCostSummarySection');
        const breakdownEl = document.getElementById('totalCostBreakdown');
        const totalAmountEl = document.getElementById('totalCostAmount');
        const hiddenTotalEl = document.getElementById('totalExtraCostHidden');

        hiddenTotalEl.value = totalCost;

        if (totalCost > 0) {
            let breakdown = [];
            if (dataFieldsCost > 0) {
                const extraDataFields = parseInt(document.getElementById('extraDataFieldsCountHidden').value);
                breakdown.push(`<div class="flex justify-between"><span>Campos adicionales (${extraDataFields}):</span><span>${dataFieldsCost.toFixed(2)}</span></div>`);
            }
            if (modulesCost > 0) {
                const extraModules = parseInt(document.getElementById('extraModulesCountHidden').value);
                breakdown.push(`<div class="flex justify-between"><span>M√≥dulos adicionales (${extraModules}):</span><span>${modulesCost.toFixed(2)}</span></div>`);
            }
            if (whatsappCost > 0) {
                breakdown.push(`<div class="flex justify-between"><span>Automatizaci√≥n WhatsApp:</span><span>${whatsappCost.toFixed(2)}</span></div>`);
            }
            if (followUpCost > 0) {
                const extraFollowUps = parseInt(document.getElementById('extraFollowUpCountHidden').value);
                breakdown.push(`<div class="flex justify-between"><span>Correos adicionales (${extraFollowUps}):</span><span>${followUpCost.toFixed(2)}</span></div>`);
            }
            
            breakdownEl.innerHTML = breakdown.join('');
            totalAmountEl.textContent = `Total Adicional: ${totalCost.toFixed(2)} USD`;
            summaryEl.style.display = 'block';
        } else {
            summaryEl.style.display = 'none';
        }
    };

    // Funci√≥n para generar el resumen del proyecto
    const generateProjectSummary = () => {
        const summaryContainer = document.getElementById('summaryContent');
        const formData = new FormData(form);
        
        let summaryHTML = '';
        
        // Datos de contacto
        const clientName = formData.get('client_name');
        const clientEmail = formData.get('client_email');
        const clientPhone = formData.get('client_phone');
        const clientBusiness = formData.get('client_business');
        
        summaryHTML += `
            <div class="summary-section p-6 mb-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    Datos de Contacto
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><strong>Nombre:</strong> ${clientName || 'No especificado'}</div>
                    <div><strong>Email:</strong> ${clientEmail || 'No especificado'}</div>
                    <div><strong>Tel√©fono:</strong> ${clientPhone || 'No especificado'}</div>
                    ${clientBusiness ? `<div><strong>Empresa:</strong> ${clientBusiness}</div>` : ''}
                </div>
            </div>
        `;

        // Contenido principal
        const heroTitle = formData.get('hero_title');
        const heroDescription = formData.get('hero_description');
        const ctaText = formData.get('cta_text');
        
        if (heroTitle || heroDescription || ctaText) {
            summaryHTML += `
                <div class="summary-section p-6 mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                        </svg>
                        Contenido Principal
                    </h3>
                    ${heroTitle ? `<div class="mb-3"><strong>T√≠tulo Principal:</strong> "${heroTitle}"</div>` : ''}
                    ${heroDescription ? `<div class="mb-3"><strong>Subt√≠tulo:</strong> "${heroDescription}"</div>` : ''}
                    ${ctaText ? `<div><strong>Bot√≥n Principal:</strong> "${ctaText}"</div>` : ''}
                </div>
            `;
        }

        // Estrategia
        const funnelObjective = formData.get('funnel_objective');
        const funnelType = formData.get('funnel_type');
        const targetAudience = formData.get('target_audience');
        
        if (funnelObjective || funnelType || targetAudience) {
            summaryHTML += `
                <div class="summary-section p-6 mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Estrategia y Objetivos
                    </h3>
                    ${funnelObjective ? `<div class="mb-3"><strong>Objetivo:</strong> ${funnelObjective}</div>` : ''}
                    ${funnelType ? `<div class="mb-3"><strong>Tipo de Funnel:</strong> ${funnelType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>` : ''}
                    ${targetAudience ? `<div><strong>Cliente Ideal:</strong> ${targetAudience.substring(0, 200)}${targetAudience.length > 200 ? '...' : ''}</div>` : ''}
                </div>
            `;
        }

        // Campos de datos seleccionados
        const selectedDataFields = [];
        document.querySelectorAll('input[name="user_data_fields[]"]:checked').forEach(field => {
            selectedDataFields.push(field.value);
        });

        if (selectedDataFields.length > 0) {
            summaryHTML += `
                <div class="summary-section p-6 mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                        Campos de Captura
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        ${selectedDataFields.map(field => `<span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">${field.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())}</span>`).join('')}
                    </div>
                </div>
            `;
        }

        // M√≥dulos extra seleccionados
        const selectedModules = [];
        document.querySelectorAll('.extra-toggle:checked').forEach(toggle => {
            const moduleId = toggle.id.replace('extra-toggle-', '');
            const moduleName = extrasModules.find(m => m.id === moduleId)?.name || moduleId;
            selectedModules.push(moduleName);
        });

        if (selectedModules.length > 0) {
            summaryHTML += `
                <div class="summary-section p-6 mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path>
                        </svg>
                        M√≥dulos Adicionales
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        ${selectedModules.map(module => `<span class="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm">${module}</span>`).join('')}
                    </div>
                </div>
            `;
        }

        // Informaci√≥n adicional
        const trafficSource = formData.get('traffic_source');
        const timeframe = formData.get('timeframe');
        const businessStage = formData.get('business_stage');
        
        if (trafficSource || timeframe || businessStage) {
            summaryHTML += `
                <div class="summary-section p-6 mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        Informaci√≥n del Proyecto
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${trafficSource ? `<div><strong>Fuente de Tr√°fico:</strong> ${trafficSource.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>` : ''}
                        ${timeframe ? `<div><strong>Tiempo Requerido:</strong> ${timeframe.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>` : ''}
                        ${businessStage ? `<div><strong>Etapa del Negocio:</strong> ${businessStage.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>` : ''}
                    </div>
                </div>
            `;
        }

        summaryContainer.innerHTML = summaryHTML;
    };

    // Event listeners
    document.querySelectorAll('.data-field-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', updateDataFieldsCost);
    });

    extrasSelector.addEventListener('change', e => {
        if (e.target.classList.contains('extra-toggle')) {
            updateExtraModuleState(e.target);
            updateExtraModuleCost();
        }
    });
    
    document.getElementById('includePhoneToggle').addEventListener('change', (e) => {
        document.getElementById('phoneSection').classList.toggle('hidden', !e.target.checked);
    });

    document.querySelectorAll('input[name="domain_type"]').forEach(radio => {
        radio.addEventListener('change', (e) => {
            document.getElementById('customDomainSection').classList.toggle('hidden', e.target.value !== 'custom');
        });
    });

    document.querySelectorAll('input[name="welcome_message_type"]').forEach(radio => {
        radio.addEventListener('change', () => {
            const emailSection = document.getElementById('welcomeEmailSection');
            const whatsappSection = document.getElementById('welcomeWhatsappSection');
            const selected = document.querySelector('input[name="welcome_message_type"]:checked').value;
    
            emailSection.classList.toggle('hidden', selected !== 'email');
            whatsappSection.classList.toggle('hidden', selected !== 'whatsapp');
            
            updateTotalCostSummary();
        });
    });
    
    document.getElementById('enableFollowUpToggle').addEventListener('change', (e) => {
        document.getElementById('followUpSection').classList.toggle('hidden', !e.target.checked);
        updateFollowUpCost();
    });
    
    const addFollowUpInput = () => {
        const container = document.getElementById('additionalFollowUpContainer');
        const emailCount = container.children.length + 4;
        
        const div = document.createElement('div');
        div.className = 'flex items-center space-x-3';
        div.innerHTML = `
            <label for="followUpDelayExtra${emailCount-3}" class="w-1/4 block text-gray-700 font-semibold">Correo ${emailCount}</label>
            <input type="number" id="followUpDelayExtra${emailCount-3}" name="follow_up_delay_extra[]" class="flex-1 custom-input" placeholder="D√≠as despu√©s" min="1" max="365">
            <button type="button" class="remove-follow-up-btn text-red-500 hover:text-red-700 p-2 rounded-full hover:bg-red-50 transition-all">
                 <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                 </svg>
            </button>
        `;
        container.appendChild(div);
    };

    document.getElementById('addFollowUpBtn').addEventListener('click', () => {
        addFollowUpInput();
        updateFollowUpCost();
    });

    document.getElementById('followUpSection').addEventListener('click', (e) => {
        if (e.target.closest('.remove-follow-up-btn')) {
            e.target.closest('.flex.items-center').remove();
            updateFollowUpCost();
        }
    });

    const syncColorInputs = (colorPickerId, textInputId) => {
        const colorPicker = document.getElementById(colorPickerId);
        const textInput = document.getElementById(textInputId);
        if (colorPicker && textInput) {
            colorPicker.addEventListener('input', () => { textInput.value = colorPicker.value.toUpperCase(); });
            textInput.addEventListener('input', () => { if (/^#[0-9A-F]{6}$/i.test(textInput.value)) { colorPicker.value = textInput.value; } });
        }
    };
    syncColorInputs('primaryColor', 'primaryColorHex');
    syncColorInputs('secondaryColor', 'secondaryColorHex');

    const saveToLocalStorage = () => {
        try {
            const formData = new FormData(form);
            const data = {};
            data['user_data_fields[]'] = []; 
            for (let [key, value] of formData.entries()) {
                if (key === 'user_data_fields[]') { 
                    data['user_data_fields[]'].push(value); 
                } else if (!key.endsWith('[]')) {
                    data[key] = value;
                }
            }
            data.follow_up_delay_free = Array.from(document.querySelectorAll('input[name="follow_up_delay_free[]"]')).map(i => i.value);
            data.follow_up_delay_extra = Array.from(document.querySelectorAll('input[name="follow_up_delay_extra[]"]')).map(i => i.value);
            document.querySelectorAll('input[type="checkbox"]:not([name="user_data_fields[]"])').forEach(cb => data[cb.id] = cb.checked);
            document.querySelectorAll('input[type="radio"]').forEach(radio => { if (radio.checked) data[radio.name] = radio.value; });
            localStorage.setItem('funnelBuilderData', JSON.stringify(data));
        } catch (error) { 
            console.error('Error saving to localStorage:', error); 
        }
    };

    const loadFromLocalStorage = () => {
        try {
            const data = JSON.parse(localStorage.getItem('funnelBuilderData'));
            if (!data) return;

            for (let key in data) {
                if (key === 'user_data_fields[]' || key.endsWith('[]')) continue;

                const el = document.getElementById(key) || document.querySelector(`[name="${key}"]`);
                if (el) {
                    if (el.type === 'checkbox') {
                        el.checked = data[key];
                        if (el.id.startsWith('extra-toggle-')) updateExtraModuleState(el);
                        if (el.id === 'includePhoneToggle') document.getElementById('phoneSection').classList.toggle('hidden', !el.checked);
                        if (el.id === 'enableFollowUpToggle') document.getElementById('followUpSection').classList.toggle('hidden', !el.checked);
                    } else if (el.type === 'radio') {
                        document.querySelectorAll(`input[name="${key}"]`).forEach(radio => {
                            if (radio.value === data[key]) {
                                radio.checked = true;
                                if (radio.name === 'domain_type') document.getElementById('customDomainSection').classList.toggle('hidden', radio.value !== 'custom');
                                if (radio.name === 'welcome_message_type') {
                                    document.getElementById('welcomeEmailSection').classList.toggle('hidden', radio.value !== 'email');
                                    document.getElementById('welcomeWhatsappSection').classList.toggle('hidden', radio.value !== 'whatsapp');
                                }
                            }
                        });
                    } else { 
                        el.value = data[key]; 
                    }
                }
            }
            
            if (data['user_data_fields[]']) {
                data['user_data_fields[]'].forEach(value => { 
                    const cb = document.querySelector(`input[name="user_data_fields[]"][value="${value}"]`); 
                    if (cb && !cb.disabled) cb.checked = true; 
                });
            }

            if(data.follow_up_delay_free) {
                document.querySelectorAll('input[name="follow_up_delay_free[]"]').forEach((input, index) => input.value = data.follow_up_delay_free[index] || '');
            }
            if(data.follow_up_delay_extra) {
                document.getElementById('additionalFollowUpContainer').innerHTML = '';
                data.follow_up_delay_extra.forEach(value => {
                    addFollowUpInput();
                    const newInputs = document.querySelectorAll('input[name="follow_up_delay_extra[]"]');
                    if (newInputs.length > 0) newInputs[newInputs.length - 1].value = value;
                });
            }

        } catch (error) { 
            console.error('Error loading from localStorage:', error); 
        }
    };
    
    form.addEventListener('input', saveToLocalStorage);
    form.addEventListener('change', saveToLocalStorage);
    
    document.getElementById('clearFormBtn').addEventListener('click', () => {
        if (window.confirm('¬øEst√° seguro de que desea borrar toda la informaci√≥n del formulario?')) {
            localStorage.removeItem('funnelBuilderData');
            form.reset();

            document.querySelectorAll('.extra-toggle').forEach(cb => { 
                cb.checked = false; 
                updateExtraModuleState(cb); 
            });

            document.getElementById('additionalFollowUpContainer').innerHTML = '';
            document.getElementById('welcomeEmailSection').classList.add('hidden');
            document.getElementById('welcomeWhatsappSection').classList.add('hidden');
            document.getElementById('followUpSection').classList.add('hidden');
            
            updateAllCharCounters();
            document.getElementById('phoneSection').classList.add('hidden');
            document.getElementById('customDomainSection').classList.add('hidden');
            document.querySelector('input[name="domain_type"][value="free"]').checked = true;
            document.querySelector('input[name="welcome_message_type"][value="none"]').checked = true;
            
            updateExtraModuleCost();
            updateDataFieldsCost();
            updateFollowUpCost();
            const socialsContainer = document.getElementById('socials-container');
            if (socialsContainer) socialsContainer.innerHTML = '';
            
            currentSectionIndex = 0;
            updateNavigation();
        }
    });

    const setupCharCounter = (textareaId, counterId, maxLength) => {
        const textarea = document.getElementById(textareaId);
        const counter = document.getElementById(counterId);
        if (textarea && counter) {
            const updateCounter = () => {
                const len = textarea.value.length;
                counter.textContent = `${len} / ${maxLength}`;
                counter.style.color = len > maxLength ? '#ef4444' : '#64748b';
            };
            textarea.addEventListener('input', updateCounter);
            updateCounter();
        }
    };
    
    const updateAllCharCounters = () => {
        setupCharCounter('heroTitle', 'heroTitleCounter', 100);
        setupCharCounter('heroDescription', 'heroDescriptionCounter', 250);
    };

    let socialCounter = 0;
    const MAX_SOCIALS = 4;
    
    const addSocialInput = () => {
        const container = document.getElementById('socials-container');
        const addBtn = document.getElementById('addSocialBtn');
        if (!container || socialCounter >= MAX_SOCIALS) return;
        
        socialCounter++;
        const socialDiv = document.createElement('div');
        socialDiv.className = 'flex space-x-3 items-center';
        socialDiv.innerHTML = `
            <select name="social_platform_${socialCounter}" class="w-1/3 custom-input">
                <option value="">Red Social</option>
                <option value="facebook">Facebook</option>
                <option value="instagram">Instagram</option>
                <option value="twitter">Twitter</option>
                <option value="linkedin">LinkedIn</option>
                <option value="youtube">YouTube</option>
                <option value="tiktok">TikTok</option>
                <option value="whatsapp">WhatsApp</option>
            </select>
            <input type="url" name="social_url_${socialCounter}" class="flex-1 custom-input" placeholder="URL del perfil">
            <button type="button" class="remove-social-btn text-red-500 hover:text-red-700 p-2 rounded-full hover:bg-red-50 transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
            </button>`;
        container.appendChild(socialDiv);
        
        if (socialCounter >= MAX_SOCIALS) {
            addBtn.disabled = true;
            addBtn.textContent = `M√°ximo ${MAX_SOCIALS} redes alcanzado`;
        }
    };

    document.addEventListener('click', (e) => {
        if (e.target.closest('#addSocialBtn')) { 
            e.preventDefault(); 
            addSocialInput(); 
        }
        if (e.target.closest('.remove-social-btn')) { 
            e.preventDefault(); 
            e.target.closest('.flex.space-x-3').remove();
            socialCounter--;
            const addBtn = document.getElementById('addSocialBtn');
            if (addBtn && socialCounter < MAX_SOCIALS) {
                addBtn.disabled = false;
                addBtn.textContent = 'Agregar Red Social';
            }
        }
    });

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (!validateCurrentSection()) {
             alert('Por favor, revisa los campos marcados en rojo antes de enviar.');
             return;
        }

        const submitBtn = document.getElementById('generateSummaryBtn');
        const originalText = submitBtn.innerHTML;
        submitBtn.disabled = true;
        submitBtn.innerHTML = `<span class="relative z-10 flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Enviando...</span>`;
        
        const formData = new FormData(form);
        let summary = '### RESUMEN DE REQUERIMIENTOS DE FUNNEL - VERSI√ìN PREMIUM ###\n\n';
        summary += `FECHA DE SOLICITUD: ${new Date().toLocaleDateString()}\n\n`;
        const dataForSummary = {};
        for(let [key, value] of formData.entries()) {
            if (!value || key === 'summary') continue;
            const fieldName = key.replace(/_/g, ' ').replace(/\[\]$/, '').replace(/\d+$/, '').trim().toUpperCase();
            if (dataForSummary[fieldName]) { 
                dataForSummary[fieldName] += `, ${value}`; 
            } else { 
                dataForSummary[fieldName] = value; 
            }
        }
        for (const [key, value] of Object.entries(dataForSummary)) { 
            summary += `${key}: ${value}\n\n`; 
        }
        document.getElementById('summaryHidden').value = summary;

        fetch(form.action, { 
            method: 'POST', 
            body: new FormData(form), 
            headers: { 'Accept': 'application/json' } 
        })
        .then(response => {
            if (response.ok) {
                const modal = document.getElementById('summaryModal');
                const modalContent = document.getElementById('modalContent');
                modal.classList.remove('hidden'); 
                modal.classList.add('flex');
                setTimeout(() => { 
                    modalContent.classList.remove('scale-95', 'opacity-0'); 
                }, 50);
                localStorage.removeItem('funnelBuilderData');
            } else { 
                throw new Error('Network response was not ok.'); 
            }
        })
        .catch(error => {
            console.error('Form submission error:', error);
            alert('Hubo un problema al enviar el formulario. Por favor, intenta de nuevo o contacta a soporte.');
        })
        .finally(() => { 
            submitBtn.disabled = false; 
            submitBtn.innerHTML = originalText; 
        });
    });
    
    document.getElementById('closeModalBtn').addEventListener('click', () => {
        const modal = document.getElementById('summaryModal');
        const modalContent = document.getElementById('modalContent');
        modalContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => { 
            modal.classList.add('hidden'); 
            modal.classList.remove('flex'); 
            document.getElementById('clearFormBtn').click();
        }, 300);
    });

    document.getElementById('currentYear').textContent = new Date().getFullYear();
    
    // Initial calls on page load
    loadFromLocalStorage();
    updateNavigation(); // Set initial section state
    updateAllCharCounters();
    updateExtraModuleCost();
    updateDataFieldsCost();
    updateFollowUpCost();
});

// Keyboard navigation enhancement
document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA' && e.target.type !== 'submit') {
        e.preventDefault();
        // Trigger next button click if it's visible
        const nextBtn = document.getElementById('nextBtn');
        const reviewBtn = document.getElementById('reviewProjectBtn');
        if (nextBtn && nextBtn.style.display !== 'none') {
            nextBtn.click();
        } else if (reviewBtn && reviewBtn.style.display !== 'none') {
            reviewBtn.click();
        }
    }
});

// Smooth animations for better UX
document.addEventListener('DOMContentLoaded', () => {
    // Add intersection observer for animations
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, { threshold: 0.1 });

    // Observe all form sections
    document.querySelectorAll('.form-section').forEach(section => {
        observer.observe(section);
    });

    // Enhanced loading animation
    setTimeout(() => {
        document.body.classList.add('loaded');
    }, 100);
});
</script>
</body>
</html>